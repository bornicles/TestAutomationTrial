var excelOnlineCalc=function(e){var r={};function n(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)n.d(t,a,function(r){return e[r]}.bind(null,a));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=8)}([function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=n(1);r.utils=t;var a=n(2);r.idbPromised=a;var o=n(3);r.ULS=o.ULS,r.TraceLevel=o.TraceLevel,r.LogCategory=o.LogCategory,r.NulLogger=o.NulLogger,r.ConsoleLogger=o.ConsoleLogger;var i=n(4);r.browserSupport=i;var u=n(5);r.perfWatch=u;var c=n(6);r.initEwaUtils=c.initEwaUtils,r.ewaUtils=c.ewaUtils;var l=n(7);r.initStopwatchFactory=l.initStopwatchFactory},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.forEachPromise=function(e,r,n){return e.reduce(function(e,t){return e.then(function(){return n&&n.stop?Promise.resolve(void 0):r(t,n)})},Promise.resolve(void 0))},r.defaultToJSONResultWhenStringifyFails="...",r.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(r,n){if(void 0===n&&(n=0),n<0||n>t)return r;if(null===r||void 0===r||"object"!=typeof r)return r;var a={};Object.getOwnPropertyNames(r).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=r[e])});var o=Object.getPrototypeOf(r);o&&"object"==typeof o&&Object.keys(o).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(a[e]=r[e])});var i={};return Object.keys(a).forEach(function(r){i[r]=e(a[r],n+1)}),i}(e))}catch(e){return r.defaultToJSONResultWhenStringifyFails}};var t=5;var a="_",o=new RegExp("\\W+","g");r.getPerfWatchMarkName=function(e){if(!e)return"";var r=e.trim().substring(0,200).trim().replace(o,a).substring(0,80);return r&&r.length>0&&r.substr(r.length-1,1)===a&&(r=r.substr(0,r.length-1)),r&&r.length>0&&r.substr(0,1)===a&&(r=r.substr(1)),r},r.retry=function(e,r){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(r<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+r));for(var n=Promise.reject(void 0),t=function(r){n=n.catch(function(n){return e(r,n)})},a=1;a<=r;a+=1)t(a);return n}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t,a=n(1);function o(e,r,n){return e?!(r&&!e.objectStoreNames.contains(r))||(n({name:"ValidationError",message:"The database doesn't contain store name: "+r}),!1):(n({name:"ValidationError",message:"The database should be initialized"}),!1)}var i=void 0;function u(e){void 0!==i&&i(e)}function c(e,r,n,t){return new Promise(function(a,i){if(o(e,r,i)){var u,c=e.transaction([r],n);c.oncomplete=function(){return a()},c.onerror=function(){return i(u||c.error)},c.onabort=function(){return i(u||c.error)};var l=c.objectStore(r),s=t(l);s.onerror=function(){u=s.error}}})}r.registerTraceSubscriber=function(e){i=e},r.clearTraceSubscriber=function(){i=void 0},r.setTestDbFactory=function(e){t=e},r.getDbFactory=function(){if(t)return t;try{if(window&&"indexedDB"in window&&void 0!==window.indexedDB)return window.indexedDB}catch(n){var e=a.getStringifiedError(n);e&&e!==a.defaultToJSONResultWhenStringifyFails||!n||!n.message||(e=n.message);var r=a.getPerfWatchMarkName(e);u("indexedDB_access_error"+(r&&r.length>0?"_":"")+r)}},r.getStoreReadinessPromise=function(e){return new Promise(function(r,n){e.transaction.oncomplete=function(){return r()},e.transaction.onerror=function(){return n(e.transaction.error)}})},r.initDb=function(e,r,n,t){return new Promise(function(a,o){u("idb_open");var i=n||0===n?e.open(r,n):e.open(r),c=function(e){var r=!1,n=!1,t=function(e){u("idb_open_"+e)},i=function(){return n?(t("already_resolved"),!1):!r||(t("already_rejected"),!1)};return{rejectOnce:function(e){t("should_reject"),i()&&(t("rejecting"),r=!0,o(e))},resolveOnce:function(e){t("should_resolve"),i()&&(t("resolving"),n=!0,a(e))}}}();i.onupgradeneeded=function(e){u("idb_open_onupgradeneeded_start");var n=e.target.result;if(e.oldVersion>0&&function(e){u("idb_open_onupgradeneeded_deleteAllObjectStores");for(var r=[],n=e.objectStoreNames.length-1;n>=0;n-=1){var t=e.objectStoreNames.item(n);(t||""===t)&&r.push(t)}r.forEach(function(r){u("idb_open_onupgradeneeded_delete_store_"+r),e.deleteObjectStore(r)})}(n),t){u("idb_open_onupgradeneeded_create_stores");var a=t(n);a&&a.length>0&&Promise.all(a).then(function(){u("idb_open_onupgradeneeded_stores_ready"),c.resolveOnce({db:n,dbName:r})},function(e){u("idb_open_onupgradeneeded_stores_ready_error"),c.rejectOnce(e)})}u("idb_open_onupgradeneeded_end")},i.onsuccess=function(e){u("idb_open_onsuccess"),c.resolveOnce({db:e.target.result,dbName:r})},i.onerror=function(){u("idb_open_onerror"),c.rejectOnce(i.error)},i.onblocked=function(e){u("idb_open_onblocked"),c.rejectOnce(e)}})},r.deleteDb=function(e,r){return new Promise(function(n,t){var a=e.deleteDatabase(r);a.onsuccess=function(){return n()},a.onblocked=function(){return n()},a.onerror=function(){return t(a.error)}})},r.doTransactionAction=c,r.put=function(e,r,n,t){return c(e,r,"readwrite",function(e){return n?e.put(t,n):e.put(t)})},r.get=function(e,r,n){return new Promise(function(t,a){if(o(e,void 0,a)){var i;e.objectStoreNames.contains(r)||t(void 0);var u=void 0,c=e.transaction([r],"readonly");c.oncomplete=function(){return t(u)},c.onerror=function(){return a(i||c.error)},c.onabort=function(){return a(i||c.error)};var l=c.objectStore(r).get(n);l.onsuccess=function(e){u=e.target.result},l.onerror=function(){i=l.error}}})},r.getAllItems=function(e,r){return new Promise(function(n,t){if(o(e,r,t)){var a,i=[],u=e.transaction([r],"readonly");u.oncomplete=function(){return n(i)},u.onerror=function(){return t(a||u.error)},u.onabort=function(){return t(a||u.error)};var c=u.objectStore(r).openCursor();c.onsuccess=function(e){var r=e.target.result;r&&(i.push(r.value),r.continue())},c.onerror=function(){a=c.error}}})},r.getAllKeys=function(e,r){return new Promise(function(n,t){if(o(e,r,t)){var a,i=[],u=e.transaction([r],"readonly");u.oncomplete=function(){return n(i)},u.onerror=function(){return t(a||u.error)},u.onabort=function(){return t(a||u.error)};var c=u.objectStore(r).openCursor();c.onsuccess=function(e){var r=e.target.result;r&&(i.push(r.key),r.continue())},c.onerror=function(){a=c.error}}})},r.remove=function(e,r,n){return c(e,r,"readwrite",function(e){return e.delete(n)})},r.removeAll=function(e,r){return c(e,r,"readwrite",function(e){return e.clear()})}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r.TraceLevel||(r.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(r.LogCategory||(r.LogCategory={})),r.ULS={getFromExternalLogger:function(e){var r=e;return{ULS:{trace:function(e,n,t){return r.traceTag(0,e,n,t)},traceTag:function(e,n,t,a){return r.traceTag(e,n,t,a)},debugTrace:function(e,n,t){return r.debugTraceTag(0,e,n,t)},debugTraceTag:function(e,n,t,a){return r.debugTraceTag(e,n,t,a)},assert:function(e,n,t){return r.assertTag(0,e,n,t)},assertTag:function(e,n,t,a){return r.assertTag(e,n,t,a)},shipAssert:function(e,n,t){return r.shipAssertTag(0,e,n,t)},shipAssertTag:function(e,n,t,a){return r.shipAssertTag(e,n,t,a)}}}}};var t=function(){function e(){}return e.prototype.shipAssertTag=function(e,r,n,t){console.assert(n,"shipAssertTag:",e,r,t)},e.prototype.assertTag=function(e,r,n,t){console.assert(n,"assertTag",e,r,t)},e.prototype.traceTag=function(e,r,n,t){console.log("traceTag",e,t,r,n)},e.prototype.debugTraceTag=function(e,r,n,t){console.log("debugTraceTag",e,t,r,n)},e}();r.ConsoleLogger=t;var a=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();r.NulLogger=a},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t={},a="promises";r.promises=function(){return void 0===t[a]&&(t[a]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),t[a]}},function(e,r,n){"use strict";function t(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function a(e,r,n){e[r]=t()-n}Object.defineProperty(r,"__esModule",{value:!0}),r.start=function(e){var r=e,n=t(),o={},i=function(e,t,i){return function(e,r,n,t,o,i){a(e,"end",n);var u={sessionName:r,result:t?"success":"failure",message:i,marks:e},c=JSON.stringify(u);o(c)}(o,r,n,e,t,i)};return o.start=0,{mark:function(e){return function(e){return a(o,e,n)}(e)},end:function(e){return i(!0,e)},success:function(e,r){return i(!0,e,r)},failure:function(e,r){return i(!1,e,r)}}},r.mark=function(e,r){void 0!==e&&e.mark(r)},r.end=function(e,r){void 0!==e&&e.end(r)},r.success=function(e,r,n){void 0!==e&&e.success(r,n)},r.failure=function(e,r,n){void 0!==e&&e.failure(r,n)}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t={isChangeGateEnabled:function(e){return!1}};r.ewaUtils=function(){return t},r.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");t=e}},function(e,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=function(){return Date.now()};r.initStopwatchFactory=function(e,r){return void 0===r&&(r=1),window.performance&&window.performance.now&&(t=function(){return window.performance.now()}),function(n){var a=t(),o=n;return{reset:function(e){null!=e&&(o=e),a=t()},stop:function(){var n=t()-a,i=JSON.stringify({Target:o,Duration:n.toFixed(r)});e(i)}}}}},function(e,r,n){"use strict";n.r(r);var t={};n.r(t),n.d(t,"ReasonKind",function(){return Cn}),n.d(t,"notImplemented",function(){return Nn}),n.d(t,"notFormulaString",function(){return On}),n.d(t,"createParser",function(){return fi}),n.d(t,"parseResultHelper",function(){return Si});var a={};n.r(a),n.d(a,"createAnalyzer",function(){return hu});var o={};n.r(o),n.d(o,"fastMathpack",function(){return Mu}),n.d(o,"createCompiler",function(){return el}),n.d(o,"createEvaluator",function(){return Wf}),n.d(o,"ReasonKind",function(){return uc}),n.d(o,"CellKind",function(){return oc}),n.d(o,"Interrupt",function(){return ic}),n.d(o,"notImplemented",function(){return tc}),n.d(o,"finalValue",function(){return lc}),n.d(o,"pendingValue",function(){return sc}),n.d(o,"cellFormula",function(){return fc}),n.d(o,"unavailable",function(){return ac}),n.d(o,"unevaluated",function(){return Ec}),n.d(o,"stopped",function(){return dc}),n.d(o,"nameCycle",function(){return vc}),n.d(o,"cellCycle",function(){return Tc}),n.d(o,"paused",function(){return Sc}),n.d(o,"previousFailure",function(){return hc}),n.d(o,"javaScriptError",function(){return Rc}),n.d(o,"evalGlobals",function(){return pc}),n.d(o,"getEvalFailureReason",function(){return Ic}),n.d(o,"illFormedFormula",function(){return cc}),n.d(o,"extractResultValue",function(){return kc}),n.d(o,"evalToCellValue",function(){return Uc}),n.d(o,"getBasicFirstOrderFunc",function(){return Vd}),n.d(o,"extension",function(){return wd});var i={};n.r(i),n.d(i,"recalcMapper",function(){return aE}),n.d(i,"mapperContext",function(){return oE}),n.d(i,"formulaCacheGlobals",function(){return vE}),n.d(i,"formulaCache",function(){return TE}),n.d(i,"createFormatInfo",function(){return pE});var u={};n.r(u),n.d(u,"getBasicFirstOrderFunc",function(){return Vd});var c=n(0);function l(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}function s(e){return e}function f(e){if("object"!=typeof e)return"<unexpected>";var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=d(e[n],n));return r}function d(e,r){if("string"==typeof r&&null!=v[r])return e;var n=function(e){var r=typeof e;if("object"===r){if(null===e)return"null";if(e instanceof Array)return"Array";var n=e.kind;if("string"==typeof n)return n}return r}(e),t=T[n];return null!=t?t(e,r):"object"==typeof e?f(e):"<unexpected>"}function E(e){try{var r=function(e){if("object"==typeof e&&null!==e&&void 0!==e){if(e.hasOwnProperty("node")&&e.hasOwnProperty("spans"))return"Formula";if(e.hasOwnProperty("kind")&&function(e){return"Literal"===e||"Array"===e||"App"===e||"Paren"===e||"Name"===e||"CellRef"===e||"Bad"===e||"Operator"===e}(e.kind))return"FormulaNode"}}(e);if(void 0!==r){var n=h[r](e);return void 0!==n?n:JSON.stringify(d(e,void 0))}return JSON.stringify(d(e,void 0))}catch(e){return e instanceof Error?"<error "+e.name+": "+JSON.stringify(e.message)+">":"<error: "+JSON.stringify(e)+">"}}var p,v={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},T={boolean:s,symbol:s,undefined:s,null:s,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var r=e.name;return"string"==typeof r&&r.length>0?"<function "+r+">":"<function>"},object:f,Array:function(e){return"object"==typeof e&&e instanceof Array?e.map(d):"<unexpected>"}},h={},R={ULS:new c.NulLogger};function S(e){R.ULS=e}function I(e,r){var n=e+": code should be unreachable because a value has type 'never'; given "+E(r);return R.ULS.assertTag(595980872,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}function g(e){return R.ULS.assertTag(595980873,c.LogCategory.msoulscat_ES_EWAJS,!1,e)}function A(e,r){(!l(r)||r<0)&&g(e+": expected natural number; given "+E(r))}function N(e,r){(!l(r)||r<=0)&&g(e+": expected positive integer; given "+E(r))}function C(e,r,n){(!l(r)||r<0||r>=n)&&g(e+": expected natural number less than "+E(n)+"; given "+E(r))}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation"}(p||(p={}));var O=m(void 0,"");function m(e,r){return{path:e,name:r}}function D(e,r,n){return{document:e,index:r,length:n}}function L(e,r,n){return A("calc.lang.sheetRange",r),N("calc.lang.sheetRange",n),D(e,r,n)}function M(e,r){return A("calc.lang.sheetIndex",r),D(e,r,1)}function _(e,r,n,t){return{row:e,col:r,rows:n,cols:t}}function y(e,r,n,t){return A("calc.lang.gridRange",e),A("calc.lang.gridRange",r),N("calc.lang.gridRange",n),N("calc.lang.gridRange",t),_(e,r,n,t)}function F(e,r){return A("calc.lang.gridCell",e),A("calc.lang.gridCell",r),_(e,r,1,1)}function k(e,r){return{sheet:e,range:r}}var U,P,b,B,w,G,V=k,x=k,W=k;function H(e){return{document:e,index:void 0}}function K(e,r){return{scope:e,name:r}}function X(e,r,n,t,a,o){(A("calc.lang.functionType",e),0===n.length&&r.length<e)&&g("calc.lang.functionType: expected headTypes.length >= "+e+"; given "+JSON.stringify(r));return{minArgs:e,headTypes:r,restTypes:n,returnType:t,staticPrecs:a,flags:o}}function Q(e,r,n,t){return{cells:e,names:r,special:n,isExact:t}}function Y(e){return{kind:U.Error,type:e}}!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(U||(U={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(P||(P={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.All=4095]="All"}(b||(b={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro"}(B||(B={})),function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA"}(w||(w={})),function(e){e[e.First=1]="First",e[e.Last=8]="Last"}(G||(G={}));var J=Y(w.NULL),j=Y(w.DIV0),q=Y(w.VALUE),z=Y(w.REF),Z=Y(w.NAME),$=Y(w.NUM),ee=Y(w.NA),re=Y(w.GETTING_DATA);function ne(e,r,n){return A("calc.lang.arrayOper",e),A("calc.lang.arrayOper",r),n.length!==e?g("calc.lang.arrayOper: Inconsistent row number"):{kind:U.Array,rows:e,cols:r,opers:n}}function te(e,r){return N("calc.lang.rangeSeqOper",r.length),{kind:U.Range,sheets:e,ranges:r}}function ae(e,r){return{kind:U.Range,sheets:e,ranges:[r]}}var oe,ie,ue,ce,le,se,fe={kind:U.Missing},de={kind:U.Blank};!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(oe||(oe={})),function(e){e.Error="Error",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange"}(ie||(ie={})),function(e){e.Error="Error",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col"}(ue||(ue={})),function(e){e.Abs="Abs",e.Rel="Rel"}(ce||(ce={})),function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.Bad="Bad",e.Operator="Operator"}(le||(le={})),function(e){e.Unexpected="Unexpected",e.CellRef="CellRef",e.Qualifier="Qualifier",e.Sequence="Sequence"}(se||(se={}));var Ee={kind:ie.Error,isQuoted:!1},pe={kind:ie.Relative,isQuoted:!1};function ve(e,r,n){return void 0===n&&(n=!1),{kind:ie.Document,isQuoted:n,document:e,path:r}}function Te(e,r,n){return void 0===n&&(n=!1),{kind:ie.Sheet,isQuoted:n,sheet:e,document:r}}function he(e,r){return void 0===r&&(r=!1),{kind:ie.Ident,isQuoted:r,name:e}}function Re(e,r,n){return void 0===n&&(n=!1),{kind:ie.SheetRange,isQuoted:n,sheet1:e,sheet2:r}}function Se(e,r){return{kind:e,index:r}}var Ie,ge={kind:ue.Error};function Ae(e,r){return{kind:ue.Single,row:e,col:r}}function Ne(e,r){return{kind:ue.Range,ref1:e,ref2:r}}function Ce(e,r){return{kind:ue.Row,row1:e,row2:r}}function Oe(e,r){return{kind:ue.Col,col1:e,col2:r}}function me(e,r){return{node:e,spans:r}}function De(e,r,n,t){return A("calc.lang.formulaSpan",e),function(e,r){l(r)||g(e+": expected integer; given "+E(r))}("calc.lang.formulaSpan",r),r<e&&g("calc.lang.formulaSpan: expected end >= "+e+"; given "+r),{start:e,end:r,pre:n,post:t}}function Le(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:le.Literal,label:n,oper:e,isClosed:r}}function Me(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:le.Array,label:n,nodes:e,isClosed:r}}function _e(e,r,n,t){return void 0===n&&(n=!0),void 0===t&&(t=0),{kind:le.App,label:t,head:e,args:r,isClosed:n}}function ye(e,r){return void 0===r&&(r=0),{kind:le.Operator,label:r,id:e}}function Fe(e,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:le.Paren,label:n,node:e,isClosed:r}}function ke(e,r,n){return void 0===n&&(n=0),{kind:le.Name,label:n,whole:e,qualifier:r}}function Ue(e,r,n){return void 0===n&&(n=0),{kind:le.CellRef,label:n,ref:e,qualifier:r}}function Pe(e,r,n){return void 0===n&&(n=0),{kind:le.Bad,label:n,type:e,contents:r}}!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.ERROR_CODE=249]="ERROR_CODE",e[e.ALLOC_COUNT=250]="ALLOC_COUNT",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.DEBUG=524]="DEBUG",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e.IMAGE=612]="IMAGE",e[e.RECORD=613]="RECORD",e[e.GRF=614]="GRF",e[e.UNIT=615]="UNIT",e[e.RICHERROR=616]="RICHERROR",e[e.FILTER=617]="FILTER",e[e.FUN=618]="FUN",e[e.LET=619]="LET",e[e.ARRAYMAKE=620]="ARRAYMAKE",e[e.APPLY=621]="APPLY",e[e.ISFUN=622]="ISFUN",e[e.ARITY=623]="ARITY",e[e.RECURSE=624]="RECURSE"}(Ie||(Ie={}));var be=[];be[Ie.COUNT]=X(1,[],[57],1,0,0),be[Ie.IF]=X(1,[36,575,575],[],567,0,0),be[Ie.ISNA]=X(1,[15],[],4,0,0),be[Ie.ISERROR]=X(1,[15],[],4,0,0),be[Ie.SUM]=X(1,[],[49],1,0,0),be[Ie.AVERAGE]=X(1,[],[49],1,0,0),be[Ie.MIN]=X(1,[],[49],1,0,0),be[Ie.MAX]=X(1,[],[49],1,0,0),be[Ie.ROW]=X(0,[16],[],33,0,0),be[Ie.COLUMN]=X(0,[16],[],33,0,0),be[Ie.NA]=X(0,[],[],3,0,0),be[Ie.NPV]=X(2,[1],[49],1,0,0),be[Ie.STDEV]=X(1,[],[49],1,0,0),be[Ie.DOLLAR]=X(1,[1,1],[],2,0,0),be[Ie.FIXED]=X(1,[1,65,4],[],2,0,0),be[Ie.SIN]=X(1,[1],[],1,0,0),be[Ie.COS]=X(1,[1],[],1,0,0),be[Ie.TAN]=X(1,[1],[],1,0,0),be[Ie.ATAN]=X(1,[1],[],1,0,0),be[Ie.PI]=X(0,[],[],1,0,0),be[Ie.SQRT]=X(1,[1],[],1,0,0),be[Ie.EXP]=X(1,[1],[],1,0,0),be[Ie.LN]=X(1,[1],[],1,0,0),be[Ie.LOG10]=X(1,[1],[],1,0,0),be[Ie.ABS]=X(1,[1],[],1,0,0),be[Ie.INT]=X(1,[1],[],1,0,0),be[Ie.SIGN]=X(1,[1],[],1,0,0),be[Ie.ROUND]=X(2,[1,1],[],1,0,0),be[Ie.LOOKUP]=X(2,[7,48,48],[],7,0,0),be[Ie.INDEX]=X(2,[48,1,1,1],[],55,0,0),be[Ie.REPT]=X(2,[2,1],[],2,0,0),be[Ie.MID]=X(3,[2,1,1],[],2,0,0),be[Ie.LEN]=X(1,[2],[],1,0,0),be[Ie.VALUE]=X(1,[7],[],1,0,0),be[Ie.TRUE]=X(0,[],[],4,0,0),be[Ie.FALSE]=X(0,[],[],4,0,0),be[Ie.AND]=X(1,[],[52],4,0,0),be[Ie.OR]=X(1,[],[52],4,0,0),be[Ie.NOT]=X(1,[4],[],4,0,0),be[Ie.MOD]=X(2,[1,1],[],1,0,0),be[Ie.DCOUNT]=X(3,[16,83,18],[],1,0,0),be[Ie.DSUM]=X(3,[16,19,18],[],1,0,0),be[Ie.DAVERAGE]=X(3,[16,19,18],[],1,0,0),be[Ie.DMIN]=X(3,[16,19,18],[],1,0,0),be[Ie.DMAX]=X(3,[16,19,18],[],1,0,0),be[Ie.DSTDEV]=X(3,[16,19,18],[],1,0,0),be[Ie.VAR]=X(1,[],[49],1,0,0),be[Ie.DVAR]=X(3,[16,19,18],[],1,0,0),be[Ie.TEXT]=X(2,[7,2],[],2,0,0),be[Ie.LINEST]=X(1,[48,112,84,84],[],32,0,0),be[Ie.TREND]=X(1,[48,112,112,84],[],32,0,0),be[Ie.LOGEST]=X(1,[48,112,84,84],[],32,0,0),be[Ie.GROWTH]=X(1,[48,112,112,84],[],32,0,0),be[Ie.GOTO]=X(1,[16],[],512,0,2),be[Ie.HALT]=X(0,[4],[],512,0,2),be[Ie.RETURN]=X(0,[575],[],512,0,2),be[Ie.PV]=X(3,[1,1,1,1,1],[],1,0,0),be[Ie.FV]=X(3,[1,1,1,1,1],[],1,0,0),be[Ie.NPER]=X(3,[1,1,1,1,1],[],1,0,0),be[Ie.PMT]=X(3,[1,1,1,1,1],[],1,0,0),be[Ie.RATE]=X(3,[1,1,1,1,1,1],[],1,0,0),be[Ie.MIRR]=X(3,[48,1,1],[],1,0,0),be[Ie.IRR]=X(1,[48,1],[],1,0,0),be[Ie.RAND]=X(0,[],[],1,4095,0),be[Ie.MATCH]=X(2,[7,49,17],[],1,0,0),be[Ie.DATE]=X(3,[1,1,1],[],1,0,0),be[Ie.TIME]=X(3,[1,1,1],[],1,0,0),be[Ie.DAY]=X(1,[1],[],1,0,0),be[Ie.MONTH]=X(1,[1],[],1,0,0),be[Ie.YEAR]=X(1,[1],[],1,0,0),be[Ie.WEEKDAY]=X(1,[1,1],[],1,0,0),be[Ie.HOUR]=X(1,[1],[],1,0,0),be[Ie.MINUTE]=X(1,[1],[],1,0,0),be[Ie.SECOND]=X(1,[1],[],1,0,0),be[Ie.NOW]=X(0,[],[],1,4095,0),be[Ie.AREAS]=X(1,[16],[],1,0,0),be[Ie.ROWS]=X(1,[48],[],1,0,0),be[Ie.COLUMNS]=X(1,[48],[],1,0,0),be[Ie.OFFSET]=X(3,[16,65,65,65,65],[],16,4095,0),be[Ie.ABSREF]=X(2,[2,16],[],16,0,2),be[Ie.RELREF]=X(2,[16,16],[],2,0,2),be[Ie.ARGUMENT]=X(0,[66,81,16],[],4,0,2),be[Ie.SEARCH]=X(2,[2,2,1],[],1,0,0),be[Ie.TRANSPOSE]=X(1,[39],[],32,0,0),be[Ie.ERROR]=X(0,[1,24],[],4,0,2),be[Ie.STEP]=X(0,[],[],4,0,2),be[Ie.TYPE]=X(1,[47],[],1,0,0),be[Ie.ECHO]=X(0,[4],[],4,0,2),be[Ie.SET_NAME]=X(1,[2,63],[],4,0,2),be[Ie.CALLER]=X(0,[],[],50,0,2),be[Ie.DEREF]=X(1,[16],[],47,0,2),be[Ie.WINDOWS]=X(0,[65,66],[],32,0,2),be[Ie.SERIES]=X(4,[87,117,117,1,117],[],4,0,0),be[Ie.DOCUMENTS]=X(0,[1,66],[],32,0,2),be[Ie.ACTIVE_CELL]=X(0,[],[],16,0,2),be[Ie.SELECTION]=X(0,[],[],16,0,2),be[Ie.RESULT]=X(0,[1],[],4,0,2),be[Ie.ATAN2]=X(2,[1,1],[],1,0,0),be[Ie.ASIN]=X(1,[1],[],1,0,0),be[Ie.ACOS]=X(1,[1],[],1,0,0),be[Ie.CHOOSE]=X(2,[33],[575],567,0,0),be[Ie.HLOOKUP]=X(3,[7,49,49,4],[],39,0,0),be[Ie.VLOOKUP]=X(3,[7,49,49,4],[],39,0,0),be[Ie.LINKS]=X(0,[66,65],[],32,0,2),be[Ie.INPUT]=X(1,[2,65,66,67,65,65,2],[],575,0,2),be[Ie.ISREF]=X(1,[63],[],4,0,0),be[Ie.GET_FORMULA]=X(1,[18],[],2,0,2),be[Ie.GET_NAME]=X(1,[2,4],[],6,0,2),be[Ie.SET_VALUE]=X(2,[16,47],[],4,0,2),be[Ie.LOG]=X(1,[1,1],[],1,0,0),be[Ie.EXEC]=X(1,[2,1,4,4],[],7,0,2),be[Ie.CHAR]=X(1,[1],[],2,0,0),be[Ie.LOWER]=X(1,[2],[],2,0,0),be[Ie.UPPER]=X(1,[2],[],2,0,0),be[Ie.PROPER]=X(1,[2],[],2,0,0),be[Ie.LEFT]=X(1,[2,9],[],2,0,0),be[Ie.RIGHT]=X(1,[2,9],[],2,0,0),be[Ie.EXACT]=X(2,[2,2],[],4,0,0),be[Ie.TRIM]=X(1,[2],[],2,0,0),be[Ie.REPLACE]=X(4,[2,1,1,2],[],2,0,0),be[Ie.SUBSTITUTE]=X(3,[2,2,2,2],[],2,0,0),be[Ie.CODE]=X(1,[2],[],1,0,0),be[Ie.NAMES]=X(0,[66,65,66],[],32,0,2),be[Ie.DIRECTORY]=X(0,[2],[],2,0,2),be[Ie.FIND]=X(2,[2,2,1],[],1,0,0),be[Ie.CELL]=X(1,[2,16],[],47,4095,0),be[Ie.ISERR]=X(1,[15],[],4,0,0),be[Ie.ISTEXT]=X(1,[143],[],4,0,0),be[Ie.ISNUMBER]=X(1,[143],[],4,0,0),be[Ie.ISBLANK]=X(1,[143],[],4,0,0),be[Ie.T]=X(1,[23],[],2,0,0),be[Ie.N]=X(1,[23],[],1,0,0),be[Ie.FOPEN]=X(1,[2,1],[],1,0,2),be[Ie.FCLOSE]=X(1,[1],[],1,0,2),be[Ie.FSIZE]=X(1,[1],[],1,0,2),be[Ie.FREADLN]=X(1,[1],[],2,0,2),be[Ie.FREAD]=X(2,[1,1],[],2,0,2),be[Ie.FWRITELN]=X(2,[1,2],[],1,0,2),be[Ie.FWRITE]=X(2,[1,2],[],1,0,2),be[Ie.FPOS]=X(1,[1,1],[],1,0,2),be[Ie.DATEVALUE]=X(1,[3],[],1,0,0),be[Ie.TIMEVALUE]=X(1,[3],[],1,0,0),be[Ie.SLN]=X(3,[1,1,1],[],1,0,0),be[Ie.SYD]=X(4,[1,1,1,1],[],1,0,0),be[Ie.DDB]=X(4,[1,1,1,1,1],[],1,0,0),be[Ie.GET_DEF]=X(1,[2,66,65],[],2,0,2),be[Ie.REFTEXT]=X(1,[16,4],[],2,0,2),be[Ie.TEXTREF]=X(1,[2,4],[],16,0,2),be[Ie.INDIRECT]=X(1,[2,4],[],16,4095,0),be[Ie.REGISTER]=X(1,[2,3,66,66,66,65,67,66,67],[66],3,0,2),be[Ie.CALL]=X(1,[3],[127],575,0,2),be[Ie.ADD_BAR]=X(0,[3],[],1,0,2),be[Ie.ADD_MENU]=X(2,[3,115,83,3],[],1,0,2),be[Ie.ADD_COMMAND]=X(3,[3,83,115,83,3],[],1,0,2),be[Ie.ENABLE_COMMAND]=X(4,[3,3,3,4,3],[],4,0,2),be[Ie.CHECK_COMMAND]=X(4,[3,3,3,4,3],[],4,0,2),be[Ie.RENAME_COMMAND]=X(4,[3,3,3,3,3],[],4,0,2),be[Ie.SHOW_BAR]=X(0,[3],[],4,0,2),be[Ie.DELETE_MENU]=X(2,[3,3,3],[],4,0,2),be[Ie.DELETE_COMMAND]=X(3,[3,3,3,3],[],4,0,2),be[Ie.GET_CHART_ITEM]=X(1,[1,67,66],[],1,0,2),be[Ie.DIALOG_BOX]=X(1,[52],[],36,0,2),be[Ie.CLEAN]=X(1,[2],[],2,0,0),be[Ie.MDETERM]=X(1,[32],[],1,0,0),be[Ie.MINVERSE]=X(1,[32],[],32,0,0),be[Ie.MMULT]=X(2,[32,32],[],32,0,0),be[Ie.FILES]=X(0,[2,2],[],32,0,2),be[Ie.IPMT]=X(4,[1,1,1,1,1,1],[],1,0,0),be[Ie.PPMT]=X(4,[1,1,1,1,1,1],[],1,0,0),be[Ie.COUNTA]=X(1,[],[121],1,0,0),be[Ie.CANCEL_KEY]=X(0,[1,16],[],4,0,2),be[Ie.FOR]=X(3,[2,1,1,1],[],512,0,2),be[Ie.WHILE]=X(1,[4],[],512,0,2),be[Ie.BREAK]=X(0,[],[],512,0,2),be[Ie.NEXT]=X(0,[],[],512,0,2),be[Ie.INITIATE]=X(2,[2,2],[],1,0,2),be[Ie.REQUEST]=X(2,[1,2],[],32,0,2),be[Ie.POKE]=X(3,[1,18,18],[],4,0,2),be[Ie.EXECUTE]=X(2,[1,2],[],4,0,2),be[Ie.TERMINATE]=X(1,[1],[],4,0,2),be[Ie.RESTART]=X(0,[1],[],512,0,2),be[Ie.HELP]=X(0,[2],[],4,0,2),be[Ie.GET_BAR]=X(0,[3,3,3,3],[],3,0,2),be[Ie.PRODUCT]=X(1,[],[113],1,0,0),be[Ie.FACT]=X(1,[1],[],1,0,0),be[Ie.GET_CELL]=X(1,[1,16],[],47,0,2),be[Ie.GET_WORKSPACE]=X(1,[1],[],47,0,2),be[Ie.GET_WINDOW]=X(1,[1,2],[],47,0,2),be[Ie.GET_DOCUMENT]=X(1,[1,2],[],63,0,2),be[Ie.DPRODUCT]=X(3,[16,19,18],[],1,0,0),be[Ie.ISNONTEXT]=X(1,[143],[],4,0,0),be[Ie.GET_NOTE]=X(0,[82,65,65],[],2,0,2),be[Ie.NOTE]=X(0,[66,82,17,17],[],1,0,2),be[Ie.STDEVP]=X(1,[],[49],1,0,0),be[Ie.VARP]=X(1,[],[49],1,0,0),be[Ie.DSTDEVP]=X(3,[16,19,18],[],1,0,0),be[Ie.DVARP]=X(3,[16,19,18],[],1,0,0),be[Ie.TRUNC]=X(1,[1,1],[],1,0,0),be[Ie.ISLOGICAL]=X(1,[143],[],4,0,0),be[Ie.DCOUNTA]=X(3,[16,83,18],[],1,0,0),be[Ie.DELETE_BAR]=X(1,[3],[],4,0,2),be[Ie.UNREGISTER]=X(1,[3],[],4,0,2),be[Ie.USDOLLAR]=X(1,[1,1],[],2,0,0),be[Ie.FINDB]=X(2,[2,2,1],[],1,0,0),be[Ie.SEARCHB]=X(2,[2,2,1],[],1,0,0),be[Ie.REPLACEB]=X(4,[2,1,1,2],[],2,0,0),be[Ie.LEFTB]=X(1,[2,9],[],2,0,0),be[Ie.RIGHTB]=X(1,[2,9],[],2,0,0),be[Ie.MIDB]=X(3,[2,1,1],[],2,0,0),be[Ie.LENB]=X(1,[2],[],1,0,0),be[Ie.ROUNDUP]=X(2,[1,1],[],1,0,0),be[Ie.ROUNDDOWN]=X(2,[1,1],[],1,0,0),be[Ie.ASC]=X(1,[2],[],2,0,0),be[Ie.DBCS]=X(1,[2],[],2,0,0),be[Ie.RANK]=X(2,[1,16,4],[],1,0,0),be[Ie.ADDRESS]=X(2,[1,65,65,68,66],[],2,0,0),be[Ie.DAYS360]=X(2,[1,1,4],[],1,0,0),be[Ie.TODAY]=X(0,[],[],1,4095,0),be[Ie.VDB]=X(5,[1,1,1,1,1,1,4],[],1,0,0),be[Ie.ELSE]=X(0,[],[],512,0,2),be[Ie.ELSE_IF]=X(1,[12],[],512,0,2),be[Ie.END_IF]=X(0,[],[],512,0,2),be[Ie.FOR_CELL]=X(1,[2,82,84],[],512,0,2),be[Ie.MEDIAN]=X(1,[],[49],1,0,0),be[Ie.SUMPRODUCT]=X(1,[],[32],1,0,0),be[Ie.SINH]=X(1,[1],[],1,0,0),be[Ie.COSH]=X(1,[1],[],1,0,0),be[Ie.TANH]=X(1,[1],[],1,0,0),be[Ie.ASINH]=X(1,[1],[],1,0,0),be[Ie.ACOSH]=X(1,[1],[],1,0,0),be[Ie.ATANH]=X(1,[1],[],1,0,0),be[Ie.DGET]=X(3,[16,19,18],[],7,0,0),be[Ie.CREATE_OBJECT]=X(2,[1,18,17,17,18,17,17,115,84,21,17],[],2,0,2),be[Ie.VOLATILE]=X(0,[4],[],4,0,2),be[Ie.LAST_ERROR]=X(0,[],[],16,0,2),be[Ie.CUSTOM_UNDO]=X(0,[2,2],[],4,0,2),be[Ie.CUSTOM_REPEAT]=X(0,[2,2,2],[],4,0,2),be[Ie.FORMULA_CONVERT]=X(2,[2,23,23,23,23],[],2,0,2),be[Ie.GET_LINK_INFO]=X(2,[2,1,1,2],[],1,0,2),be[Ie.TEXT_BOX]=X(1,[2,66,65,65],[],1,0,2),be[Ie.INFO]=X(1,[2],[],3,4095,0),be[Ie.GROUP]=X(0,[],[],2,0,2),be[Ie.GET_OBJECT]=X(1,[1,2,1,1,1],[],47,0,2),be[Ie.DB]=X(4,[1,1,1,1,1],[],1,0,0),be[Ie.PAUSE]=X(0,[4],[],512,0,2),be[Ie.ERROR_CODE]=X(0,[],[],2,0,2),be[Ie.ALLOC_COUNT]=X(0,[],[],1,0,2),be[Ie.RESUME]=X(0,[1],[],512,0,2),be[Ie.FREQUENCY]=X(2,[48,48],[],32,0,0),be[Ie.ADD_TOOLBAR]=X(0,[66,96],[],2,0,2),be[Ie.DELETE_TOOLBAR]=X(1,[2],[],4,0,2),be[Ie._UDF]=X(1,[17],[127],575,0,0),be[Ie.RESET_TOOLBAR]=X(1,[3],[],4,0,2),be[Ie.EVALUATE]=X(1,[2],[],63,0,2),be[Ie.GET_TOOLBAR]=X(1,[1,3],[],47,0,2),be[Ie.GET_TOOL]=X(1,[1,3,1],[],47,0,2),be[Ie.SPELLING_CHECK]=X(1,[2,66,4],[],4,0,2),be[Ie.ERROR_TYPE]=X(1,[15],[],1,0,0),be[Ie.APP_TITLE]=X(0,[2],[],4,0,2),be[Ie.WINDOW_TITLE]=X(0,[2],[],4,0,2),be[Ie.SAVE_TOOLBAR]=X(0,[99,66],[],4,0,2),be[Ie.ENABLE_TOOL]=X(3,[3,1,4],[],4,0,2),be[Ie.PRESS_TOOL]=X(3,[3,1,4],[],4,0,2),be[Ie.REGISTER_ID]=X(2,[2,3,66],[],1,0,2),be[Ie.GET_PROJECT]=X(1,[1,2],[],35,0,2),be[Ie.AVEDEV]=X(1,[],[49],1,0,0),be[Ie.BETADIST]=X(3,[1,1,1,65,65],[],1,0,0),be[Ie.GAMMALN]=X(1,[1],[],1,0,0),be[Ie.BETAINV]=X(3,[1,1,1,65,65],[],1,0,0),be[Ie.BINOMDIST]=X(4,[1,1,1,4],[],1,0,0),be[Ie.CHIDIST]=X(2,[1,1],[],1,0,0),be[Ie.CHIINV]=X(2,[1,1],[],1,0,0),be[Ie.COMBIN]=X(2,[1,1],[],1,0,0),be[Ie.CONFIDENCE]=X(3,[1,1,1],[],1,0,0),be[Ie.CRITBINOM]=X(3,[1,1,1],[],1,0,0),be[Ie.EVEN]=X(1,[1],[],1,0,0),be[Ie.EXPONDIST]=X(3,[1,1,4],[],1,0,0),be[Ie.FDIST]=X(3,[1,1,1],[],1,0,0),be[Ie.FINV]=X(3,[1,1,1],[],1,0,0),be[Ie.FISHER]=X(1,[1],[],1,0,0),be[Ie.FISHERINV]=X(1,[1],[],1,0,0),be[Ie.FLOOR]=X(2,[1,1],[],1,0,0),be[Ie.GAMMADIST]=X(4,[1,1,1,4],[],1,0,0),be[Ie.GAMMAINV]=X(3,[1,1,1],[],1,0,0),be[Ie.CEILING]=X(2,[1,1],[],1,0,0),be[Ie.HYPGEOMDIST]=X(4,[1,1,1,1],[],1,0,0),be[Ie.LOGNORMDIST]=X(3,[1,1,1],[],1,0,0),be[Ie.LOGINV]=X(3,[1,1,1],[],1,0,0),be[Ie.NEGBINOMDIST]=X(3,[1,1,1],[],1,0,0),be[Ie.NORMDIST]=X(4,[1,1,1,4],[],1,0,0),be[Ie.NORMSDIST]=X(1,[1],[],1,0,0),be[Ie.NORMINV]=X(3,[1,1,1],[],1,0,0),be[Ie.NORMSINV]=X(1,[1],[],1,0,0),be[Ie.STANDARDIZE]=X(3,[1,1,1],[],1,0,0),be[Ie.ODD]=X(1,[1],[],1,0,0),be[Ie.PERMUT]=X(2,[1,1],[],1,0,0),be[Ie.POISSON]=X(3,[1,1,4],[],1,0,0),be[Ie.TDIST]=X(3,[1,1,1],[],1,0,0),be[Ie.WEIBULL]=X(4,[1,1,1,4],[],1,0,0),be[Ie.SUMXMY2]=X(2,[32,32],[],1,0,0),be[Ie.SUMX2MY2]=X(2,[32,32],[],1,0,0),be[Ie.SUMX2PY2]=X(2,[32,32],[],1,0,0),be[Ie.CHITEST]=X(2,[32,32],[],1,0,0),be[Ie.CORREL]=X(2,[32,32],[],1,0,0),be[Ie.COVAR]=X(2,[32,32],[],1,0,0),be[Ie.FORECAST]=X(3,[1,32,32],[],1,0,0),be[Ie.FTEST]=X(2,[32,32],[],1,0,0),be[Ie.INTERCEPT]=X(2,[32,32],[],1,0,0),be[Ie.PEARSON]=X(2,[32,32],[],1,0,0),be[Ie.RSQ]=X(2,[32,32],[],1,0,0),be[Ie.STEYX]=X(2,[32,32],[],1,0,0),be[Ie.SLOPE]=X(2,[32,32],[],1,0,0),be[Ie.TTEST]=X(4,[32,32,1,1],[],1,0,0),be[Ie.PROB]=X(3,[32,32,1,65],[],1,0,0),be[Ie.DEVSQ]=X(1,[],[49],1,0,0),be[Ie.GEOMEAN]=X(1,[],[49],1,0,0),be[Ie.HARMEAN]=X(1,[],[49],1,0,0),be[Ie.SUMSQ]=X(1,[],[49],1,0,0),be[Ie.KURT]=X(1,[],[49],1,0,0),be[Ie.SKEW]=X(1,[],[49],1,0,0),be[Ie.ZTEST]=X(2,[49,1,1],[],1,0,0),be[Ie.LARGE]=X(2,[49,1],[],1,0,0),be[Ie.SMALL]=X(2,[49,1],[],1,0,0),be[Ie.QUARTILE]=X(2,[49,1],[],1,0,0),be[Ie.PERCENTILE]=X(2,[49,1],[],1,0,0),be[Ie.PERCENTRANK]=X(2,[49,1,65],[],1,0,0),be[Ie.MODE]=X(1,[],[32],1,0,0),be[Ie.TRIMMEAN]=X(2,[49,1],[],1,0,0),be[Ie.TINV]=X(2,[1,1],[],1,0,0),be[Ie.MOVIE_COMMAND]=X(3,[2,1,1,1],[],1,0,2),be[Ie.GET_MOVIE]=X(2,[2,1,1],[],1,0,2),be[Ie.CONCATENATE]=X(1,[],[2],2,0,0),be[Ie.POWER]=X(2,[1,1],[],1,0,0),be[Ie.SPREADBASE_DATA_FIELD]=X(2,[66,2,66,65,65,65,66,66,66],[],2,0,2),be[Ie.GET_VIEW]=X(1,[1,2],[],35,0,2),be[Ie.GET_FIELD]=X(1,[1,66,2],[],35,0,2),be[Ie.GET_ITEM]=X(1,[1,66,66,2],[],7,0,2),be[Ie.RADIANS]=X(1,[1],[],1,0,0),be[Ie.DEGREES]=X(1,[1],[],1,0,0),be[Ie.SUBTOTAL]=X(2,[1],[16],1,0,0),be[Ie.SUMIF]=X(2,[16,15,16],[],1,0,0),be[Ie.COUNTIF]=X(2,[16,15],[],1,0,0),be[Ie.COUNTBLANK]=X(1,[16],[],1,0,0),be[Ie.SCENARIO_GET]=X(1,[1,2],[],19,0,2),be[Ie.OPTIONS_LISTS]=X(1,[33],[],33,0,2),be[Ie.ISPMT]=X(4,[1,1,1,1],[],1,0,0),be[Ie.DATEDIF]=X(3,[1,1,2],[],1,0,0),be[Ie.DATESTRING]=X(1,[1],[],2,0,0),be[Ie.NUMBERSTRING]=X(2,[1,1],[],2,0,0),be[Ie.ROMAN]=X(1,[1,5],[],2,0,0),be[Ie.OPENDIALOG]=X(0,[66,66,66,65],[],6,0,2),be[Ie.SAVEDIALOG]=X(0,[66,66,66,66,65],[],6,0,2),be[Ie.VIEW_GET]=X(1,[1,2],[],19,0,2),be[Ie.GETPIVOTDATA]=X(2,[18,18],[2,79],15,0,0),be[Ie.HYPERLINK]=X(1,[2,39],[],39,0,0),be[Ie.FURIGANA]=X(1,[16],[],2,0,0),be[Ie.AVERAGEA]=X(1,[],[49],1,0,0),be[Ie.MAXA]=X(1,[],[49],1,0,0),be[Ie.MINA]=X(1,[],[49],1,0,0),be[Ie.STDEVPA]=X(1,[],[49],1,0,0),be[Ie.VARPA]=X(1,[],[49],1,0,0),be[Ie.STDEVA]=X(1,[],[49],1,0,0),be[Ie.VARA]=X(1,[],[49],1,0,0),be[Ie.BAHTTEXT]=X(1,[1],[],2,0,0),be[Ie.THAIDOW]=X(1,[1],[],2,0,0),be[Ie.THAIDIGIT]=X(1,[3],[],2,0,0),be[Ie.THAIMOY]=X(1,[1],[],2,0,0),be[Ie.THAINUMSOUND]=X(1,[1],[],2,0,0),be[Ie.THAINUMSTRING]=X(1,[1],[],2,0,0),be[Ie.THAISTRINGLENGTH]=X(1,[2],[],1,0,0),be[Ie.ISTHAIDIGIT]=X(1,[2],[],4,0,0),be[Ie.ROUNDBAHTDOWN]=X(1,[1],[],1,0,0),be[Ie.ROUNDBAHTUP]=X(1,[1],[],1,0,0),be[Ie.THAIYEAR]=X(1,[1],[],1,0,0),be[Ie.RTD]=X(3,[],[2],2,0,0),be[Ie.CUBEVALUE]=X(1,[2],[50],15,0,0),be[Ie.CUBEMEMBER]=X(2,[2,50,2],[],10,0,0),be[Ie.CUBEMEMBERPROPERTY]=X(3,[2,2,2],[],15,0,0),be[Ie.CUBERANKEDMEMBER]=X(3,[2,2,1,2],[],10,0,0),be[Ie.HEX2BIN]=X(1,[95,95],[],9,0,0),be[Ie.HEX2DEC]=X(1,[95],[],9,0,0),be[Ie.HEX2OCT]=X(1,[95,95],[],9,0,0),be[Ie.DEC2BIN]=X(1,[95,95],[],9,0,0),be[Ie.DEC2HEX]=X(1,[95,95],[],9,0,0),be[Ie.DEC2OCT]=X(1,[95,95],[],9,0,0),be[Ie.OCT2BIN]=X(1,[95,95],[],9,0,0),be[Ie.OCT2HEX]=X(1,[95,95],[],9,0,0),be[Ie.OCT2DEC]=X(1,[95],[],9,0,0),be[Ie.BIN2DEC]=X(1,[95],[],9,0,0),be[Ie.BIN2OCT]=X(1,[95,95],[],9,0,0),be[Ie.BIN2HEX]=X(1,[95,95],[],9,0,0),be[Ie.IMSUB]=X(2,[95,95],[],9,0,0),be[Ie.IMDIV]=X(2,[95,95],[],9,0,0),be[Ie.IMPOWER]=X(2,[95,95],[],9,0,0),be[Ie.IMABS]=X(1,[95],[],9,0,0),be[Ie.IMSQRT]=X(1,[95],[],9,0,0),be[Ie.IMLN]=X(1,[95],[],9,0,0),be[Ie.IMLOG2]=X(1,[95],[],9,0,0),be[Ie.IMLOG10]=X(1,[95],[],9,0,0),be[Ie.IMSIN]=X(1,[95],[],9,0,0),be[Ie.IMCOS]=X(1,[95],[],9,0,0),be[Ie.IMEXP]=X(1,[95],[],9,0,0),be[Ie.IMARGUMENT]=X(1,[95],[],9,0,0),be[Ie.IMCONJUGATE]=X(1,[95],[],9,0,0),be[Ie.IMAGINARY]=X(1,[95],[],9,0,0),be[Ie.IMREAL]=X(1,[95],[],9,0,0),be[Ie.COMPLEX]=X(2,[95,95,95],[],9,0,0),be[Ie.IMSUM]=X(1,[],[127],9,0,0),be[Ie.IMPRODUCT]=X(1,[],[127],9,0,0),be[Ie.SERIESSUM]=X(4,[95,95,95,127],[],9,0,0),be[Ie.FACTDOUBLE]=X(1,[95],[],9,0,0),be[Ie.SQRTPI]=X(1,[95],[],9,0,0),be[Ie.QUOTIENT]=X(2,[95,95],[],9,0,0),be[Ie.DELTA]=X(1,[95,95],[],9,0,0),be[Ie.GESTEP]=X(1,[95,95],[],9,0,0),be[Ie.ISEVEN]=X(1,[95],[],9,0,0),be[Ie.ISODD]=X(1,[95],[],9,0,0),be[Ie.MROUND]=X(2,[95,95],[],9,0,0),be[Ie.ERF]=X(1,[95,95],[],9,0,0),be[Ie.ERFC]=X(1,[95],[],9,0,0),be[Ie.BESSELJ]=X(2,[95,95],[],9,0,0),be[Ie.BESSELK]=X(2,[95,95],[],9,0,0),be[Ie.BESSELY]=X(2,[95,95],[],9,0,0),be[Ie.BESSELI]=X(2,[95,95],[],9,0,0),be[Ie.XIRR]=X(2,[127,127,95],[],9,0,0),be[Ie.XNPV]=X(3,[95,127,127],[],9,0,0),be[Ie.PRICEMAT]=X(5,[95,95,95,95,95,95],[],9,0,0),be[Ie.YIELDMAT]=X(5,[95,95,95,95,95,95],[],9,0,0),be[Ie.INTRATE]=X(4,[95,95,95,95,95],[],9,0,0),be[Ie.RECEIVED]=X(4,[95,95,95,95,95],[],9,0,0),be[Ie.DISC]=X(4,[95,95,95,95,95],[],9,0,0),be[Ie.PRICEDISC]=X(4,[95,95,95,95,95],[],9,0,0),be[Ie.YIELDDISC]=X(4,[95,95,95,95,95],[],9,0,0),be[Ie.TBILLEQ]=X(3,[95,95,95],[],9,0,0),be[Ie.TBILLPRICE]=X(3,[95,95,95],[],9,0,0),be[Ie.TBILLYIELD]=X(3,[95,95,95],[],9,0,0),be[Ie.PRICE]=X(6,[95,95,95,95,95,95,95],[],9,0,0),be[Ie.YIELD]=X(6,[95,95,95,95,95,95,95],[],9,0,0),be[Ie.DOLLARDE]=X(2,[95,95],[],9,0,0),be[Ie.DOLLARFR]=X(2,[95,95],[],9,0,0),be[Ie.NOMINAL]=X(2,[95,95],[],9,0,0),be[Ie.EFFECT]=X(2,[95,95],[],9,0,0),be[Ie.CUMPRINC]=X(6,[95,95,95,95,95,95],[],9,0,0),be[Ie.CUMIPMT]=X(6,[95,95,95,95,95,95],[],9,0,0),be[Ie.EDATE]=X(2,[95,95],[],9,0,0),be[Ie.EOMONTH]=X(2,[95,95],[],9,0,0),be[Ie.YEARFRAC]=X(2,[95,95,95],[],9,0,0),be[Ie.COUPDAYBS]=X(3,[95,95,95,95],[],9,0,0),be[Ie.COUPDAYS]=X(3,[95,95,95,95],[],9,0,0),be[Ie.COUPDAYSNC]=X(3,[95,95,95,95],[],9,0,0),be[Ie.COUPNCD]=X(3,[95,95,95,95],[],9,0,0),be[Ie.COUPNUM]=X(3,[95,95,95,95],[],9,0,0),be[Ie.COUPPCD]=X(3,[95,95,95,95],[],9,0,0),be[Ie.DURATION]=X(5,[95,95,95,95,95,95],[],9,0,0),be[Ie.MDURATION]=X(5,[95,95,95,95,95,95],[],9,0,0),be[Ie.ODDLPRICE]=X(7,[95,95,95,95,95,95,95,95],[],9,0,0),be[Ie.ODDLYIELD]=X(7,[95,95,95,95,95,95,95,95],[],9,0,0),be[Ie.ODDFPRICE]=X(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),be[Ie.ODDFYIELD]=X(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),be[Ie.RANDBETWEEN]=X(2,[95,95],[],9,4095,0),be[Ie.WEEKNUM]=X(1,[95,95],[],9,0,0),be[Ie.AMORDEGRC]=X(6,[95,95,95,95,95,95,95],[],9,0,0),be[Ie.AMORLINC]=X(6,[95,95,95,95,95,95,95],[],9,0,0),be[Ie.CONVERT]=X(3,[95,95,95],[],9,0,0),be[Ie.ACCRINT]=X(6,[95,95,95,95,95,95,95,95],[],9,0,0),be[Ie.ACCRINTM]=X(4,[95,95,95,95,95],[],9,0,0),be[Ie.WORKDAY]=X(2,[95,95,127],[],9,0,0),be[Ie.NETWORKDAYS]=X(2,[95,95,127],[],9,0,0),be[Ie.GCD]=X(1,[],[127],9,0,0),be[Ie.MULTINOMIAL]=X(1,[],[127],9,0,0),be[Ie.LCM]=X(1,[],[127],9,0,0),be[Ie.FVSCHEDULE]=X(2,[95,127],[],9,0,0),be[Ie.CUBEKPIMEMBER]=X(3,[2,2,1,2],[],10,0,0),be[Ie.CUBESET]=X(2,[2,50,2,1,2],[],10,0,0),be[Ie.CUBESETCOUNT]=X(1,[2],[],9,0,0),be[Ie.IFERROR]=X(2,[47,575],[],47,0,0),be[Ie.COUNTIFS]=X(2,[],[16,15],1,0,0),be[Ie.SUMIFS]=X(3,[16],[16,15],1,0,0),be[Ie.AVERAGEIF]=X(2,[16,15,16],[],1,0,0),be[Ie.AVERAGEIFS]=X(3,[16],[16,15],1,0,0),be[Ie.AGGREGATE]=X(3,[1,1,48,17],[16],1,0,0),be[Ie.BINOM_DIST]=X(4,[1,1,1,4],[],1,0,0),be[Ie.BINOM_INV]=X(3,[1,1,1],[],1,0,0),be[Ie.CONFIDENCE_NORM]=X(3,[1,1,1],[],1,0,0),be[Ie.CONFIDENCE_T]=X(3,[1,1,1],[],1,0,0),be[Ie.CHISQ_TEST]=X(2,[32,32],[],1,0,0),be[Ie.F_TEST]=X(2,[32,32],[],1,0,0),be[Ie.COVARIANCE_P]=X(2,[32,32],[],1,0,0),be[Ie.COVARIANCE_S]=X(2,[32,32],[],1,0,0),be[Ie.EXPON_DIST]=X(3,[1,1,4],[],1,0,0),be[Ie.GAMMA_DIST]=X(4,[1,1,1,4],[],1,0,0),be[Ie.GAMMA_INV]=X(3,[1,1,1],[],1,0,0),be[Ie.MODE_MULT]=X(1,[],[32],32,0,0),be[Ie.MODE_SNGL]=X(1,[],[32],1,0,0),be[Ie.NORM_DIST]=X(4,[1,1,1,4],[],1,0,0),be[Ie.NORM_INV]=X(3,[1,1,1],[],1,0,0),be[Ie.PERCENTILE_EXC]=X(2,[49,1],[],1,0,0),be[Ie.PERCENTILE_INC]=X(2,[49,1],[],1,0,0),be[Ie.PERCENTRANK_EXC]=X(2,[49,1,65],[],1,0,0),be[Ie.PERCENTRANK_INC]=X(2,[49,1,65],[],1,0,0),be[Ie.POISSON_DIST]=X(3,[1,1,4],[],1,0,0),be[Ie.QUARTILE_EXC]=X(2,[49,1],[],1,0,0),be[Ie.QUARTILE_INC]=X(2,[49,1],[],1,0,0),be[Ie.RANK_AVG]=X(2,[1,16,4],[],1,0,0),be[Ie.RANK_EQ]=X(2,[1,16,4],[],1,0,0),be[Ie.STDEV_S]=X(1,[],[49],1,0,0),be[Ie.STDEV_P]=X(1,[],[49],1,0,0),be[Ie.T_DIST]=X(3,[1,1,4],[],1,0,0),be[Ie.T_DIST_2T]=X(2,[1,1],[],1,0,0),be[Ie.T_DIST_RT]=X(2,[1,1],[],1,0,0),be[Ie.T_INV]=X(2,[1,1],[],1,0,0),be[Ie.T_INV_2T]=X(2,[1,1],[],1,0,0),be[Ie.VAR_S]=X(1,[],[49],1,0,0),be[Ie.VAR_P]=X(1,[],[49],1,0,0),be[Ie.WEIBULL_DIST]=X(4,[1,1,1,4],[],1,0,0),be[Ie.NETWORKDAYS_INTL]=X(2,[95,95,75,127],[],9,0,0),be[Ie.WORKDAY_INTL]=X(2,[95,95,75,127],[],9,0,0),be[Ie.ECMA_CEILING]=X(2,[1,1],[],1,0,0),be[Ie.ISO_CEILING]=X(1,[1,65],[],1,0,0),be[Ie.DEBUG]=X(1,[2],[1151],1087,0,0),be[Ie.BETA_DIST]=X(4,[1,1,1,4,65,65],[],1,0,0),be[Ie.BETA_INV]=X(3,[1,1,1,65,65],[],1,0,0),be[Ie.CHISQ_DIST]=X(3,[1,1,4],[],1,0,0),be[Ie.CHISQ_DIST_RT]=X(2,[1,1],[],1,0,0),be[Ie.CHISQ_INV]=X(2,[1,1],[],1,0,0),be[Ie.CHISQ_INV_RT]=X(2,[1,1],[],1,0,0),be[Ie.F_DIST]=X(4,[1,1,1,4],[],1,0,0),be[Ie.F_DIST_RT]=X(3,[1,1,1],[],1,0,0),be[Ie.F_INV]=X(3,[1,1,1],[],1,0,0),be[Ie.F_INV_RT]=X(3,[1,1,1],[],1,0,0),be[Ie.HYPGEOM_DIST]=X(5,[1,1,1,1,4],[],1,0,0),be[Ie.LOGNORM_DIST]=X(4,[1,1,1,4],[],1,0,0),be[Ie.LOGNORM_INV]=X(3,[1,1,1],[],1,0,0),be[Ie.NEGBINOM_DIST]=X(4,[1,1,1,4],[],1,0,0),be[Ie.NORM_S_DIST]=X(2,[1,4],[],1,0,0),be[Ie.NORM_S_INV]=X(1,[1],[],1,0,0),be[Ie.T_TEST]=X(4,[32,32,1,1],[],1,0,0),be[Ie.Z_TEST]=X(2,[49,1,1],[],1,0,0),be[Ie.ERF_PRECISE]=X(1,[95],[],9,0,0),be[Ie.ERFC_PRECISE]=X(1,[95],[],9,0,0),be[Ie.GAMMALN_PRECISE]=X(1,[1],[],1,0,0),be[Ie.CEILING_PRECISE]=X(1,[1,65],[],1,0,0),be[Ie.FLOOR_PRECISE]=X(1,[1,65],[],1,0,0),be[Ie.ACOT]=X(1,[1],[],1,0,0),be[Ie.ACOTH]=X(1,[1],[],1,0,0),be[Ie.COT]=X(1,[1],[],1,0,0),be[Ie.COTH]=X(1,[1],[],1,0,0),be[Ie.CSC]=X(1,[1],[],1,0,0),be[Ie.CSCH]=X(1,[1],[],1,0,0),be[Ie.SEC]=X(1,[1],[],1,0,0),be[Ie.SECH]=X(1,[1],[],1,0,0),be[Ie.IMTAN]=X(1,[95],[],9,0,0),be[Ie.IMCOT]=X(1,[95],[],9,0,0),be[Ie.IMCSC]=X(1,[95],[],9,0,0),be[Ie.IMCSCH]=X(1,[95],[],9,0,0),be[Ie.IMSEC]=X(1,[95],[],9,0,0),be[Ie.IMSECH]=X(1,[95],[],9,0,0),be[Ie.BITAND]=X(2,[1,1],[],1,0,0),be[Ie.BITOR]=X(2,[1,1],[],1,0,0),be[Ie.BITXOR]=X(2,[1,1],[],1,0,0),be[Ie.BITLSHIFT]=X(2,[1,1],[],1,0,0),be[Ie.BITRSHIFT]=X(2,[1,1],[],1,0,0),be[Ie.PERMUTATIONA]=X(2,[1,1],[],1,0,0),be[Ie.COMBINA]=X(2,[1,1],[],1,0,0),be[Ie.XOR]=X(1,[],[52],4,0,0),be[Ie.PDURATION]=X(3,[1,1,1],[],1,0,0),be[Ie.BASE]=X(2,[1,1,65],[],2,0,0),be[Ie.DECIMAL]=X(2,[2,1],[],1,0,0),be[Ie.DAYS]=X(2,[3,3],[],1,0,0),be[Ie.BINOM_DIST_RANGE]=X(3,[1,1,1,65],[],1,0,0),be[Ie.GAMMA]=X(1,[1],[],1,0,0),be[Ie.SKEW_P]=X(1,[],[49],1,0,0),be[Ie.GAUSS]=X(1,[1],[],1,0,0),be[Ie.PHI]=X(1,[1],[],1,0,0),be[Ie.RRI]=X(3,[1,1,1],[],1,0,0),be[Ie.UNICHAR]=X(1,[1],[],2,0,0),be[Ie.UNICODE]=X(1,[2],[],1,0,0),be[Ie.MUNIT]=X(1,[1],[],32,0,0),be[Ie.ARABIC]=X(1,[2],[],1,0,0),be[Ie.ISOWEEKNUM]=X(1,[1],[],1,0,0),be[Ie.NUMBERVALUE]=X(1,[2,66,66],[],1,0,0),be[Ie.SHEET]=X(0,[50],[],1,4095,0),be[Ie.SHEETS]=X(0,[48],[],1,4095,0),be[Ie.FORMULATEXT]=X(1,[16],[],2,4095,0),be[Ie.ISFORMULA]=X(1,[16],[],4,0,0),be[Ie.IFNA]=X(2,[47,575],[],47,0,0),be[Ie.CEILING_MATH]=X(1,[1,65,65],[],1,0,0),be[Ie.FLOOR_MATH]=X(1,[1,65,65],[],1,0,0),be[Ie.IMSINH]=X(1,[95],[],9,0,0),be[Ie.IMCOSH]=X(1,[95],[],9,0,0),be[Ie.FILTERXML]=X(2,[2,2],[],47,0,0),be[Ie.WEBSERVICE]=X(1,[2],[],10,0,0),be[Ie.ENCODEURL]=X(1,[2],[],10,0,0),be[Ie.FORECAST_ETS]=X(3,[1,48,48,65,65,65],[],1,0,0),be[Ie.FORECAST_ETS_CONFINT]=X(3,[1,48,48,65,65,65,65],[],1,0,0),be[Ie.FORECAST_ETS_SEASONALITY]=X(2,[48,48,65,65],[],1,0,0),be[Ie.FORECAST_LINEAR]=X(3,[1,32,32],[],1,0,0),be[Ie.FORECAST_ETS_STAT]=X(3,[48,48,1,65,65,65],[],1,0,0),be[Ie.MAXIFS]=X(3,[16],[16,15],1,0,0),be[Ie.MINIFS]=X(3,[16],[16,15],1,0,0),be[Ie.TEXTJOIN]=X(3,[114,68],[114],2,0,0),be[Ie.CONCAT]=X(1,[],[114],2,0,0),be[Ie.IFS]=X(2,[],[44,575],575,0,0),be[Ie.SWITCH]=X(3,[47,575],[575,575],575,0,0),be[Ie.SINGLE]=X(1,[1079,4],[],1055,0,1),be[Ie.AVERAGE_WEIGHTED]=X(2,[],[113,113],1,0,1),be[Ie.ANCHORARRAY]=X(1,[16],[],48,0,1),be[Ie.IMAGE]=X(1,[2],[],2,0,1),be[Ie.RECORD]=X(3,[47],[2,47],47,0,1),be[Ie.GRF]=X(1,[15,2],[],15,0,1),be[Ie.UNIT]=X(2,[15,2],[],15,0,1),be[Ie.RICHERROR]=X(1,[1],[],10,0,1),be[Ie.FILTER]=X(2,[48,48],[],32,0,1),be[Ie.FUN]=X(1,[],[63],63,0,1),be[Ie.LET]=X(3,[63,63,63],[],63,0,1),be[Ie.ARRAYMAKE]=X(3,[1,1,63],[],32,0,1),be[Ie.APPLY]=X(1,[],[63],63,0,1),be[Ie.ISFUN]=X(1,[63],[],4,0,1),be[Ie.ARITY]=X(1,[63],[],9,0,1),be[Ie.RECURSE]=X(0,[],[],63,0,1);var Be,we=X(0,[],[P.All],P.All,b.All,B.None);!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.Dot=24]="Dot"}(Be||(Be={}));var Ge,Ve,xe=U.Number|U.String|U.Boolean,We=U.Number|U.String|U.Boolean|U.Blank,He=X(2,[U.Number,U.Number],[],U.Number,b.None,B.None),Ke=X(1,[U.Number],[],U.Number,b.None,B.None),Xe=X(1,[xe],[],xe,b.None,B.None),Qe=X(2,[U.String,U.String],[],U.String,b.None,B.None),Ye=X(2,[We,We],[],U.Boolean,b.None,B.None),Je=X(2,[U.Range,U.Range],[],U.Range,b.AllCells,B.None),je=X(2,[U.Range,U.Range],[],U.Range,b.None,B.None),qe=X(2,[U.Boolean,U.Boolean],[],U.Boolean,b.None,B.None),ze=[];function Ze(e){var r=ze[e];return null!=r?r:we}function $e(e){var r=be[e];return null!=r?r:we}function er(e,r){var n=be[e];null!=n&&(n.staticPrecs=r)}function rr(e){return 1===e.length}function nr(e){return 1===e.rows&&1===e.cols}function tr(e){return rr(e.sheet)}function ar(e){return nr(e.range)}function or(e){return nr(e)?e:_(e.row,e.col,1,1)}function ir(e){return ar(e)?e:W(e.sheet,or(e.range))}function ur(e,r){var n=e.row,t=e.col,a=r.row,o=r.col;return _(Math.min(n,a),Math.min(t,o),Math.abs(a-n)+1,Math.abs(o-t)+1)}function cr(e){return 0===function(e){if(1===e.args.length){var r=e.args[0];if(r.kind===le.Literal&&fr(r.oper)===U.Missing)return 0}return e.args.length}(e)?[]:e.args}function lr(e,r){A("calc.runtime.getArgType",r);var n=e.headTypes,t=n.length;if(r<t)return n[r];var a=e.restTypes,o=a.length;return o>0?a[(r-t)%o]:P.None}function sr(e,r){return!(r<e.minArgs)&&(r<=e.headTypes.length||e.restTypes.length>0)}function fr(e){switch(typeof e){case"number":return U.Number;case"string":return U.String;case"boolean":return U.Boolean;default:return e.kind}}function dr(e){return"number"==typeof e&&isFinite(e)}function Er(e){return{kind:Ge.Success,value:e}}function pr(e){return{kind:Ge.Failure,reason:e}}function vr(e){return null!=e&&e.kind===Ge.Success}function Tr(e){return{kind:Ve.NotImplemented,features:e}}function hr(e){return 0===e.length&&g("calc.lang.unavailable: expected nonempty array"),{kind:Ve.Unavailable,objects:e}}function Rr(e){if(null!=e){var r=e.path,n=e.name;return null!==r&&void 0!==r&&"string"!=typeof r?(R.ULS.traceTag(595969803,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Illegal document path: type is "+typeof r),O):"string"!=typeof n?(R.ULS.traceTag(595969804,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Illegal document name: type is "+typeof n),O):e}}ze[Be.Add]=He,ze[Be.Sub]=He,ze[Be.Mul]=He,ze[Be.Div]=He,ze[Be.Pow]=He,ze[Be.Percent]=Ke,ze[Be.Neg]=Ke,ze[Be.Pos]=Xe,ze[Be.Concat]=Qe,ze[Be.Eq]=Ye,ze[Be.Ne]=Ye,ze[Be.Lt]=Ye,ze[Be.Le]=Ye,ze[Be.Gt]=Ye,ze[Be.Ge]=Ye,ze[Be.Range]=Je,ze[Be.Isect]=je,ze[Be.Union]=je,ze[Be.And]=qe,ze[Be.Or]=qe,ze[Be.Xor]=qe,ze[Be.Min]=He,ze[Be.Max]=He,er(Ie.ROW,b.OwnRow),er(Ie.COLUMN,b.OwnCol),er(Ie.SHEET,b.OwnDocSheets),er(Ie.SHEETS,b.OwnDocSheets),er(Ie.OFFSET,b.AllCells),er(Ie.INDIRECT,b.AllCells),er(Ie.SUMIF,b.AllCells),er(Ie.NOW,b.Time),er(Ie.TODAY,b.Time),er(Ie.RAND,b.Calc),er(Ie.RANDBETWEEN,b.Calc),er(Ie.SUBTOTAL,b.CellProps),er(Ie.CELL,b.CellProps|b.AllCells),er(Ie.INFO,b.Calc),er(Ie.FORMULATEXT,b.None),function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(Ge||(Ge={})),function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable"}(Ve||(Ve={}));var Sr,Ir={ULS:new c.NulLogger};Object(c.initStopwatchFactory)(function(e){return Ir.ULS.traceTag(595948114,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,e)});!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcNewFunctions="CalcNewFunctions",e.CalcContractChecks="CalcContractChecks",e.CalcSupportDynamicArrays="CalcSupportDynamicArrays",e.CalcFormatCalculations="CalcFormatCalculations",e.CalcFormulaCacheAPIChanges="CalcFormulaCacheAPIChanges",e.CalcStrictFormulaChecking="CalcStrictFormulaChecking",e.CalcUnifyRangeResolutionCode="CalcUnifyRangeResolutionCode"}(Sr||(Sr={}));var gr=function(e){return!1},Ar={};function Nr(e){return void 0===Ar[e]&&(Ar[e]=gr(e)),Ar[e]}function Cr(e,r){return{wrap:e,unwrap:r}}function Or(e){return e}function mr(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function Dr(e){var r=mr();for(var n in e)r[n]=e[n];return r}function Lr(e){return null!=e}function Mr(e){return null==e}function _r(e,r){return void 0!==e?e:r}var yr=100;function Fr(e,r,n){return void 0===n&&(n=yr),r.maxDepth=n,r.level=0,kr(e,r)}function kr(e,r){if(r.level===r.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+r.level;var n;switch(r.level+=1,e.kind){case le.Literal:n=function(e,r){if("boolean"==typeof e)return r.visitBoolean(e);if("number"==typeof e)return r.visitNumber(e);if("string"==typeof e)return r.visitString(e);if(e.kind===U.Missing)return r.visitMissing(e);if(e.kind===U.Error)switch(e.type){case w.NULL:return r.visitNullError(e);case w.DIV0:return r.visitDiv0Error(e);case w.VALUE:return r.visitValueError(e);case w.REF:return r.visitRefError(e);case w.NAME:return r.visitNameError(e);case w.NUM:return r.visitNumError(e);case w.NA:return r.visitNAError(e);case w.GETTING_DATA:return r.visitDataError(e)}throw"Tried to visit unrecognized AST node: "+e.kind+"."}(e.oper,r.operVisitor);break;case le.Array:n=r.visitArray(e);break;case le.App:n=r.visitApp(e);break;case le.Paren:n=r.visitParen(e);break;case le.Name:n=r.visitName(e);break;case le.CellRef:n=r.visitCellRef(e);break;case le.Bad:n=r.visitBad(e);break;case le.Operator:n=r.visitOperator(e);break;case ue.Error:n=r.visitRefError(e);break;case ue.Single:n=r.visitSingle(e);break;case ue.Range:n=r.visitRange(e);break;case ue.Row:n=r.visitRow(e);break;case ue.Col:n=r.visitCol(e);break;case ie.Error:n=r.visitNameError(e);break;case ie.Relative:n=r.visitRelative(e);break;case ie.Document:n=r.visitDocument(e);break;case ie.Sheet:n=r.visitSheet(e);break;case ie.Ident:n=r.visitIdent(e);break;case ie.SheetRange:n=r.visitSheetRange(e);break;default:throw"Tried to visit unrecognized AST node: "+e.kind+"."}return r.level-=1,n}function Ur(e){return{visitString:e,visitBoolean:e,visitNumber:e,visitMissing:e,visitNullError:e,visitDiv0Error:e,visitValueError:e,visitRefError:e,visitNameError:e,visitNumError:e,visitNAError:e,visitDataError:e}}function Pr(e,r,n){return{level:0,operVisitor:e,visitArray:_r(n.vArray,r),visitApp:_r(n.vApp,r),visitParen:_r(n.vParen,r),visitName:_r(n.vName,r),visitCellRef:_r(n.vCellRef,r),visitBad:_r(n.vBad,r),visitOperator:_r(n.vOperator,r),visitRefError:_r(n.vRefError,r),visitSingle:_r(n.vSingle,r),visitRange:_r(n.vRange,r),visitRow:_r(n.vRow,r),visitCol:_r(n.vCol,r),visitNameError:_r(n.vNameError,r),visitRelative:_r(n.vRelative,r),visitDocument:_r(n.vDocument,r),visitSheet:_r(n.vSheet,r),visitIdent:_r(n.vIdent,r),visitSheetRange:_r(n.vSheetRange,r)}}var br=["+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":"," ",","];function Br(e,r){for(var n=e,t="";n>0;){var a=(n-1)%26;t=String.fromCharCode(65+a).concat(t),n=Math.floor((n-a)/26)}return(r?"$":"")+t}var wr={level:0,operVisitor:{visitString:function(e){return'"'+e+'"'},visitBoolean:function(e){return e.toString().toLocaleUpperCase()},visitNumber:function(e){return e.toString()},visitMissing:function(e){return""},visitNullError:function(e){return"#NULL!"},visitDiv0Error:function(e){return"#DIV/0!"},visitValueError:function(e){return"#VALUE!"},visitRefError:function(e){return"#REF!"},visitNameError:function(e){return"#NAME?"},visitNumError:function(e){return"#NUM!"},visitNAError:function(e){return"#N/A"},visitDataError:function(e){return"#GETTING_DATA!"}},visitArray:function(e){var r=[];return e.nodes.forEach(function(e){var n=[];e.forEach(function(e){n.push(kr(e,wr))}),r.push(n.join(","))}),"{"+r.join(";")+"}"},visitApp:function(e){var r=[];e.args.forEach(function(e){r.push(kr(e,wr))});var n=kr(e.head,wr);if(e.head.kind===le.Operator){if(e.head.id===Be.Percent)return r[0]+"%";if(1===r.length)return n+r[0];if(2===r.length)return r[0]+n+r[1];throw"Tried to pretty print operator with 0 or more than 2 operators"}return n+"("+r.join(",")+")"},visitParen:function(e){return"("+kr(e.node,wr)+")"},visitName:function(e){return e.whole},visitCellRef:function(e){var r="";return void 0!==e.qualifier&&(r=kr(e.qualifier,this)+"!"),r+kr(e.ref,this)},visitBad:function(e){if(e.type===se.Sequence){var r=[];return e.contents.forEach(function(e){r.push(kr(e,wr))}),r.join("")}return e.contents},visitOperator:function(e){return br[e.id-1]},visitRefError:function(e){return"#REF!"},visitSingle:function(e){return function(e,r,n,t){return Br(n,t)+(r?"$":"")+e}(e.row.index+1,e.row.kind===ce.Abs,e.col.index+1,e.col.kind===ce.Abs)},visitRange:function(e){return kr(e.ref1,wr)+":"+kr(e.ref2,wr)},visitRow:function(e){var r=e.row1.index+1,n=e.row1.kind===ce.Abs,t=e.row2.index+1,a=e.row2.kind===ce.Abs;return(n?"$":"")+r+":"+(a?"$":"")+t},visitCol:function(e){var r=e.col1.index+1,n=e.col1.kind===ce.Abs,t=e.col2.index+1,a=e.col2.kind===ce.Abs;return Br(r,n)+":"+Br(t,a)},visitNameError:function(e){return"#REF"},visitRelative:function(e){return""},visitDocument:function(e){return void 0!==e.path?e.path+"/"+e.document:e.document},visitSheet:function(e){return(void 0!==e.document?kr(e.document,wr):"")+e.sheet},visitIdent:function(e){return e.name},visitSheetRange:function(e){return e.sheet1+":"+e.sheet2}};function Gr(e){var r=function(e){try{return Er("="+Fr(e,wr))}catch(e){return R.ULS.traceTag(595964180,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"PrettyPrinter failed: "+e),wr.level=0,pr(e)}}(e);if(r.kind===Ge.Success){return r.value.toLowerCase().replace(/d/g,"w").replace(/[0-9]/g,"d").replace(new RegExp('[^/=\\[\\]\\.\\\\\\/%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*/g/\\u0024\\u0080\\u00a2\\u00a3\\u00a4\\u00a5\\u20a0\\u20a1\\u20a2\\u20a3\\u20a4\\u20a5\\u20a6\\u20a7\\u20a8\\u20a9\\u20aa\\u20ab\\u20ac\\u20ad\\u20ae\\u20af\\u20b0\\u20b1\\u20b2\\u20b3\\u20b4\\u20b5\\u20b6\\u20b7\\u20b8\\u20b9/g/\\s\\ua0c2/gd]',"g"),"w")}}function Vr(e){return Gr(e.node)}function xr(e){return h.FormulaNode=Gr,h.Formula=Vr,{localeInfo:e}}function Wr(e,r){S(e),function(e){Ir.ULS=e}(e),function(e){"function"==typeof e&&(gr=e)}(r)}function Hr(e,r,n,t,a,o,i,u,c,l,s,f,d,E,p,v,T,h,R,S,I,g){return{parseNumber:e,formatNumber:r,getWorksheetFuncId:n,getWorksheetFuncName:t,isNumeral:a,getOrdinal:o,getNumeral:i,isLetter:u,stringCompareCI:c,errorNames:l,trueName:s,falseName:f,rowLetter:d,columnLetter:E,leftBrace:p,rightBrace:v,leftBracket:T,rightBracket:h,decimalSeparator:R,listSeparator:S,columnSeparator:I,rowSeparator:g}}var Kr,Xr,Qr,Yr,Jr,jr,qr=ue,zr=ce,Zr=ie,$r=ve,en=F,rn=M,nn=L,tn=V,an=H,on=K,un=ur,cn=vr,ln=Ve,sn=Tr;function fn(e){if(void 0===e)return!0;switch(e.kind){case ln.NotImplemented:case ln.Unavailable:return!0}return!1}function dn(e,r,n){return function(t,a){return void 0===a?r(t):fn(a)?n(a,t):e(a)}}function En(e,r){return function(n){if(Array.isArray(n)){for(var t=void 0,a=0;a<n.length;a+=1){var o=n[a];if(void 0!==(t=e(o)))return[o,t]}return r}var i=e(n);return void 0===i?r:[n,i]}}function pn(e,r){return r.kind===zr.Abs?r.index:e+r.index}function vn(e,r){var n=pn(e.row,r.row),t=pn(e.col,r.col);return en(n,t)}function Tn(e,r){switch(r.kind){case qr.Error:return;case qr.Single:var n=vn(e,r);return en(n.row,n.col);case qr.Range:var t=vn(e,r.ref1),a=vn(e,r.ref2);return un(t,a);case qr.Row:return sn(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]);case qr.Col:return sn(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]);default:return I("calc.runtime.resolverService.resolveGridRef",r)}}function hn(e){function r(r){var n=e.getDocumentLoc(r.path,r.document);return Lr(n)?n:void 0}function n(n,t){var a=Lr(t.document)?r(t.document):n;if(!Mr(a)){var o=e.getSheetIndex(a,t.sheet);return cn(o)?Lr(o.value)?rn(a,o.value):void 0:o.reason}}return{resolveName:function(t,a,o){if(Mr(a)||a.kind===Zr.Relative)return[on(t.sheet,o),on(an(t.sheet.document),o)];var i=function(t,a){switch(a.kind){case Zr.Document:var o=r(a);return Lr(o)?an(o):o;case Zr.Sheet:return n(t.sheet.document,a);case Zr.Ident:var i=t.sheet.document,u=e.getSheetIndex(i,a.name);if(cn(u)){if(Lr(u.value))return rn(i,u.value);var c=r($r(a.name));return Lr(c)?an(c):void 0}return u.reason;default:return I("calc.runtime.resolverService.resolveNameQualifier",a)}}(t,a);return fn(i)?i:on(i,o)},resolveGridRef:Tn,resolveCellRef:function(r,t,a){var o=Tn(r.range,a);if(fn(o))return o;var i=Mr(t)?r.sheet:function(r,t){switch(t.kind){case Zr.Error:return;case Zr.Sheet:return n(r.document,t);case Zr.SheetRange:var a=r.document,o=e.getSheetIndex(a,t.sheet1);if(!cn(o))return o.reason;var i=e.getSheetIndex(a,t.sheet2);if(!cn(i))return i.reason;var u=o.value,c=i.value;if(Mr(u)||Mr(c))return;return u===c?rn(a,u):nn(a,Math.min(u,c),Math.abs(c-u)+1);case Zr.Relative:return r;default:return I("calc.runtime.resolverService.resolveCellRefQualifier",t)}}(r.sheet,t);return fn(i)?i:tn(i,o)}}}!function(e){e.FormulaSource=p,e.documentLoc=m,e.sheetIndex=M,e.sheetRange=L,e.gridCell=F,e.gridRange=y,e.sheetGridCell=W,e.sheetGridRange=x,e.sheetGridCube=V,e.documentScope=H,e.nameLoc=K}(Kr||(Kr={})),function(e){e.SpecialPrecs=b,e.OperKind=U,e.ErrorType=w,e.ErrorTypeBounds=G,e.precedents=Q,e.errorOper=Y,e.nullErrorOper=J,e.div0ErrorOper=j,e.valueErrorOper=q,e.refErrorOper=z,e.nameErrorOper=Z,e.numErrorOper=$,e.naErrorOper=ee,e.gettingDataErrorOper=re,e.arrayOper=ne,e.rangeSeqOper=te,e.range3DOper=ae,e.missingOper=fe,e.blankOper=de}(Xr||(Xr={})),function(e){e.RefStyle=oe,e.QualifierKind=ie,e.CellRefKind=ue,e.PosKind=ce,e.NodeKind=le,e.BadType=se,e.errorQualifier=Ee,e.relativeQualifier=pe,e.documentQualifier=ve,e.sheetQualifier=Te,e.identQualifier=he,e.sheetRangeQualifier=Re,e.pos=Se,e.cellRefError=ge,e.cellRefSingle=Ae,e.cellRefRange=Ne,e.cellRefRow=Ce,e.cellRefCol=Oe,e.formula=me,e.formulaSpan=De,e.literalNode=Le,e.arrayNode=Me,e.appNode=_e,e.operatorNode=ye,e.parenNode=Fe,e.nameNode=ke,e.cellRefNode=Ue,e.badNode=Pe}(Qr||(Qr={})),function(e){e.SignatureType=P,e.FunctionFlags=B,e.OperatorId=Be,e.WorksheetFuncId=Ie,e.SpecialPrecs=b,e.functionType=X,e.unknownFunctionType=we,e.getOperatorType=Ze,e.getWorksheetFuncType=$e}(Yr||(Yr={})),function(e){e.isSheetIndex=rr,e.isSheetGridRange=tr,e.isGridCell=nr,e.isSheetGridCell=ar,e.gridRangeAnchor=or,e.sheetGridRangeAnchor=ir,e.gridCellRange=ur,e.getArguments=cr,e.getArgType=lr,e.isValidArgsLength=sr,e.operKind=fr,e.ResultKind=Ge,e.success=Er,e.failure=pr,e.isSuccess=vr,e.ReasonKind=Ve,e.notImplemented=Tr,e.unavailable=hr,e.createResolver=hn,e.createResolutionHandler=dn,e.createNameFinder=En,e.defaultLiteralVisitor=Ur,e.defaultFormulaVisitor=Pr,e.dispatch=kr,e.startVisit=Fr}(Jr||(Jr={})),function(e){e.localeInfo=Hr,e.calcConfig=xr,e.initCalc=Wr}(jr||(jr={}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var Rn=function(e,r){return(Rn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])})(e,r)};function Sn(e,r){function n(){this.constructor=e}Rn(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var In=function(){return(In=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var a in r=arguments[n])Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);return e}).apply(this,arguments)};var gn,An=Jr.ReasonKind,Nn=Jr.notImplemented;!function(e){e.BadFormulaString="BadFormulaString"}(gn||(gn={}));var Cn=In({},An,gn);function On(e){return{kind:Cn.BadFormulaString,message:e}}var mn=" \t\n\r";function Dn(e){return mn.indexOf(e)>=0}function Ln(e,r){return"\\"===r||"_"===r||e.isLetter(r)}function Mn(e,r){return"."===r||Ln(e,r)||e.isNumeral(r)}function _n(e,r){var n=r-1;return function(r){if(r<=n){var t=e+": internal error: no progress made at index "+r;return R.ULS.assertTag(595980821,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}n=r}}function yn(e,r,n){for(var t=r;t<e.length&&n(e[t]);t+=1);return[e.substring(r,t),t]}function Fn(e,r,n,t,a){var o=e[r];return n(o)?1:o===t&&a(e[r+1])?2:0}function kn(e,r,n,t,a){for(var o=[],i=r,u=r;u<e.length;){var c=Fn(e,u,n,t,a);if(0===c)break;2===c&&(i!==u&&o.push(e.substring(i,u)),i=u+1),u+=c}return i!==u&&o.push(e.substring(i,u)),[o.join(""),u]}var Un,Pn,bn,Bn,wn=Xr.nullErrorOper,Gn=Xr.div0ErrorOper,Vn=Xr.valueErrorOper,xn=Xr.refErrorOper,Wn=Xr.nameErrorOper,Hn=Xr.numErrorOper,Kn=Xr.naErrorOper,Xn=Xr.gettingDataErrorOper,Qn=Yr.OperatorId;function Yn(e,r,n){return{kind:e,start:r,chars:n}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected"}(Un||(Un={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(Pn||(Pn={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual"}(bn||(bn={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(Bn||(Bn={}));var Jn=function(e){return Yn(Un.End,e,"")},jn=function(e,r){return Yn(Un.Spaces,e,r)},qn=function(e,r){return Yn(Un.Unexpected,e,r)},zn=function(e,r){return Yn(Un.Ident,e,r)};function Zn(e,r,n,t){return{kind:e,start:r,chars:n,value:t}}var $n=function(e){return Zn(Un.Left,e,"(",Pn.Paren)},et=function(e,r){return Zn(Un.Left,e,r,Pn.Bracket)},rt=function(e,r){return Zn(Un.Left,e,r,Pn.Brace)},nt=function(e){return Zn(Un.Left,e,"'",Pn.SQuote)},tt=function(e){return Zn(Un.Right,e,")",Pn.Paren)},at=function(e,r){return Zn(Un.Right,e,r,Pn.Bracket)},ot=function(e,r){return Zn(Un.Right,e,r,Pn.Brace)},it=function(e){return Zn(Un.Right,e,"'",Pn.SQuote)},ut=function(e,r){return Zn(Un.Sep,e,r,bn.List)},ct=function(e,r){return Zn(Un.Sep,e,r,bn.Col)},lt=function(e,r){return Zn(Un.Sep,e,r,bn.Row)},st=function(e){return Zn(Un.Sep,e,"!",bn.Qual)},ft={"#ALL":function(e,r){return Zn(Un.SpecialRef,e,r,Bn.All)},"#DATA":function(e,r){return Zn(Un.SpecialRef,e,r,Bn.Data)},"#HEADERS":function(e,r){return Zn(Un.SpecialRef,e,r,Bn.Headers)},"#TOTALS":function(e,r){return Zn(Un.SpecialRef,e,r,Bn.Totals)},"#THIS ROW":function(e,r){return Zn(Un.SpecialRef,e,r,Bn.ThisRow)}};function dt(e,r,n,t,a,o,i,u){return{kind:Un.CellRef,start:e,chars:r,row:n,col:t,refStyle:a,isName:o,isNumber:i,isQualPart:u}}function Et(e,r,n,t){void 0===t&&(t=!0);var a="number"==typeof n&&function(e){for(var r=0;r<e.length;r+=1)if("+"===e[r]||"-"===e[r])return!1;return!0}(r);return{kind:Un.Literal,start:e,chars:r,oper:n,hasRight:t,isQualPart:a}}var pt=[function(e,r){throw new Error("errorToken[0]: no error type 0")},function(e,r){return Et(e,r,wn)},function(e,r){return Et(e,r,Gn)},function(e,r){return Et(e,r,Vn)},function(e,r){return Et(e,r,xn)},function(e,r){return Et(e,r,Wn)},function(e,r){return Et(e,r,Hn)},function(e,r){return Et(e,r,Kn)},function(e,r){return Et(e,r,Xn)}];function vt(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?Et(r,n,!1):0===e.stringCompareCI(e.trueName,n)?Et(r,n,!0):zn(r,n)}var Tt=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"."];function ht(e){var r=Tt[e];if(null==r)throw new Error("operatorTokenMaker: invalid operator "+e);return function(n){return{kind:Un.Operator,start:n,chars:r,value:e}}}var Rt=ht(Qn.Add),St=ht(Qn.Sub),It=ht(Qn.Mul),gt=ht(Qn.Div),At=ht(Qn.Pow),Nt=ht(Qn.Percent),Ct=ht(Qn.Concat),Ot=ht(Qn.Eq),mt=ht(Qn.Lt),Dt=ht(Qn.Gt),Lt=ht(Qn.Ne),Mt=ht(Qn.Le),_t=ht(Qn.Ge),yt=ht(Qn.Range);ht(Qn.And),ht(Qn.Or),ht(Qn.Xor),ht(Qn.Dot);function Ft(e,r,n){return n.push(r),r.start+e}var kt=Qr.PosKind,Ut=Qr.pos,Pt=Qr.RefStyle;function bt(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}function Bt(e){return e.toUpperCase().charCodeAt(0)-65+1}function wt(e,r,n,t){for(var a=0,o=t,i=Math.min(n.length,t+r);o<i;o+=1){var u=n[o];if(!e.isNumeral(u))break;a=10*a+e.getOrdinal(u)}return o===i&&e.isNumeral(n[o])?[0,t]:[a,o]}function Gt(e,r,n){return function(t,a,o,i){var u=function(e,r){return"$"===e[r]?[kt.Abs,r+1]:[kt.Rel,r]}(o,i),c=u[0],l=u[1],s=e(t,n,o,l),f=s[0],d=s[1];if(d>l){if(f<1||f>r)return;var E=c===kt.Rel?f-a:f;return[Ut(c,E-1),!1,d]}return[void 0,!1,i]}}function Vt(e,r,n){return function(t,a,o,i){var u=e?t.rowLetter:t.columnLetter;if(i>=o.length||0!==t.stringCompareCI(u,o[i]))return[void 0,!1,i];var c=i+1,l=wt(t,n,o,c),s=l[0],f=l[1];if(f>c){if(s<1||s>r)return;return[Ut(kt.Abs,s-1),!1,f]}if(o[c]===t.leftBracket){var d=1;"+"===o[c+=1]?c+=1:"-"===o[c]&&(d=-1,c+=1);var E=wt(t,n,o,c),p=E[0],v=E[1];if(v>c&&p<r&&o[v]===t.rightBracket)return[Ut(kt.Rel,p*d),!0,v+1]}return[!1,!1,f]}}function xt(e,r,n,t,a,o,i){var u=t(e,r,o,i);if(null==u)return[void 0,void 0,!1,i];var c=u[0],l=u[1],s=u[2];if(s>i){var f=a(e,n,o,s);if(null==f)return l?[c,void 0,!0,s]:[void 0,void 0,!1,i];var d=f[0],E=f[1],p=f[2];return p>s?[c,d,E,p]:[c,void 0,l,s]}var v=a(e,n,o,i);if(null==v)return[void 0,void 0,!1,i];var T=v[0],h=v[1],R=v[2];return R>i?[void 0,T,h,R]:[void 0,void 0,!1,i]}var Wt=Gt(wt,1048576,7),Ht=Gt(function(e,r,n,t){return function(e,r,n){for(var t=0,a=n,o=Math.min(r.length,n+e);a<o;a+=1){var i=r[a];if(!bt(i))break;t=26*t+Bt(i)}return a===o&&bt(r[a])?[0,n]:[t,a]}(r,n,t)},16384,3),Kt=Vt(!0,1048576,7),Xt=Vt(!1,16384,5);function Qt(e,r,n,t,a,o){var i=function(e,r,n,t,a){if(r===Pt.A1&&null!=n){var o=n.range,i=xt(e,o.col,o.row,Ht,Wt,t,a),u=i[0],c=i[1],l=i[2],s=i[3];if((null!=c&&null!=u||null!=c&&c.kind===kt.Abs||null!=u&&u.kind===kt.Abs||(null!=c||null!=u)&&(":"===t[a-1]||":"===t[s]))&&(l||s>=t.length||!Mn(e,t[s])))return[Pt.A1,c,u,s]}var f=xt(e,void 0,void 0,Kt,Xt,t,a),d=f[0],E=f[1],p=f[2],v=f[3];if((null!=d||null!=E)&&(p||v>=t.length||!Mn(e,t[v])))return[Pt.R1C1,d,E,v]}(e,r,n,t,a);if(null!=i){var u=i[0],c=i[1],l=i[2],s=i[3],f=t.substring(s,a);return Ft(s-a,u===Pt.A1?function(e,r,n,t){var a=null==n&&null!=t&&t.kind===Qr.PosKind.Rel,o=null==t&&null!=n&&n.kind===Qr.PosKind.Rel,i=!(null!=n&&n.kind!==Qr.PosKind.Rel||null!=t&&t.kind!==Qr.PosKind.Rel);return dt(e,r,n,t,Qr.RefStyle.A1,a,o,i)}(a,f,c,l):function(e,r,n,t){var a=!(!1!==n&&null!=n&&n.kind!==Qr.PosKind.Abs||!1!==t&&null!=t&&t.kind!==Qr.PosKind.Abs);return dt(e,r,!1===n?Qr.pos(Qr.PosKind.Rel,0):n,!1===t?Qr.pos(Qr.PosKind.Rel,0):t,Qr.RefStyle.R1C1,!1,!1,a)}(a,f,c,l),o)}}var Yt=Xr.numErrorOper,Jt=Xr.ErrorTypeBounds,jt="+-*/^%&=<>:";function qt(e){return jt.indexOf(e)>=0}var zt={"+":Rt,"-":St,"*":It,"/":gt,"^":At,"%":Nt,"&":Ct,"=":Ot,"<":mt,">":Dt,":":yt},Zt={"<>":Lt,"<=":Mt,">=":_t};function $t(e,r,n){if(r<e.length-1){var t=Zt[e.substr(r,2)];if(null!=t)return Ft(2,t(r),n)}var a=zt[e[r]];if(null!=a)return Ft(1,a(r),n);return R.ULS.assertTag(595980822,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function ea(e,r,n,t){function a(n){var t=n,a=r[t];if("e"!==a&&"E"!==a)return n;if((t+=1)>=r.length)return n;if("+"===(a=r[t])||"-"===a){if((t+=1)>=r.length)return n;a=r[t]}if(!e.isNumeral(a))return n;for(t+=1;t<r.length&&e.isNumeral(r[t]);t+=1);return t}function o(n,t){var o=n,i=r[o];if(i===e.decimalSeparator){if((o+=1)>=r.length)return t?n:o;i=r[o]}if(!e.isNumeral(i))return t?n:a(o);for(o+=1;o<r.length;o+=1)if(!e.isNumeral(r[o]))return a(o);return o}for(var i=n;i<r.length;i+=1)if(!e.isNumeral(r[i])){i=o(i,i===n);break}if(i>n){var u=r.substring(n,i),c=e.parseNumber(u);return Ft(i-n,Et(n,u,dr(c)?c:Yt,!0),t),i}}function ra(e,r,n){var t=kn(e,r+1,function(e){return'"'!==e},'"',function(e){return'"'===e}),a=t[0],o=t[1],i=e.substring(r,o+1);return o<e.length?Ft(o+1-r,Et(r,i,a,!0),n):Ft(o-r,Et(r,i,a,!1),n)}function na(e,r,n,t){for(var a=Jt.First;a<=Jt.Last;a+=1){var o=e.errorNames[a],i=r.substr(n,o.length),u=pt[a];if(0===e.stringCompareCI(o,i)&&null!=u)return Ft(o.length,u(n,i),t)}}var ta=Object.getOwnPropertyNames(ft);function aa(e,r,n,t){for(var a=0;a<ta.length;a+=1){var o=ta[a],i=r.substr(n,o.length);if(i.toUpperCase()===o)return Ft(o.length,ft[o](n,i),t)}}function oa(e,r){return"'"!==r&&"#"!==r&&r!==e.leftBracket&&r!==e.rightBracket}function ia(e,r,n,t){var a=Ft(1,et(n,r[n]),t);"#"===r[a]&&(null!=(l=aa(0,r,a,t))&&(a=l));for(var o=function(r){return oa(e,r)},i=function(r){return!oa(e,r)},u=_n("calc.parse.tokenizeBracketedColRef",a);a<r.length;){u(a);var c=r[a];if(c===e.rightBracket)return Ft(1,at(a,c),t);if(Fn(r,a,o,"'",i)>0){var l,s=kn(r,a,o,"'",i),f=s[0];a=Ft((l=s[1])-a,zn(a,f),t)}else a=Ft(1,qn(a,c),t)}return a}function ua(e,r){return!Dn(r)&&"'"!==r&&"#"!==r&&":"!==r&&r!==e.listSeparator&&r!==e.leftBracket&&r!==e.rightBracket}function ca(e,r,n,t){var a=Ft(1,et(n,r[n]),t);"#"===r[a]&&(null!=(f=aa(0,r,a,t))&&(a=f));for(var o=function(r){return ua(e,r)},i=function(r){return!ua(e,r)},u=_n("calc.parse.tokenizeBracketedRef",a);a<r.length;){u(a);var c=r[a];if(c===e.rightBracket)return Ft(1,at(a,c),t);if(Fn(r,a,o,"'",i)>0){var l=kn(r,a,o,"'",i),s=l[0];a=Ft((f=l[1])-a,zn(a,s),t)}else if(Dn(c)){var f,d=yn(r,a,Dn);s=d[0];a=Ft((f=d[1])-a,jn(a,s),t)}else a=":"!==c?c!==e.listSeparator?c!==e.leftBracket?Ft(1,qn(a,c),t):ia(e,r,a,t):Ft(1,ut(a,c),t):Ft(1,yt(a),t)}return a}var la,sa="':*?";function fa(e,r,n,t){for(var a=Ft(1,nt(n),t),o=function(r){return function(e,r){return sa.indexOf(r)<0&&r!==e.leftBracket&&r!==e.rightBracket}(e,r)},i=function(e){return"'"===e},u=_n("calc.parse.tokenizeQuotedQualifier",a);a<r.length;){u(a);var c=r[a];if("'"===c&&"'"!==r[a+1])return Ft(1,it(a),t);if(":"!==c)if(c!==e.leftBracket)if(Fn(r,a,o,"'",i)>0){var l=kn(r,a,o,"'",i),s=l[0];a=Ft(l[1]-a,zn(a,s),t)}else a=Ft(1,qn(a,c),t);else a=ca(e,r,a,t);else a=Ft(1,yt(a),t)}return a}function da(e,r,n,t){for(var a=e[r],o=r+1;o<e.length;o+=1){var i=e[o];if(i.kind!==n)break;a=t(a,i)}return[a,o]}function Ea(e,r){return qn(e.start,e.chars+r.chars)}function pa(e,r,n,t,a){for(var o=function(e,r,n,t,a){for(var o=[],i=[],u=la.Decimal,l=a,s=_n("calc.parse.tokenize",l);l<t.length;){s(l);var f=Qt(e,r,n,t,l,o);if(null==f){var d=t[l];if(u===la.Decimal&&d===e.decimalSeparator||e.isNumeral(d)){var E=ea(e,t,l,o);if(null!=E){l=E,u=la.FieldAccess;continue}if(d!==e.decimalSeparator){var p="calc.parse.tokenize: failed to tokenize numeral at "+l;return R.ULS.assertTag(595980823,c.LogCategory.msoulscat_ES_EWAJS,!1,p)}}if('"'!==d)if(Ln(e,d)){var v=yn(t,l,function(r){return Mn(e,r)}),T=v[0];l=Ft(v[1]-l,vt(e,l,T),o),u=la.FieldAccess}else if("#"!==d)if(qt(d))l=$t(t,l,o),u=la.Decimal;else if(Dn(d)){var h=yn(t,l,Dn);T=h[0],l=Ft(h[1]-l,jn(l,T),o),u=la.Decimal}else if("("!==d)if(")"!==d)if(d!==e.leftBrace)if(d!==e.rightBrace)if(d!==e.leftBracket)if(d!==e.rightBracket){if(i.length>0&&i[i.length-1]===Pn.Brace){if(d===e.columnSeparator){l=Ft(1,ct(l,d),o),u=la.Decimal;continue}if(d===e.rowSeparator){l=Ft(1,lt(l,d),o),u=la.Decimal;continue}}d!==e.listSeparator?"!"!==d?"'"!==d?(l=Ft(1,qn(l,d),o),u=la.Decimal):(l=fa(e,t,l,o),u=la.Decimal):(l=Ft(1,st(l),o),u=la.Decimal):(l=Ft(1,ut(l,d),o),u=la.Decimal)}else l=Ft(1,at(l,d),o),u=la.FieldAccess;else l=ca(e,t,l,o),u=la.FieldAccess;else i.length>0&&i[i.length-1]===Pn.Brace&&i.pop(),l=Ft(1,ot(l,d),o),u=la.FieldAccess;else i.push(Pn.Brace),l=Ft(1,rt(l,d),o),u=la.Decimal;else i.length>0&&i[i.length-1]===Pn.Paren&&i.pop(),l=Ft(1,tt(l),o),u=la.FieldAccess;else i.push(Pn.Paren),l=Ft(1,$n(l),o),u=la.Decimal;else{var S=na(e,t,l,o);if(null!=S){l=S,u=la.FieldAccess;continue}l=Ft(1,qn(l,d),o),u=la.Decimal}else l=ra(t,l,o),u=la.FieldAccess}else l=f,u=la.FieldAccess}return o}(e.config.localeInfo,r,n,t,a),i=[],u=0;u<o.length;){var l=o[u];if(l.kind!==Un.Unexpected)i.push(l),u+=1;else{var s=da(o,u,Un.Unexpected,Ea),f=s[0],d=s[1];i.push(f),u=d}}return i.push(Jn(t.length)),i}function va(e,r,n,t){var a=void 0;if(function(e){for(var r=e;null!=r;)r=r()}(e(r,n,t,function(e,r){a=[e,r]},function(){a=!1})),null==a){var o="calc.parse.runParser: internal error: parser did not call resolve or reject on "+E(r);return R.ULS.assertTag(595980827,c.LogCategory.msoulscat_ES_EWAJS,!1,o)}return a}function Ta(e){return function(r,n,t,a,o){return a(e,n)}}!function(e){e[e.Decimal=1]="Decimal",e[e.FieldAccess=2]="FieldAccess"}(la||(la={}));var ha,Ra=function(e,r,n,t,a){return a};function Sa(e,r){return function(n,t,a,o,i){return e(n,t,a,function(e,t){return r(a,e)(n,t,a,o,i)},i)}}function Ia(e,r){return function(n,t,a,o,i){return e(n,t,a,o,function(){return r(n,t,a,o,i)})}}function ga(e){return 0===e.length?Ra:e.reduce(Ia)}function Aa(e,r){return function(n,t,a,o,i){return e(n,t,a,o,function(){return o(r,t)})}}function Na(e,r){return function(n,t,a,o,i){var u=n[t];if(null==u)return i;var c=e(a,u);return null==c?i:o(c,t+r)}}function Ca(e){return Na(e,1)}function Oa(e){return Na(e,0)}function ma(e){return function(r,n,t,a,o){var i=r[n],u=r[n+1];if(null==i||null==u)return o;var c=e(t,i,u);return null==c?o:a(c,n+1)}}function Da(e,r,n){return function(t,a,o,i,u){var l=n,s=a;function f(){return e(t,s,o,d,p)}function d(e,n){if(n<=s){var a=E(t),i="calc.parse.reduce: internal error: no progress made at index "+s+" on "+a;return R.ULS.assertTag(595980829,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return l=r(o,e,l),s=n,f}function p(){return i(l,s)}return f}}function La(e,r){return Da(e,function(e,r,n){return n.push(r),n},r)}function Ma(e){return function(r,n,t,a,o){return La(e,[])(r,n,t,a,o)}}function _a(e,r){return Sa(e,function(e,n){return La(r,[n])})}function ya(e){var r=e.length;return function(n,t,a,o,i){var u=t,c=[];function l(){return e[c.length](n,u,a,s,i)}function s(e,n){return u=n,c.push(e),c.length<r?l:o(c,u)}return l}}function Fa(e,r){return ya([e,r])}function ka(e,r,n,t,a){return ya([e,r,n,t,a])}function Ua(e,r){return function(n,t,a,o,i){return e(n,t,a,function(e,n){return o(r(a,e),n)},i)}}function Pa(e,r,n){return Ua(ya([e,r]),function(e,r){return n(e,r[0],r[1])})}function ba(e,r,n,t){return Ua(ya([e,r,n]),function(e,r){return t(e,r[0],r[1],r[2])})}function Ba(e,r,n,t,a){return Ua(ya([e,r,n,t]),function(e,r){return a(e,r[0],r[1],r[2],r[3])})}function wa(e,r){return Pa(e,r,function(e,r,n){return r})}function Ga(e,r){return Pa(e,r,function(e,r,n){return n})}function Va(e,r){var n=e.spans[r.label];if(null==n){var t="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+E(r);return R.ULS.assertTag(595980824,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}return n}function xa(e,r,n,t,a){var o=e.label;return e.label+=1,e.spans[o]=Qr.formulaSpan(r,n,t,a),o}function Wa(e,r,n,t){var a=Va(e,n);return a.pre=r,a.post=t,n}function Ha(e,r,n){return function(t,a,o,i,u){var c=o.leftDelim,l=o.listSep;return o.leftDelim=e,o.listSep=r,n(t,a,o,function(e,r){return o.leftDelim=c,o.listSep=l,i(e,r)},function(){return o.leftDelim=c,o.listSep=l,u})}}function Ka(e,r){return r.kind===Un.Spaces||r.kind===Un.End?r.start:Va(e,r).start}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(ha||(ha={}));var Xa=Aa(Ca(function(e,r){return r.kind===Un.Spaces?r.chars:void 0}),"");function Qa(e){return ba(Xa,Ca(e),Xa,Wa)}var Ya=Qa(function(e,r){return r.kind!==Qr.NodeKind.Operator||r.id!==Yr.OperatorId.Add&&r.id!==Yr.OperatorId.Sub?void 0:r}),Ja=function(e){return Pa(Ca(e),Xa,function(e,r,n){return Wa(e,"",r,n)})}(function(e,r){if(r.kind===Qr.NodeKind.Operator){if(r.id===Yr.OperatorId.Add)return Qr.operatorNode(Yr.OperatorId.Pos,r.label);if(r.id===Yr.OperatorId.Sub)return Qr.operatorNode(Yr.OperatorId.Neg,r.label)}}),ja=Qa(function(e,r){return r.kind!==Qr.NodeKind.Operator||r.id!==Yr.OperatorId.Mul&&r.id!==Yr.OperatorId.Div?void 0:r}),qa=Qa(function(e,r){return r.kind===Qr.NodeKind.Operator&&r.id===Yr.OperatorId.Pow?r:void 0}),za=function(e){return Pa(Xa,Ca(e),function(e,r,n){return Wa(e,r,n,"")})}(function(e,r){return r.kind===Qr.NodeKind.Operator&&r.id===Yr.OperatorId.Percent?r:void 0}),Za=Qa(function(e,r){return r.kind===Qr.NodeKind.Operator&&r.id===Yr.OperatorId.Concat?r:void 0}),$a=Qa(function(e,r){return r.kind===Qr.NodeKind.Operator&&r.id>=Yr.OperatorId.Eq&&r.id<=Yr.OperatorId.Ge?r:void 0}),eo=Qa(function(e,r){return r.kind===Qr.NodeKind.Operator&&r.id===Yr.OperatorId.Range?r:void 0}),ro=Qa(function(e,r){return r.kind===Qr.NodeKind.Operator&&r.id===Yr.OperatorId.Union?r:void 0}),no=ma(function(e,r,n){if(r.kind===Un.Spaces&&n.kind!==Un.End&&n.kind!==Qr.NodeKind.Operator){var t=xa(e,r.start,Ka(e,n),r.chars,"");return Qr.operatorNode(Yr.OperatorId.Isect,t)}});function to(e,r,n){return Pa(e,Ma(Fa(r,e)),function(e,r,t){return 0===t.length?r:t.reduce(n(e),r)})}function ao(e){return function(r,n){var t=n[0],a=n[1],o=Va(e,r).start,i=Va(e,a).end,u=xa(e,o,i,"","");return Qr.appNode(t,[r,a],!0,u)}}function oo(e,r){var n=xa(e,Va(e,r[0]).start,Va(e,r[r.length-1]).end,"","");return Qr.badNode(Qr.BadType.Sequence,r,n)}var io=to(to(to(to(to(to(function(e,r,n){return Pa(Ma(r),e,function(e,r,t){return 0===r.length?t:r.reduceRight(n(e),t)})}(to(to(to(Pa(function(e,r,n,t,a){var o=e[r];if(null==o){var i="calc.parse.pStart: internal error: expected term at "+r+" in "+E(e);return R.ULS.assertTag(595980864,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return t(Ka(n,o),r)},Ma(Ca(function(e,r){return r.kind!==Qr.NodeKind.Operator&&r.kind!==Un.Spaces&&r.kind!==Un.End?r:void 0})),function(e,r,n){return 0===n.length?Qr.literalNode(Xr.missingOper,!0,xa(e,r,r,"","")):1===n.length?n[0]:oo(e,n)}),eo,ao),no,ao),ro,ao),Ja,function(e){var r=!0;return function(n,t){var a=Va(e,t).start,o=Va(e,n).end,i=xa(e,a,o,"","");if(r&&(r=!1,n.kind===Qr.NodeKind.Literal&&"number"==typeof n.oper)){var u=t.id===Yr.OperatorId.Pos?n.oper:-n.oper;return Qr.literalNode(u,!0,i)}return Qr.appNode(t,[n],!0,i)}}),za,function(e){return function(r,n){var t=n[0],a=n[1],o=Va(e,r).start,i=Va(e,t).end,u=xa(e,o,i,"",""),c=Qr.appNode(t,[r],!0,u);return a.kind===Qr.NodeKind.Literal&&Jr.operKind(a.oper)===Xr.OperKind.Missing?c:oo(e,[c,a])}}),qa,ao),ja,ao),Ya,ao),Za,ao),$a,ao);var uo=Aa(Ca(function(e,r){return r.kind===Un.Spaces?r.chars:void 0}),""),co=function(e,r,n,t,a){var o=e[r];if(null==o){var i="calc.parse.pStart: internal error: expected token at "+r+" in "+E(e);return R.ULS.assertTag(595980830,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return t(o.start,r)};function lo(e){return Ca(function(r,n){return n.kind===Un.Sep&&n.value===e||void 0})}function so(e){return Ca(function(r,n){return n.kind===Un.Left&&n.value===e?n.start:void 0})}function fo(e){return Ca(function(r,n){return n.kind===Un.Right&&n.value===e||void 0})}var Eo=lo(bn.List),po=lo(bn.Row),vo=lo(bn.Col),To=lo(bn.Qual),ho=so(Pn.Paren),Ro=fo(Pn.Paren),So=so(Pn.Brace),Io=fo(Pn.Brace),go=so(Pn.SQuote),Ao=fo(Pn.SQuote),No=Ca(function(e,r){return r.kind===Un.Operator&&r.value===Yr.OperatorId.Range||void 0}),Co=function(){var e={impl:function(e,r,n,t,a){return R.ULS.assertTag(595980828,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(r,n,t,a,o){return function(){return e.impl(r,n,t,a,o)}}};return e}(),Oo=ba(uo,Co.parser,uo,Wa),mo=Ba(ho,Ha(Pn.Paren,ha.Union,Oo),Aa(Ro,!1),co,function(e,r,n,t,a){var o=xa(e,r,a,"","");return Qr.parenNode(n,t,o)}),Do=_a(Oo,Ga(vo,Oo)),Lo=_a(Do,Ga(po,Do)),Mo=Ba(So,Ha(Pn.Brace,ha.Union,Lo),Aa(Io,!1),co,function(e,r,n,t,a){var o=xa(e,r,a,"","");return Qr.arrayNode(n,t,o)}),_o=Ca(function(e,r){if(r.kind===Un.Ident||r.kind===Un.CellRef&&r.isQualPart||r.kind===Un.Literal&&r.isQualPart||r.kind===Un.Operator&&r.value===Yr.OperatorId.Dot)return r.chars}),yo=_a(_o,_o),Fo=Ca(function(e,r){return r.kind===Un.Ident?r.chars:void 0});function ko(e){return e.kind===Un.Literal&&"object"==typeof e.oper&&e.oper.kind===Xr.OperKind.Error&&e.oper.type===Xr.ErrorType.REF}function Uo(e,r,n){return null==r?[Qr.identQualifier(e,n),e]:[Qr.sheetRangeQualifier(e,r,n),e+":"+r]}var Po=Pa(yo,Aa(Ga(No,yo),void 0),function(e,r,n){return Uo(r.join(""),null!=n?n.join(""):void 0,!1)}),bo=Pa(Fo,Aa(Ga(No,Fo),void 0),function(e,r,n){return Uo(r,n,!0)}),Bo=Ua(Ma(Ca(function(e,r){return function(e){return e.kind===Un.End||e.kind===Un.Right&&e.value===Pn.SQuote}(r)?void 0:r})),function(e,r){return[void 0,r.map(function(e){return e.chars}).join("")]}),wo=Ia(Pa(Ao,Aa(wa(To,uo),!1),function(e,r,n){return n?"'!":"'"}),Oa(function(e,r){return r.kind===Un.End?"":void 0})),Go=Ca(function(e,r){return ko(r)?[Qr.errorQualifier,r.chars]:void 0}),Vo=Pa(Aa(ga([Po]),[Qr.relativeQualifier,""]),wa(To,uo),function(e,r,n){return[r[0],r[1]+"!"]}),xo=ga([Go,Pa(go,ga([Fa(bo,wo),Fa(Bo,wo)]),function(e,r,n){var t=n[0],a=t[0],o=t[1],i=n[1];return["!"===i[i.length-1]?a:void 0,"'"+o+i]}),Vo]);function Wo(e,r){return r.kind===Un.CellRef&&e.refStyle===r.refStyle}var Ho=Ca(function(e,r){return Wo(e,r)?r:void 0});function Ko(e){if(null!=e.row&&null!=e.col)return Qr.cellRefSingle(e.row,e.col);if(null!=e.row)return Qr.cellRefRow(e.row,e.row);if(null!=e.col)return Qr.cellRefCol(e.col,e.col);var r="calc.parse.cellRefToken2cellRef: bad token "+E(e);return R.ULS.assertTag(595980831,c.LogCategory.msoulscat_ES_EWAJS,!1,r)}var Xo=Ca(function(e,r){return Wo(e,r)&&(r.refStyle!==Qr.RefStyle.A1||null!=r.row&&null!=r.col)?Ko(r):ko(r)?Qr.cellRefError:void 0}),Qo=Ia(Sa(ka(Ho,uo,No,uo,Ho),function(e,r){var n=r[0],t=r[1],a=(r[2],r[3]),o=r[4],i=Ko(n),u=Ko(o),c=void 0;return i.kind===Qr.CellRefKind.Single&&u.kind===Qr.CellRefKind.Single?c=Qr.cellRefRange(i,u):0===t.length&&0===a.length&&(i.kind===Qr.CellRefKind.Row&&u.kind===Qr.CellRefKind.Row?c=Qr.cellRefRow(i.row1,u.row1):i.kind===Qr.CellRefKind.Col&&u.kind===Qr.CellRefKind.Col&&(c=Qr.cellRefCol(i.col1,u.col1))),null==c?Ra:n.isQualPart&&o.isQualPart?Oa(function(e,r){return r.kind===Un.Sep&&r.value===bn.Qual?void 0:c}):Ta(c)}),Xo),Yo=Ca(function(e,r){return r.kind===Un.Ident||r.kind===Un.CellRef&&r.isName?r.chars:void 0}),Jo=Sa(ka(co,xo,co,Aa(Ia(Qo,Yo),void 0),co),function(e,r){var n=r[0],t=r[1],a=t[0],o=t[1],i=r[2],u=r[3],c=r[4];if(null==u){if(null!=a&&!a.isQuoted&&a.kind===Qr.QualifierKind.SheetRange)return Ra;var l=xa(e,n,c,"","");return Ta(null!=a&&a.kind===Qr.QualifierKind.Error?Qr.literalNode(Xr.refErrorOper,!0,l):Qr.badNode(Qr.BadType.Qualifier,o,l))}if("string"==typeof u){if(null!=a&&!a.isQuoted&&a.kind===Qr.QualifierKind.SheetRange)return Ra;var s=xa(e,n,c,"","");if(null==a||a.kind===Qr.QualifierKind.Error||a.kind===Qr.QualifierKind.SheetRange){var f=Qr.badNode(Qr.BadType.Qualifier,o,xa(e,n,i,"","")),d=Qr.nameNode(u,void 0,xa(e,i,c,"",""));return Ta(Qr.badNode(Qr.BadType.Sequence,[f,d],s))}return Ta(Qr.nameNode(u,a,s))}var E=xa(e,n,c,"","");if(null==a||a.kind===Qr.QualifierKind.Document){f=Qr.badNode(Qr.BadType.Qualifier,o,xa(e,n,i,"","")),d=Qr.cellRefNode(u,void 0,xa(e,i,c,"",""));return Ta(Qr.badNode(Qr.BadType.Sequence,[f,d],E))}var p=a.kind===Qr.QualifierKind.Ident?Qr.sheetQualifier(a.name,void 0,a.isQuoted):a;return Ta(Qr.cellRefNode(u,p,E))}),jo=ba(co,Ia(Qo,Yo),co,function(e,r,n,t){var a=xa(e,r,t,"","");return"string"==typeof n?Qr.nameNode(n,void 0,a):n.kind===Qr.CellRefKind.Error?Qr.literalNode(Xr.refErrorOper,!0,a):Qr.cellRefNode(n,void 0,a)}),qo=ma(function(e,r,n){if(r.kind===Un.Literal)return Qr.literalNode(r.oper,r.hasRight,xa(e,r.start,n.start,"",""));if(r.kind===Un.CellRef&&r.isNumber&&"object"==typeof r.row&&null!=e.range){var t=r.row.index+e.range.range.row+1;return Qr.literalNode(t,!0,xa(e,r.start,n.start,"",""))}});function zo(e){return ma(function(r,n,t){if(e(n)){var a=xa(r,n.start,t.start,"","");return Qr.badNode(Qr.BadType.Unexpected,n.chars,a)}})}var Zo=zo(function(e){return e.kind===Un.Left&&e.value===Pn.Bracket}),$o=zo(function(e){return e.kind===Un.Right&&e.value===Pn.Bracket}),ei=function(e,r,n,t,a,o){return Ua(ya([e,r,n,t,a]),function(e,r){return o(e,r[0],r[1],r[2],r[3],r[4])})}(co,Zo,Ha(Pn.Bracket,ha.Union,Oo),Aa($o,void 0),co,function(e,r,n,t,a,o){var i=[n,t];null!=a&&i.push(a);var u=xa(e,r,o,"","");return Qr.badNode(Qr.BadType.Sequence,i,u)}),ri=ma(function(e,r,n){switch(r.kind){case Un.End:case Un.Operator:case Un.Spaces:return;case Un.Sep:if(r.value!==bn.Qual&&(e.leftDelim===Pn.Brace||r.value!==bn.Col&&r.value!==bn.Row))return;break;case Un.Right:if(r.value===e.leftDelim)return}var t=r.kind===Un.CellRef?Qr.BadType.CellRef:Qr.BadType.Unexpected,a=xa(e,r.start,n.start,"","");return Qr.badNode(t,r.chars,a)}),ni=ma(function(e,r,n){if((r.kind===Un.Ident||r.kind===Un.CellRef)&&n.kind===Un.Left&&n.value===Pn.Paren&&null!=e.localeInfo.getWorksheetFuncId(r.chars)){var t=xa(e,r.start,n.start,"","");return Qr.nameNode(r.chars,void 0,t)}}),ti=Ba(ho,Ha(Pn.Paren,ha.Arg,_a(Oo,Ga(Eo,Oo))),Aa(Ro,!1),co,function(e,r,n,t,a){return[n,t,a]}),ai=Pa(ga([Pa(ni,ti,function(e,r,n){var t=n[0],a=n[1],o=n[2],i=xa(e,Va(e,r).start,o,"","");return Qr.appNode(r,t,a,i)}),Jo,jo,qo,mo,Mo,ei,ri]),Ma(ti),function(e,r,n){var t=Va(e,r).start;return n.reduce(function(r,n){var a=n[0],o=n[1],i=n[2],u=xa(e,t,i,"","");return Qr.appNode(r,a,o,u)},r)}),oi=ma(function(e,r,n){var t=void 0;if(r.kind===Un.Operator&&(t=r.value),r.kind===Un.Sep&&r.value===bn.List&&e.listSep===ha.Union&&(t=Yr.OperatorId.Union),null!=t){var a=xa(e,r.start,n.start,"","");return Qr.operatorNode(t,a)}}),ii=Ca(function(e,r){return r.kind===Un.Spaces?r:void 0}),ui=Ia(ai,oi),ci=Pa(Aa(Sa(ui,function(e,r){return Da(Fa(Aa(ii,void 0),ui),function(e,r,n){var t=r[0],a=r[1];return null!=t&&n.push(t),n.push(a),n},[r])}),void 0),co,function(e,r,n){if(null==r){var t=xa(e,n,n,"","");return Qr.literalNode(Xr.missingOper,!0,t)}if(1===r.length){var a=r[0];if(a.kind!==Qr.NodeKind.Operator&&a.kind!==Un.Spaces)return a}return r.push(Jn(n)),function(e,r){var n=e.length-1;if(n<0){var t="calc.parse.parseTerms: internal error: expected at least 1 term";return R.ULS.assertTag(595980865,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}if(e[0].kind===Un.Spaces)return t="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+E(e),R.ULS.assertTag(595980866,c.LogCategory.msoulscat_ES_EWAJS,!1,t);if(n-1>=0&&e[n-1].kind===Un.Spaces)return t="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+E(e),R.ULS.assertTag(595980867,c.LogCategory.msoulscat_ES_EWAJS,!1,t);if(e[n].kind!==Un.End)return t="calc.parse.parseTerms: internal error: array[n].kind !== End in "+E(e),R.ULS.assertTag(595980868,c.LogCategory.msoulscat_ES_EWAJS,!1,t);var a=va(io,e,0,r);if(!1===a)return t="calc.parse.parseTerms: internal error: failed to parse "+E(e),R.ULS.assertTag(595980869,c.LogCategory.msoulscat_ES_EWAJS,!1,t);var o=a[0],i=a[1];if(i<n)return t="calc.parse.parseTerms: internal error: consumed "+i+" out of "+n+" in "+E(e),R.ULS.assertTag(595980870,c.LogCategory.msoulscat_ES_EWAJS,!1,t);return o}(r,e)});function li(e,r,n,t,a){var o=a.length-1;if(o<0){var i="calc.parse.parseTokens: internal error: expected at least 1 token";return R.ULS.assertTag(595980832,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}if(a[o].kind!==Un.End){i="calc.parse.parseTokens: internal error: array[n] !== End in "+E(a);return R.ULS.assertTag(595980833,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}var u=function(e,r,n,t){return{localeInfo:e,refStyle:r,range:n,source:t,leftDelim:void 0,listSep:ha.Union,label:1,spans:{}}}(e.config.localeInfo,r,n,t),l=va(Oo,a,0,u);if(!1===l){i="calc.parse.parseTokens: internal error: failed to parse "+E(a);return R.ULS.assertTag(595980834,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}var s=l[0],f=l[1];if(f<o){i="calc.parse.parseTokens: internal error: consumed "+f+" out of "+o+" in "+E(a);return R.ULS.assertTag(595980835,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return Qr.formula(s,u.spans)}Co.impl=ci;var si={"=":1,"+":0,"-":0,"@":-1};function fi(e){return{parseFormula:function(r,n,t,a){return function(e,r,n,t,a){var o=a[0],i=null!=o?si[o]:void 0;if(null==i)return Jr.failure(On("first character is not '=', '+', '-' or '@'"));if(i<0)return Jr.failure(Nn(["Lotus 1-2-3 syntax"]));if(r===Qr.RefStyle.A1&&null==n)return R.ULS.assertTag(595980825,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: in A1 style, expected range to be defined");var u=li(e,r,n,t,pa(e,r,n,a,i));return Jr.success(u)}(e,r,n,t,a)},formatFormula:function(e,r,n,t){return function(e,r,n,t,a){if(r===Qr.RefStyle.A1&&null==n)return R.ULS.assertTag(595980826,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.formatFormula: in A1 style, expected range to be defined");return Jr.failure(Nn(["formatFormula"]))}(0,e,r)}}}var di=Qr.QualifierKind,Ei=Qr.CellRefKind,pi=Qr.NodeKind,vi=Jr.ResultKind;function Ti(e){return e.kind===vi.Success}function hi(e,r,n){return!!Ti(e)&&(function(e,r,n){if(null==e||null==n)return;var t={};null!=r?r.forEach(function(e){t[e]=!0}):t["*"]=!0;var a=[];a.push(e.node);for(;a.length>0;){var o=a.pop();if(null!=o)switch(o.kind){case pi.Literal:c("literal")&&n("literal",{label:o.label,value:o});break;case pi.Array:o.nodes.map(function(e){return e.map(function(e){a.push(e)})});break;case pi.App:if("object"!=typeof o.head)c("literal")&&n("literal",{label:o.label,value:o.head});else{var i=o.head;switch(i.kind){case pi.Operator:c("operator")&&n("operator",{label:o.label,value:i.id});break;case pi.Name:c("function")&&n("function",{label:o.label,name:i.whole});break;default:a.push(i)}}o.args.map(function(e){a.push(e)});break;case pi.Paren:a.push(o.node);break;case pi.Name:if(c("namedRange")){var u=o.whole.split(".");n("namedRange",{label:o.label,name:u[0],names:u.slice(1),qualifier:l(o)})}break;case pi.CellRef:c("range")&&s(o);break;case pi.Bad:break;default:return I("calc.parse.traverseFormula",o)}}function c(e){return t[e]||t["*"]}function l(e){if(null!=e.qualifier){var r={};switch(e.qualifier.kind){case di.Sheet:var n=e.qualifier;r.type=di.Sheet,r.sheet=n.sheet,null!=n.document&&(r.document=n.document.document,null!=n.document.path&&(r.documentPath=n.document.path));break;case di.SheetRange:var t=e.qualifier;r.type=di.SheetRange,r.sheet1=t.sheet1,r.sheet2=t.sheet2;break;case di.Ident:var a=e.qualifier;r.type=di.Ident,r.name=a.name;break;case di.Document:var o=e.qualifier;r.document=o.document,null!=o.path&&(r.documentPath=o.path)}return r}}function s(e){if(null!=n)switch(e.ref.kind){case Ei.Error:break;case Ei.Col:var r=e.ref;n("range",{label:e.label,type:"col",startIndex:r.col1,endIndex:r.col2,qualifier:l(e)});break;case Ei.Row:var t=e.ref;n("range",{label:e.label,type:"row",startIndex:t.row1,endIndex:t.row2,qualifier:l(e)});break;case Ei.Single:var a=e.ref;n("range",{label:e.label,type:"cell",row:a.row,col:a.col,qualifier:l(e)});break;case Ei.Range:var o=e.ref;n("range",{label:e.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,qualifier:l(e)})}}}(e.value,r,n),!0)}var Ri,Si={isSuccess:Ti,traverse:hi,extractReferences:function(e){if(Ti(e)){var r=[];return hi(e,["range","namedRange"],function(n,t){var a=e.value.spans[t.label];if(null==a)g("ParseResultHelper.extractReferences: span shouldn't be null");else{var o={kind:n,ref:t,span:a};r.push(o)}}),r.sort(function(e,r){return e.span.start-r.span.start}),r}}};!function(e){e[e.SyntaxError=0]="SyntaxError",e[e.TypeError=1]="TypeError"}(Ri||(Ri={}));var Ii={Unclosed_expression:{code:1,category:Ri.SyntaxError},Illegal_array_literal_element:{code:2,category:Ri.SyntaxError},Empty_array_literal:{code:3,category:Ri.SyntaxError},Irregular_array_shape:{code:4,category:Ri.SyntaxError},Empty_parenthesis:{code:5,category:Ri.SyntaxError},Missing_operation_argument:{code:6,category:Ri.SyntaxError},Bad_node:{code:7,category:Ri.SyntaxError},Invalid_binder:{code:8,category:Ri.SyntaxError},Empty_formula:{code:9,category:Ri.SyntaxError},Invalid_rel_sheet_qualifier_in_cell:{code:10,category:Ri.SyntaxError},Types_not_related:{code:1001,category:Ri.TypeError},Unexpected_application_head:{code:1002,category:Ri.TypeError},Unexpected_application_head_with_fix:{code:1003,category:Ri.TypeError},Incorrect_number_of_operator_arguments:{code:1004,category:Ri.TypeError},Excess_function_arguments:{code:1005,category:Ri.TypeError},Insufficient_function_arguments:{code:1006,category:Ri.TypeError}},gi=Qr.NodeKind,Ai=Qr.QualifierKind,Ni=Qr.BadType,Ci=Qr.CellRefKind,Oi=Kr.FormulaSource,mi=Xr.OperKind,Di=Xr.ErrorType,Li=Yr.SignatureType,Mi=Yr.SpecialPrecs,_i=Yr.getOperatorType,yi=Yr.WorksheetFuncId,Fi=Yr.getWorksheetFuncType,ki=Jr.operKind,Ui=Jr.getArguments,Pi=Jr.getArgType,bi=Jr.defaultLiteralVisitor,Bi=Jr.defaultFormulaVisitor,wi=Jr.dispatch,Gi=Jr.startVisit,Vi={};function xi(e,r){return{context:e,result:r}}function Wi(e){return function(r){return r.kind===gi.Literal&&e(r.oper)}}var Hi=Wi(function(e){return ki(e)===mi.Missing}),Ki=Wi(function(e){return ki(e)===mi.Error&&e.type===Di.REF}),Xi=Wi(function(e){return 0!=(ki(e)&(mi.String|mi.Error|mi.Boolean))});function Qi(e){return e.kind===gi.Name&&void 0===e.qualifier}function Yi(e,r,n,t){void 0===t&&(t=!1),t||(e.errorData=e.reportError(r,n,e.errorData))}function Ji(e,r){return r!==mi.Range||0!=(e&mi.Range)}function ji(e,r){if(r.kind===gi.Literal)switch(Yi(e,r,Ii.Unclosed_expression,r.isClosed),ki(r.oper)){case mi.Number:case mi.Boolean:case mi.String:case mi.Error:return;default:return void Yi(e,r,Ii.Illegal_array_literal_element)}Yi(e,r,Ii.Illegal_array_literal_element)}function qi(e,r,n){Yi(e,r,Ii.Types_not_related,Ji(mi.Array,n)),Yi(e,r,Ii.Unclosed_expression,r.isClosed);var t=r.nodes.length>0;if(Yi(e,r,Ii.Empty_array_literal,t),!t)return xi(e,n);for(var a=r.nodes[0].length,o=0;o<r.nodes.length;o+=1){var i=r.nodes[o],u=i.length;Yi(e,r,Ii.Irregular_array_shape,u===a);for(var c=0;c<u;c+=1)ji(e,i[c])}return xi(e,n)}function zi(e,r,n){if(e.earlyExit&&!e.isOk())throw Vi;switch(r.kind){case gi.Array:return qi(e,r,n);case gi.Paren:return Yi(e,r,Ii.Unclosed_expression,r.isClosed),Yi(e,r,Ii.Empty_parenthesis,!Hi(r.node)),zi(e,r.node,n);case gi.Bad:case gi.Name:case gi.CellRef:case gi.App:case gi.Literal:var t=eu(e,r);return Yi(e,r,Ii.Types_not_related,Ji(t.result,n)),t.result=n,t;default:return I("calc.analyze.checker.check: unhandled formula case",r)}}function Zi(e,r,n){var t,a=Fi(r),o=n.args,i=o.length,u=Ui(n),c=u.length,l=e.isOk();c<a.minArgs&&Yi(e,void 0===(t=o[i-1])?n:t,Ii.Insufficient_function_arguments);0===a.restTypes.length&&c>a.headTypes.length&&Yi(e,void 0===(t=o[i-1])?n:t,Ii.Excess_function_arguments);a.restTypes.length>1&&r!==yi.SWITCH&&((c-a.headTypes.length)%a.restTypes.length!=0&&Yi(e,void 0===(t=o[i-1])?n:t,Ii.Insufficient_function_arguments));for(var s=0;s<c;s+=1)zi(e,u[s],Pi(a,s));var f=!l||e.isOk();return f&&(e.specialDependencies|=a.staticPrecs,function(e,r,n){switch(r){case yi.LET:var t=n[0];return void 0!==t?Yi(e,t,Ii.Invalid_binder,Qi(t)):I("calc.anaylze.checker.applySpecificWorksheetFunctionChecks: undefined binder",t);case yi.FUN:for(var a=0;a<n.length-1;a+=1){var o=n[a];Yi(e,o,Ii.Invalid_binder,Qi(o))}}}(e,r,o)),xi(e,f?a.returnType:Li.All)}function $i(e,r){Yi(e,r,Ii.Unclosed_expression,r.isClosed);var n=r.args;if(r.head.kind===gi.Operator)return function(e,r,n){var t=_i(r.id),a=n.length,o=a===t.minArgs;Yi(e,r,Ii.Incorrect_number_of_operator_arguments,o);for(var i=0;i<a;i+=1){var u=n[i];Hi(u)&&(o=!1,Yi(e,u,Ii.Missing_operation_argument)),zi(e,u,Pi(t,i))}return o?(e.specialDependencies|=t.staticPrecs,xi(e,t.returnType)):xi(e,Li.All)}(e,r.head,n);if(Qi(r.head)){var t=e.globals.config.localeInfo.getWorksheetFuncId(r.head.whole.toLocaleUpperCase());if(void 0!==t)return Zi(e,t,r)}for(var a=0;a<n.length;a+=1)zi(e,n[a],Li.All);var o=r.head,i=eu(e,o);return Ji(i.result,mi.Range)||i.result===mi.Error&&function(e){for(var r=e;r.kind===gi.Paren;)r=r.node;return Ki(r)}(o)?xi(e,Li.All):(Yi(e,o,Xi(o)||o.kind===gi.Array?Ii.Unexpected_application_head:Ii.Unexpected_application_head_with_fix),xi(e,Li.All))}function eu(e,r){if(e.earlyExit&&!e.isOk())throw Vi;switch(r.kind){case gi.App:return $i(e,r);case gi.Array:return qi(e,r,mi.Array);case gi.Bad:return Yi(e,r,Ii.Bad_node),{context:e,result:Li.All};case gi.CellRef:return e.source!==Oi.Cell&&e.source!==Oi.Range||void 0===r.qualifier||r.qualifier.kind!==Ai.Relative?xi(e,mi.Range):(Yi(e,r,Ii.Invalid_rel_sheet_qualifier_in_cell),xi(e,Li.All));case gi.Literal:return Yi(e,r,Ii.Unclosed_expression,r.isClosed),xi(e,ki(r.oper));case gi.Name:return xi(e,Li.All);case gi.Paren:return Yi(e,r,Ii.Unclosed_expression,r.isClosed),Yi(e,r,Ii.Empty_parenthesis,!Hi(r.node)),eu(e,r.node);default:return I("calc.analyze.checker.infer: unhandled formula case",r)}}var ru={ok:!0,isOk:Or,collect:function(e,r,n){return!1}};function nu(e,r,n,t,a){void 0===a&&(a=!0);var o={globals:e,location:r,source:n,reportError:t.collect,isOk:function(){return t.isOk(o.errorData)},earlyExit:a,specialDependencies:Mi.None,errorData:t.ok};return o}function tu(e,r){try{return Yi(e,r.node,Ii.Empty_formula,!Hi(r.node)),zi(e,r.node,Li.All)}catch(r){return r!==Vi&&R.ULS.traceTag(595952020,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Exception in calc.analyze.check.runChecker: "+E(r)),xi(e,Li.All)}}function au(e,r){if(r.kind!==gi.Bad||r.type!==Ni.Sequence||3!==r.contents.length)return!1;var n=r.contents[0],t=r.contents[2];return n.kind===gi.Bad&&n.type===Ni.Unexpected&&n.contents===e.leftBracket&&(t.kind===gi.Bad&&t.type===Ni.Unexpected&&t.contents===e.rightBracket)}function ou(e,r){if(2===r.length){var n=r[0],t=r[1];return au(e,n)?function(e){return e.kind===gi.Name&&null!=e.qualifier&&e.qualifier.kind===Ai.Ident}(t)?gi.Name:function(e){return e.kind===gi.CellRef&&null!=e.qualifier&&e.qualifier.kind===Ai.Sheet&&null==e.qualifier.document}(t)?gi.CellRef:void 0:function(e,r){return r.kind===gi.Bad&&r.type===Ni.Qualifier&&r.contents.indexOf(e.leftBracket)>=0}(e,n)?Qi(t)?gi.Name:function(e){return e.kind===gi.CellRef&&null==e.qualifier}(t)?gi.CellRef:void 0:void 0}}function iu(e){if(e.kind===gi.Literal&&e.isClosed)switch(ki(e.oper)){case mi.Number:case mi.Boolean:case mi.String:case mi.Error:return!0;default:return!1}return!1}function uu(e,r){var n=r.head,t=n.kind!==gi.Operator;if(!r.isClosed||r.args.some(function(r){return!cu(e,r,t)}))return!1;if(n.kind===gi.Operator)return(o=_i(n.id)).minArgs===r.args.length;if(!cu(e,n,!1))return!1;if(Qi(n)){var a=e.config.localeInfo.getWorksheetFuncId(n.whole.toLocaleUpperCase());if(void 0!==a){var o=Fi(a),i=Ui(r).length;if(i<o.minArgs)return!1;if(0===o.restTypes.length&&i>o.headTypes.length)return!1;if(o.restTypes.length>1&&a!==yi.SWITCH)if((i-o.headTypes.length)%o.restTypes.length!=0)return!1;return function(e,r){switch(e){case yi.LET:return Qi(r[0]);case yi.FUN:return r.slice(0,r.length-1).every(Qi);default:return!0}}(a,r.args)}}return!0}function cu(e,r,n){switch(r.kind){case gi.Literal:return r.isClosed&&(!!n||ki(r.oper)!==mi.Missing);case gi.Name:case gi.CellRef:return!0;case gi.Array:return r.isClosed&&r.nodes.length>0&&r.nodes.every(function(e){return function(e,r){return e.length===r&&e.every(iu)}(e,r.nodes[0].length)});case gi.App:return uu(e,r);case gi.Paren:return r.isClosed&&cu(e,r.node,!1);case gi.Bad:return!1;default:return I("calc.analyze.isWF",r)}}function lu(e,r,n){switch(r.kind){case gi.Literal:case gi.Name:break;case gi.CellRef:r.ref.kind===Ci.Row&&(n.rowRef+=1),r.ref.kind===Ci.Col&&(n.colRef+=1);break;case gi.Array:r.nodes.forEach(function(r){return r.forEach(function(r){return lu(e,r,n)})});break;case gi.App:r.head.kind!==gi.Operator&&lu(e,r.head,n),r.args.forEach(function(r){return lu(e,r,n)});break;case gi.Paren:lu(e,r.node,n);break;case gi.Bad:if(r.type===Ni.Sequence){var t=r.contents;if(function(e,r){return 2===r.length&&Qi(r[0])&&au(e,r[1])}(e,t))n.structRef+=1;else{var a=ou(e,t);null!=a?(a===gi.Name?n.docQualName+=1:a===gi.CellRef&&(n.docQualCellRef+=1),lu(e,t[1],n)):t.forEach(function(r){return lu(e,r,n)})}}else r.type===Ni.Qualifier&&(n.badQual+=1);break;default:return I("calc.analyze.collectRefStats",r)}}var su=Bi(bi(function(e){return 1}),function(e){return 1},{vArray:function(e){var r=-1;return e.nodes.forEach(function(e){e.forEach(function(e){var n=wi(e,su);r=Math.max(r,n)})}),1+r},vRange:function(e){var r=wi(e.ref1,su),n=wi(e.ref2,su);return 1+Math.max(r,n)},vBad:function(e){if(e.type===Ni.Sequence){var r=-1;return e.contents.forEach(function(e){var n=wi(e,su);r=Math.max(r,n)}),1+r}return 1},vCellRef:function(e){var r=-1;if(void 0!==e.qualifier){var n=wi(e.qualifier,su);r=Math.max(r,n)}return 1+Math.max(r,wi(e.ref,su))},vParen:function(e){return 1+wi(e.node,su)},vApp:function(e){var r=-1;return e.args.forEach(function(e){var n=wi(e,su);r=Math.max(r,n)}),1+r}});var fu=[];function du(e,r,n,t,a){var o={rowRef:0,colRef:0,structRef:0,docQualName:0,docQualCellRef:0,badQual:0};if(lu(e.config.localeInfo,t.node,o),o.rowRef+o.colRef+o.structRef+o.docQualName+o.docQualCellRef+o.badQual>0&&R.ULS.traceTag(595961670,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.checkFormula: possible unsupported references; operation: "+a+"; anonymize: "+E(t.node)+"; stats = "+JSON.stringify(o)),Nr(Sr.CalcStrictFormulaChecking))if(fu.length<10){var i=function(e){return Gi(e,su,-1)}(t.node);fu.push(i)}else R.ULS.traceTag(595957962,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+fu.join("; ")),fu=[];var u=Nr(Sr.CalcStrictFormulaChecking)?function(e,r,n,t){return tu(nu(e,r,n,ru),t).context.errorData}(e,r,n,t):cu(e,t.node,!1);return u||function(e){e.kind!==gi.App||e.isClosed||R.ULS.traceTag(595949718,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.analyze.tracePossibleFixes: formula missing paren that could be automatically closed")}(t.node),In({},t,{isWellFormed:u})}var Eu,pu,vu=Xr.SpecialPrecs,Tu=Xr.precedents;function hu(e){return{findStaticPrecedents:function(e){return Tu([],[],vu.All,!1)},checkFormula:function(r,n,t,a){return du(e,r,n,t,void 0!==a?a:"undefined")},checkFormulaWithCodes:function(r,n,t){return function(e,r,n,t){return tu(nu(e,r,n,{ok:[],isOk:function(e){return 0===e.length},collect:function(e,r,n){return n.push({label:e.label,errorCode:r.code}),n}},!1),t).context.errorData}(e,r,n,t)},findBestFormat:function(e,r,n){n.node}}}!function(e){e.WorksheetFunction="WorksheetFunction"}(Eu||(Eu={})),function(e){e.RangeValues="RangeValues"}(pu||(pu={}));var Ru=Xr.div0ErrorOper,Su=Xr.numErrorOper,Iu=Math.pow(2,-52),gu=Math.pow(2,-1022);function Au(e){return Math.abs(e)<gu?0:e}function Nu(e){return isFinite(e)?Au(e):Su}var Cu=Math.pow(2,32)-2;function Ou(e,r){var n=Math.pow(e,r);return isFinite(n)?Au(n):r<0?Ru:Su}var mu,Du,Lu,Mu={sqrt:function(e){return Nu(Math.sqrt(e))},sqrtpi:function(e){return Nu(function(e){var r=e*Math.PI;return isFinite(r)?Math.sqrt(r):Math.sqrt(e)*Math.sqrt(Math.PI)}(e))},exp:function(e){return Nu(Math.exp(e))},power:function(e,r){return 0===r?0===e?Su:1:0===e?r<0?Ru:0:e>0?Ou(e,r):function(e){if(e<-Cu||e>Cu)return!1;if(e===Math.floor(e))return!0;var r=Math.abs(e);return 1+-22.5*Iu<=r&&r<=1+2*Iu}(r)?Ou(e,Math.round(r)):Su},ln:function(e){return Nu(Math.log(e))},log10:function(e){return Nu(Math.log(e)/Math.LN10)},log:function(e,r){if(e<=0||r<=0)return Su;var n=Math.log(e)/Math.log(r);return isFinite(n)?Au(n):Ru},sin:function(e){return Math.abs(e)<Math.pow(2,27)?Nu(Math.sin(e)):Su},cos:function(e){return Math.abs(e)<Math.pow(2,27)?Nu(Math.cos(e)):Su},tan:function(e){return Math.abs(e)<Math.pow(2,27)?Nu(Math.tan(e)):Su},asin:function(e){return Nu(Math.asin(e))},acos:function(e){return Nu(Math.acos(e))},atan:function(e){return Nu(Math.atan(e))},atan2:function(e,r){return 0===e&&0===r?Ru:Au(Math.atan2(r,e))}};!function(e){e[e.Array=-2147483648]="Array",e[e.Fun=-2147483647]="Fun",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483643]="Name",e[e.CellRef=-2147483642]="CellRef",e[e.Ident=-2147483641]="Ident",e[e.If=-2147483640]="If"}(Lu||(Lu={}));var _u=(mu=Cr(Or,Or)).wrap,yu=mu.unwrap,Fu=(Du=Cr(function(e){return-e},function(e){return-e})).wrap,ku=Du.unwrap;function Uu(e){return e>0}function Pu(e){return{kind:e,data:void 0,children:void 0}}function bu(e,r,n){var t=Pu(Lu.Array);return t.children=n,t.data={rows:e,cols:r},t}function Bu(e,r){var n=Pu(Lu.Fun);return n.children=r,n.data=e,n}function wu(e,r,n){var t=Pu(Lu.Let);return t.children=[r,n],t.data=e,t}function Gu(e,r,n){var t=Pu(Lu.App);return t.children=n,t.data={funName:e,funType:r},t}function Vu(e){var r=Pu(Lu.Ident);return r.data=e,r}function xu(e,r,n){var t=Pu(Lu.If);return t.children=[e,r,n],t}function Wu(e){return"object"!=typeof e||e.kind>0}function Hu(e,r){for(var n,t=0;t<e.length;t+=1){var a=e[t],o=r(a);void 0===n?o!==a&&(n=e.slice(0,t)).push(o):n.push(o)}return void 0!==n?n:e}function Ku(e,r){return Hu(e,function(e){return function(r){return Hu(r,e)}}(r))}function Xu(e,r){return r(function(e,r){if(Wu(e))return e;switch(e.kind){case Lu.Let:var n=e.children,t=n[0],a=n[1],o=r(t),i=r(a);return t===o&&a===i?e:wu(e.data,o,i);case Lu.App:var u=Hu(e.children,r);return u===e.children?e:Gu(e.data.funName,e.data.funType,u);case Lu.If:var c=e.children,l=c[0],s=c[1],f=c[2],d=r(l),E=r(s),p=r(f);return l===d&&s===E&&f===p?e:xu(d,E,p);case Lu.Fun:var v=r(e.children);return v===e.children?e:Bu(e.data,v);case Lu.Array:var T=Ku(e.children,r);return T===e.children?e:bu(e.data.rows,e.data.cols,T);case Lu.Name:case Lu.CellRef:case Lu.Ident:return e}}(e,function(e){return Xu(e,r)}))}var Qu=function(){function e(e,r,n){A("calc.common.StrictArray2D",e),A("calc.common.StrictArray2D",r);var t=n.length;t<e&&g("calc.common.StrictArray2D: expected elements.length >= "+e+"; given "+t);for(var a=0;a<t;a+=1){var o=n[a].length;o<r&&g("calc.common.StrictArray2D: expected elements["+a+"].length >= "+e+"; given "+o)}this.rows=e,this.cols=r,this.elements=n}return e.prototype.get=function(e,r){return C("calc.common.StrictArray2D.get",e,this.rows),C("calc.common.StrictArray2D.get",r,this.cols),this.elements[e][r]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var r=this;return new Yu(this.rows,this.cols,function(n,t){return e(r.elements[n][t])})},e}();var Yu=function(){function e(e,r,n){A("calc.common.NonstrictArray2D",e),A("calc.common.NonstrictArray2D",r),this.rows=e,this.cols=r,this.func=n}return e.prototype.get=function(e,r){return C("calc.common.NonstrictArray2D.get",e,this.rows),C("calc.common.NonstrictArray2D.get",r,this.cols),this.func(e,r)},e.prototype.strict=function(){var e=Ju(this.rows,this.cols,this.func);return new Qu(this.rows,this.cols,e)},e.prototype.map=function(r){var n=this;return new e(this.rows,this.cols,function(e,t){return r(n.func(e,t))})},e}();function Ju(e,r,n){for(var t=[],a=0;a<e;a+=1){for(var o=[],i=0;i<r;i+=1)o[i]=n(a,i);t[a]=o}return t}function ju(e){return Ju(e.rows,e.cols,e.get.bind(e))}function qu(e,r,n){for(var t=[],a=[],o=0;o<r;o+=1)a[o]=n;for(var i=0;i<e;i+=1)t[i]=a;return t}function zu(e,r,n){return new Yu(e,r,function(e,r){return n})}var Zu,$u=Kr.FormulaSource,ec=Jr.ResultKind,rc=Jr.isGridCell,nc=Jr.ReasonKind,tc=Jr.notImplemented,ac=Jr.unavailable;!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.Unevaluated="Unevaluated",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.JavaScriptError="JavaScriptError",e.IllFormedFormula="IllFormedFormula"}(Zu||(Zu={}));var oc,ic,uc=In({},nc,Zu);function cc(e){return{kind:uc.IllFormedFormula,message:e}}function lc(e){return{kind:oc.FinalValue,oper:e}}function sc(e){return{kind:oc.PendingValue,anchor:e}}function fc(e,r,n){return r!==$u.Cell||rc(e.range)||g("calc.runtime.cellFormula: expected single-cell range; given "+E(e)),{kind:oc.Formula,range:e,source:r,formula:n}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue",e.Formula="Formula"}(oc||(oc={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(ic||(ic={}));var dc={kind:uc.Stopped};function Ec(e){return 0===e.length&&g("calc.runtime.unevaluated: expected nonempty array"),{kind:uc.Unevaluated,anchors:e}}function pc(e,r,n,t,a,o,i,u,c,l,s,f,d,E,p){return{config:e,mathpack:r,getDocumentLoc:function(e,r){return Rr(n(e,r))},getSheetIndex:t,getCellValue:a,getCellValues:o,getFirstOrderFunc:i,getNameFormula:u,getCellFormula:c,interruptToken:[ic.Continue],schedulerInfo:null!=p?p:{},setCellValue:l,setCellValues:s,setCellFailure:f,setDynamicPrecs:d,loadObjects:E}}function vc(e){return{kind:uc.NameCycle,names:e}}function Tc(e){return{kind:uc.CellCycle,cells:e}}function hc(e){return{kind:uc.PreviousFailure,range:e}}function Rc(e){return{kind:uc.JavaScriptError,error:e}}function Sc(e){return{kind:ec.Paused,reason:uc.Timeout,resume:e}}function Ic(e){if(e.kind===ec.Failure)return e.reason.kind}var gc=Kr.gridCell,Ac=Kr.gridRange,Nc=Xr.arrayOper,Cc=Xr.naErrorOper,Oc=Xr.OperKind,mc=Oc.Number|Oc.String|Oc.Boolean|Oc.Error|Oc.Rich|Oc.Array,Dc=Oc.Number|Oc.String|Oc.Boolean|Oc.Error|Oc.Blank|Oc.Rich,Lc=Dc|Oc.Array;function Mc(e,r,n){var t=e+": generated Excel error, type "+r+"; "+n;R.ULS.traceTag(596120270,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,t)}function _c(e){return"object"==typeof e&&e.kind===Oc.Error}function yc(e){return"object"==typeof e&&e.kind===Oc.Blank}function Fc(e){return"object"==typeof e&&e.kind===Oc.Array}function kc(e){return e.kind===Ge.Success?e.value:void 0}function Uc(e,r){switch(e.kind){case Ge.Success:return Er(lc(e.value));case Ge.Failure:return pr(hc(r))}}function Pc(e,r,n){var t=Fc(n)?function(e,r,n,t,a,o){if(e===n&&r===t)return a;if(1===e&&1===r)return qu(n,t,void 0===a[0]?o:a[0][0]);var i,u=[];i=1===e?function(e,n){return n<r?a[0][n]:o}:1===r?function(r,n){return r<e?a[r][0]:o}:function(n,t){return n<e&&t<r?a[n][t]:o};for(var c=0;c<n;c+=1){u.push([]);for(var l=0;l<t;l+=1)u[c][l]=i(c,l)}return u}(n.rows,n.cols,e,r,n.opers,Cc):qu(e,r,n);return Nc(e,r,t)}function bc(e,r){var n=e.row,t=e.col,a=e.rows,o=e.cols,i=r.row,u=r.col,c=r.rows,l=r.cols,s=Math.min(n,i),f=Math.min(t,u),d=Math.max(n+a,i+c)-s,E=Math.max(t+o,u+l)-f;return Ac(s,f,d,E)}function Bc(e){return 0===e.length&&g("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(bc)}function wc(e,r){var n=e.row,t=e.col,a=e.rows,o=e.cols,i=r.row,u=r.col,c=r.rows,l=r.cols,s=Math.max(n,i),f=Math.max(t,u),d=Math.min(n+a,i+c)-s,E=Math.min(t+o,u+l)-f;if(!(d<=0||E<=0))return Ac(s,f,d,E)}function Gc(e){return e.rows*e.cols}var Vc=Qr.NodeKind,xc=Jr.getArguments,Wc=Xr.arrayOper,Hc=Yr.WorksheetFuncId,Kc=Jr.success,Xc=function(){var e=0;return function(){var r=e;return e+=1,r}}();function Qc(e){return"object"!=typeof e||Wu(e)&&function(e){return"object"!=typeof e||e.kind===Oc.Error||e.kind===Oc.Array||e.kind===Oc.Rich}(e)}function Yc(e,r,n){var t=xc(n).map(function(n){return Jc(e,r,n)}),a=Yr.getWorksheetFuncType(Hc._UDF);return Gu(Fu(Hc._UDF),a,[Jc(e,r,n.head)].concat(t))}function Jc(e,r,n){switch(n.kind){case Vc.Array:return function(e){var r=e.length,n=void 0===e[0]?0:e[0].length;return e.every(function(e){return e.every(Qc)})?Wc(r,n,e):bu(r,n,e)}(n.nodes.map(function(n){return n.map(function(n){return Jc(e,r,n)})}));case Vc.App:var t=n.head;if(t.kind===Vc.Operator){var a=xc(n).map(function(n){return Jc(e,r,n)}),o=Yr.getOperatorType(t.id);return Gu(_u(t.id),o,a)}if(t.kind===Vc.Name&&null==t.qualifier)if(null!=(u=e.config.localeInfo.getWorksheetFuncId(t.whole.toLocaleUpperCase()))){var i=void 0;switch(u){case Hc.LET:i=function(e,r,n){if(3===n.args.length){var t=n.args[0];if(t.kind===Vc.Name&&null==t.qualifier){var a=t.whole,o=Xc(),i=Dr(r);return i[a]=o,wu(o,Jc(e,r,n.args[1]),Jc(e,i,n.args[2]))}}}(e,r,n);break;case Hc.FUN:i=function(e,r,n){var t=n.args.slice(0,n.args.length-1);if(t.length>0&&t.every(function(e){return e.kind===Vc.Name&&null==e.qualifier})){for(var a=t.map(function(e){return e.whole}),o=a.map(Xc),i=Dr(r),u=0;u<a.length;u+=1)i[a[u]]=o[u];return Bu(o,Jc(e,i,n.args[t.length-1]))}}(e,r,n);break;case Hc.IF:i=function(e,r,n){var t=n.args;return 3===t.length?xu(Jc(e,r,t[0]),Jc(e,r,t[1]),Jc(e,r,t[2])):2===t.length?xu(Jc(e,r,t[0]),Jc(e,r,t[1]),!1):void 0}(e,r,n);break;default:a=xc(n).map(function(n){return Jc(e,r,n)}),o=Yr.getWorksheetFuncType(u);i=Gu(Fu(u),o,a)}return void 0===i?Yc(e,r,n):i}return Yc(e,r,n);case Vc.Paren:return Jc(e,r,n.node);case Vc.Name:var u;if(null==n.qualifier)if(void 0!==(u=r[n.whole]))return Vu(u);return function(e,r,n){var t=Pu(Lu.Name);return t.data={whole:e.toLocaleUpperCase(),split:r.map(function(e){return e.toLocaleUpperCase()}),qualifier:n},t}(n.whole,n.whole.split("."),n.qualifier);case Vc.CellRef:return function(e,r){var n=Pu(Lu.CellRef);return n.data={ref:e,qualifier:r},n}(n.ref,n.qualifier);case Vc.Literal:return n.oper;case Vc.Bad:var l="calc.runtime.compile: unexpected bad node "+E(n);return R.ULS.assertTag(595980820,c.LogCategory.msoulscat_ES_EWAJS,!1,l);default:return I("calc.runtime.compile",n)}}var jc=function(e){if(!Wu(e)&&e.kind===Lu.App&&!Uu(e.data.funName)){var r=ku(e.data.funName);if(r===Hc.IFERROR||r===Hc.IFNA){var n=Xc(),t=Vu(n),a=r===Hc.IFERROR?Hc.ISERROR:Hc.ISNA,o=Yr.getWorksheetFuncType(a),i=xu(Gu(Fu(a),o,[t]),e.children[1],t);return wu(n,e.children[0],i)}}return e};var qc,zc=function(){return function(e){this.term=e}}();function Zc(e,r){return r instanceof zc?r.term:g(e+": expected known compiled formula type; given "+E(r))}function $c(e,r,n,t){var a=function(e){return Xu(e,jc)}(Jc(e,mr(),t.node));return Kc(new zc(a))}function el(e){return{compileFormula:function(r,n,t){return $c(e,0,0,t)}}}function rl(e,r){return 0==(e&r)}function nl(e,r){return(e|r-1)&~r}!function(e){e[e.Empty=0]="Empty",e[e.Lf=1]="Lf",e[e.Br=2]="Br"}(qc||(qc={}));var tl={kind:qc.Empty};function al(e){return e===tl}function ol(e,r){return{kind:qc.Lf,key:e,value:r}}function il(e,r,n,t){return{kind:qc.Br,prefix:e,mask:r,l:n,r:t}}function ul(e,r,n,t){var a=function(e,r){return function(e){var r=e;return r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,(r|=r>>>16)^r>>>1}(e^r)}(e,n),o=nl(e,a),i=rl(e,a);return il(o,a,i?r:t,i?t:r)}var cl,ll=tl,sl=function e(r,n,t){switch(t.kind){case qc.Empty:return ol(r,n);case qc.Lf:var a=ol(r,n);return t.key===r?a:ul(r,a,t.key,t);case qc.Br:return function(e,r,n){return nl(e,n)===r}(r,t.prefix,t.mask)?rl(r,t.mask)?il(t.prefix,t.mask,e(r,n,t.l),t.r):il(t.prefix,t.mask,t.l,e(r,n,t.r)):ul(r,ol(r,n),t.prefix,t)}},fl=function(e,r){for(var n=r;n.kind===qc.Br;)n=rl(e,n.mask)?n.l:n.r;if(!al(n))return e===n.key?n.value:void 0},dl=Kr.FormulaSource,El=Jr.isSheetGridCell,pl=function(e){this.reason=e,this.name="EvaluationError",this.stack="EvaluationError",this.message=e.kind};function vl(e){throw new pl(e)}function Tl(e,r,n,t){return{range:e,source:r,precedents:n,visitedCellMap:t}}function hl(e,r,n,t){if(r===dl.Cell){if(El(e))return Tl(e,r,n,t);g("calc.runtime.evalLocals: expected single-cell range; given "+E(e))}return Tl(e,r,n,t)}pl.prototype=Object.create(Error.prototype),pl.prototype.constructor=pl,function(e){e[e.Default=1]="Default",e[e.Dependency=2]="Dependency",e[e.Call=3]="Call",e[e.Write=4]="Write",e[e.Return=5]="Return"}(cl||(cl={}));var Rl={kind:cl.Default},Sl=function(){function e(e){this.context=e,this.latestTransition=cl.Default}return e.prototype.cleanup=function(){},e.prototype.performDefaultTransition=function(){return this.latestTransition=cl.Default,Rl},e.prototype.performDependencyTransition=function(e){return this.latestTransition=cl.Dependency,{kind:cl.Dependency,machines:e}},e.prototype.performCallTransition=function(e){return this.latestTransition=cl.Call,{kind:cl.Call,machine:e}},e.prototype.performWriteTransition=function(e,r){return this.latestTransition=cl.Write,{kind:cl.Write,result:e,locals:r}},e.prototype.performReturnTransition=function(e){return this.latestTransition=cl.Return,{kind:cl.Return,result:e}},e}(),Il={newVisitedMap:Al,visit:function(e,r,n){return Nl(Ll,e,r,n)},unVisit:function(e,r,n){return Cl(Ll,e,r,n)},lookup:function(e,r){return Ol(Ll,e,r)},runFrom:function(e,r){return ml(Ll,e,r)}},gl={newVisitedMap:Al,visit:function(e,r,n){return Nl(Ml,e,r,n)},unVisit:function(e,r,n){return Cl(Ml,e,r,n)},lookup:function(e,r){return Ol(Ml,e,r)},runFrom:function(e,r){return ml(Ml,e,r)}};function Al(){return{run:[],visited:mr()}}function Nl(e,r,n,t){var a=e(r);t.visited[a]=n,t.run.push([a,r])}function Cl(e,r,n,t){var a=e(r);t.visited[a]=n,t.run.pop()}function Ol(e,r,n){return n.visited[e(r)]}function ml(e,r,n){for(var t=[],a=n.run,o=0;o<a.length;){var i=a[o][0];if(e(r)===i)break;o+=1}for(;o<a.length;)t.push(a[o][1]),o+=1;return t}function Dl(e){var r=e.document,n=e.index,t="$";return null!=r.path&&(t+=r.path),t+=";",t+=r.name,t+=";",null!=n&&(t+=n,t+=";"),t}function Ll(e){var r=Dl(e.scope);return r+=";",r+=e.name}function Ml(e){var r=Dl(e.sheet);return r+=";",r+=e.range.row,r+=";",r+=e.range.col}var _l=Xr.SpecialPrecs,yl=Xr.precedents,Fl=Xr.OperKind,kl=Jr.failure,Ul=Jr.sheetGridRangeAnchor,Pl=Jr.success,bl=Jr.ResultKind,Bl=function(e){function r(r,n){var t=e.call(this,r)||this;return t.cell=n,t.locals=void 0,t}return Sn(r,e),r.prototype.getRealReason=function(e){if(e.kind!==uc.PreviousFailure)return e;var r=Ul(e.range),n=gl.lookup(r,this.context.visitedCellMap);return"object"==typeof n&&n.kind===bl.Failure?n.reason:e},r.prototype.visitAnchor=function(e){var r=Ul(e.range),n=gl.lookup(r,this.context.visitedCellMap);if(null!=n){var t="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+E(r)+"; given "+E(n));return R.ULS.assertTag(595980812,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}gl.visit(r,oc.PendingValue,this.context.visitedCellMap);var a=yl([],[],_l.None,!0);return this.locals=hl(e.range,e.source,a,this.context.visitedCellMap),this.locals},r.prototype.unVisitAnchor=function(e){var r=this.locals;if(null!=r){var n=Ul(r.range);return gl.unVisit(n,e,this.context.visitedCellMap),this.locals=void 0,r}},r.prototype.next=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===bl.Failure)return this.performReturnTransition(kl(this.getRealReason(e.reason)));var r=e.value;if(r.kind===oc.FinalValue)return this.performReturnTransition(Pl(r.oper));var n=this.context.globals.getCellFormula(r.anchor);if(n.kind===bl.Failure){var t="calc.runtime.CellEvaluationMachine.next: returning Failure from getCellFormula is deprecated";return R.ULS.assertTag(595980813,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}var a=n.value;if(null==a){t="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+E(r.anchor)+") != null");return R.ULS.assertTag(595980814,c.LogCategory.msoulscat_ES_EWAJS,!1,t)}var o=this.visitAnchor(a),i=this.context.createFormulaEvaluationMachine(this.context,o,a.formula);return this.performCallTransition(i)},r.prototype.receiveSuccess=function(e){var r=e.value;if("object"==typeof r&&(r.kind===Fl.Range||r.kind===Fl.Missing)){var n="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+E(r));return R.ULS.assertTag(595980815,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}var t=this.unVisitAnchor(void 0);if(null==t){n="calc.runtime.CellEvaluationMachine.receiveSuccess: expected this.locals != null";return R.ULS.assertTag(595980816,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}return this.performWriteTransition(e,t)},r.prototype.receiveFailure=function(e){var r=this.getRealReason(e.reason);if(r.kind===uc.Unevaluated){var n="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+E(r));return R.ULS.assertTag(595980817,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}var t=r===e.reason?e:kl(r),a=this.unVisitAnchor(t);if(null==a){n="calc.runtime.CellEvaluationMachine.receiveFailure: expected this.locals != null";return R.ULS.assertTag(595980818,c.LogCategory.msoulscat_ES_EWAJS,!1,n)}return this.performWriteTransition(t,a)},r.prototype.cleanup=function(){this.unVisitAnchor(void 0)},r}(Sl);function wl(e,r){return new Bl(e,r)}function Gl(e,r){if(0===r.length)return[];for(var n=lf(e),t=[],a=0;a<r.length;a+=1)t.push(wl(n.machineContext,r[a]));return function e(r,n){var t=r.evaluate(n);return t instanceof Array?t:Sc(function(t){return e(r,"number"==typeof t?t:n)})}(new ff(n,t),uf(of(e.schedulerInfo)))}var Vl=Kr.FormulaSource,xl=Kr.sheetGridCell,Wl=Kr.sheetGridRange,Hl=Xr.OperKind,Kl=Xr.ErrorType,Xl=Xr.refErrorOper,Ql=Xr.valueErrorOper,Yl=Xr.arrayOper,Jl=Jr.ResultKind,jl=Jr.isGridCell,ql=Jr.isSheetIndex,zl=Jr.getArgType;function Zl(e,r){if(gl.lookup(e,r.visitedCellMap)===oc.PendingValue)return vl(Tc(gl.runFrom(e,r.visitedCellMap)))}function $l(e,r,n,t){r.precedents.cells.push(n);var a=e.getCellValue(n);if(a.kind===Jl.Failure)return vl(a.reason);var o=a.value;if(o.kind===oc.FinalValue)return o.oper;Zl(o.anchor,r),t.push(o.anchor)}function es(e,r,n,t){r.precedents.cells.push(n);var a=e.getCellValues(n);if(a.kind===Jl.Failure)return vl(a.reason);var o=t.length,i=function(e,r,n){for(var t=[],a=r.length,o=0,i=0;i<a;i+=1){t.push([]);var u=r[i].length;o=0===o?u:Math.min(u,o);for(var c=0;c<u;c+=1){var l=r[i][c];oc.FinalValue===l.kind?t[i][c]=l.oper:(Zl(l.anchor,e),n.push(l.anchor),t[i][c]=Xl)}}return new Qu(a,o,t)}(r,a.value,t);return o===t.length?i:void 0}function rs(e,r,n,t){var a=es(e,r,n,t);if(null!=a)return Yl(a.rows,a.cols,ju(a.map(function(e){return yc(e)?0:e})))}function ns(e,r,n,t,a){if(0!=(t&Hl.Range))return n;if("object"!=typeof n||n.kind!==Hl.Range)return n;var o=n.sheets;if(!ql(o))return Mc("calc.runtime.dereference",Kl.REF,"3D range, oper = "+E(n)),Xl;if(1!==n.ranges.length)return Mc("calc.runtime.dereference",Kl.VALUE,"union range, oper = "+E(n)),Ql;var i=n.ranges[0];if(0!=(t&Dc)){if(jl(i))return $l(e,r,xl(o,i),a);if(r.source===Vl.Cell){var u=function(e,r){var n=e.row,t=e.col,a=r.row,o=r.col,i=r.rows,u=r.cols,c=a<=n&&n<a+i,l=o<=t&&t<o+u;return c&&l?gc(n,t):c&&1===u?gc(n,o):l&&1===i?gc(a,t):void 0}(r.range.range,i);return null==u?(Mc("calc.runtime.dereference",Kl.VALUE,"empty intersection, oper = "+E(n)),Ql):$l(e,r,xl(o,u),a)}return rs(e,r,Wl(o,i),a)}return 0!=(t&Hl.Array)?rs(e,r,Wl(o,i),a):(Mc("calc.runtime.dereference",Kl.VALUE,"bad target type "+t),Ql)}function ts(e,r,n,t){for(var a=[],o=0;o<n.length;o+=1){var i=ns(e,r,n[o],zl(t,o),a);null!=i&&(n[o]=i)}if(a.length>0)return vl(Ec(a))}var as=Xr.OperKind,os=Xr.valueErrorOper,is=Xr.arrayOper,us=Jr.operKind,cs=[os,0,"",!1,!1],ls=as.Number|as.String|as.Boolean;function ss(e){var r=e&ls;return cs[r&-r]}function fs(e,r,n){var t=function e(r,n,t){if("number"==typeof n)return 0!=(t&as.Number)?n:0!=(t&as.String)?r.formatNumber(n):0!=(t&as.Boolean)?0!==n:0!=(t&as.Array)?is(1,1,[[n]]):os;if("string"==typeof n){if(0!=(t&as.String))return n;if(0!=(t&as.Number)){if(0===n.length)return os;var a=r.parseNumber(n);return dr(a)?a:os}return 0!=(t&as.Boolean)?0===r.stringCompareCI(n,r.trueName)||0!==r.stringCompareCI(n,r.falseName)&&os:os}if("boolean"==typeof n)return 0!=(t&as.Boolean)?n:0!=(t&as.Number)?n?1:0:0!=(t&as.String)?n?r.trueName:r.falseName:os;if(0!=(t&n.kind))return n;switch(n.kind){case as.Error:return n;case as.Missing:return 0!=(t&as.Blank)?Xr.blankOper:ss(t);case as.Blank:return ss(t);case as.Rich:return e(r,n.getFallback(),t);default:return os}}(e.config.localeInfo,r,n);return _c(t)&&!_c(r)&&Mc("calc.runtime.coerceOper",t.type,"kind = "+us(r)),t}var ds=Kr.sheetIndex,Es=Xr.OperKind,ps=Xr.rangeSeqOper,vs=Xr.ErrorType,Ts=Xr.valueErrorOper,hs=Xr.div0ErrorOper,Rs=Xr.nullErrorOper,Ss=Yr.OperatorId,Is=Jr.operKind,gs=Jr.isSheetIndex;function As(e,r){switch(e){case Ss.Eq:return 0===r;case Ss.Ne:return 0!==r;case Ss.Lt:return r<0;case Ss.Gt:return r>0;case Ss.Le:return r<=0;case Ss.Ge:return r>=0}}function Ns(e,r,n){return As(e,r-n)}function Cs(e,r,n){return As(e,r.toLocaleUpperCase().localeCompare(n.toLocaleUpperCase()))}function Os(e,r,n){return As(e,r<n?-1:r>n?1:0)}function ms(e,r,n){if(gs(r.sheets))if(gs(n.sheets))if(r.sheets.document===n.sheets.document){if(r.sheets.index===n.sheets.index)return ds(r.sheets.document,r.sheets.index);t="different sheet, range1 = "+E(r)+", range2 = "+E(n);Mc(e,vs.VALUE,t)}else{var t="different document, range1 = "+E(r)+", range2 = "+E(n);Mc(e,vs.VALUE,t)}else Mc(e,vs.VALUE,"3D reference, range2 = "+E(n));else Mc(e,vs.VALUE,"3D reference, range1 = "+E(r))}function Ds(e,r,n){if(1===n.length){var t=n[0];switch(r){case Ss.Percent:return Au(t/100);case Ss.Neg:return-t;case Ss.Pos:return t;default:var a="bad application of "+r+" to 1 argument";return Mc("calc.runtime.applyOperator",vs.VALUE,a),Ts}}if(2===n.length){t=n[0];var o=n[1];switch(r){case Ss.Add:return Nu(t+o);case Ss.Sub:return Nu(t-o);case Ss.Mul:return Nu(t*o);case Ss.Div:return 0===o?(Mc("calc.runtime.applyOperator",vs.DIV0,"division by zero"),hs):Nu(t/o);case Ss.Pow:return e.mathpack.power(t,o);case Ss.Concat:return t+o;case Ss.Eq:case Ss.Ne:case Ss.Lt:case Ss.Le:case Ss.Gt:case Ss.Ge:return function(e,r,n){var t=Is(r),a=Is(n);if(t!==a){if(t===Es.Blank)switch(a){case Es.Number:return Os(e,0,n);case Es.String:return Cs(e,"",n);case Es.Boolean:return Ns(e,!1,n)}if(a===Es.Blank)switch(t){case Es.Number:return Os(e,r,0);case Es.String:return Cs(e,r,"");case Es.Boolean:return Ns(e,r,!1)}return As(e,t-a)}switch(t){case Es.Number:return Os(e,r,n);case Es.String:return Cs(e,r,n);case Es.Boolean:return Ns(e,r,n);case Es.Blank:return As(e,0);default:return!1}}(r,t,o);case Ss.Range:return function(e,r){var n=ms("calc.runtime.applyRangeOp",e,r);if(null==n)return Ts;var t=[bc(Bc(e.ranges),Bc(r.ranges))];return ps(n,t)}(t,o);case Ss.Isect:return function(e,r){var n=ms("calc.runtime.applyIsectOp",e,r);if(null==n)return Ts;for(var t=[],a=0;a<e.ranges.length;a+=1)for(var o=0;o<r.ranges.length;o+=1){var i=wc(e.ranges[a],r.ranges[o]);null!=i&&t.push(i)}if(0===t.length){var u="empty intersection, range1 = "+E(e)+", range2 = "+E(r);return Mc("calc.runtime.applyIsectOp",vs.NULL,u),Rs}return ps(n,t)}(t,o);case Ss.Union:return function(e,r){var n=ms("calc.runtime.applyUnionOp",e,r);return null==n?Ts:ps(n,e.ranges.concat(r.ranges))}(t,o);case Ss.And:return t&&o;case Ss.Or:return t||o;case Ss.Xor:return t!==o;case Ss.Min:return Math.min(t,o);case Ss.Max:return Math.max(t,o);default:var i="bad application of "+r+" to 2 arguments";return Mc("calc.runtime.applyOperator",vs.VALUE,i),Ts}}var u="bad application of "+r+" to "+n.length+" arguments";return Mc("calc.runtime.applyOperator",vs.VALUE,u),Ts}var Ls=Kr.sheetIndex,Ms=Kr.sheetGridRange,_s=Xr.arrayOper,ys=Xr.nameErrorOper,Fs=Xr.naErrorOper,ks=Xr.numErrorOper,Us=Xr.valueErrorOper,Ps=Xr.OperKind,bs=Xr.ErrorType,Bs=Xr.SpecialPrecs,ws=Yr.functionType,Gs=Yr.FunctionFlags,Vs=Yr.SignatureType,xs=Yr.WorksheetFuncId,Ws=Yr.getOperatorType,Hs=Yr.getWorksheetFuncType,Ks=Jr.operKind,Xs=Jr.ResultKind,Qs=Jr.success,Ys=Jr.getArgType,Js=Jr.isValidArgsLength,js=Ps.Number|Ps.String|Ps.Boolean|Ps.Rich|Ps.Error|Ps.Blank,qs=ws(3,[Ps.Boolean,js,js],[],Vs.All,Bs.None,Gs.None),zs=function(){function e(e,r){this.globals=e,this.locals=r}return e.prototype.getMathpack=function(){return this.globals.mathpack},e.prototype.applyFunction=function(e,r){var n=Hs(e),t=r.some(function(e){return"object"==typeof e&&e.kind===Ps.Range})?r.slice(0):r;return ts(this.globals,this.locals,t,n),this.runFunctionToCompletion(Fu(e),n,t)},e.prototype.applyOperatorOrFunction=function(e,r){if(Uu(e))return Ds(this.globals,yu(e),r);var n=ku(e);if(n===xs._UDF)return vl(tc(["call UDF"]));var t=this.globals.getFirstOrderFunc(n);if(t.kind===Xs.Failure)return vl(t.reason);var a=t.value;if(null==a){var o="nonexistent worksheet function "+n;return Mc("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",bs.NAME,o),ys}var i=a(this,r);if("object"==typeof i&&i.kind===Ps.Error){o="worksheet function "+n+" return value";Mc("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",i.type,o)}return i},e.prototype.arrayLift=function(e,r,n){for(var t=this,a=0,o=0,i=0;i<n.length;i+=1){var u=n[i];Fc(u)&&0==(Ys(e,i)&Ps.Array)?(a=Math.max(a,u.rows),o=Math.max(o,u.cols)):(a=Math.max(a,1),o=Math.max(o,1))}var c=n.map(function(r,n){return t.broadcastOper(a,o,r,Ys(e,n))}),l=new Yu(a,o,function(e,n){return r(c.map(function(r){return r.get(e,n)}))}).map(function(e){var r;if("object"!=typeof(r="object"==typeof e&&e.kind===Eu.WorksheetFunction?t.runFunctionMachineToCompletion(e):e))return r;switch(r.kind){case Ps.Range:return Us;case Ps.Missing:case Ps.Blank:return 0;default:return r}});return _s(l.rows,l.cols,ju(l))},e.prototype.dispatchFunction=function(e,r,n){var t=this;if(!Js(r,n.length)){var a=JSON.stringify(r),o="bad application of "+JSON.stringify(e)+" to "+n.length+" arguments, ftype = "+a;return Mc("calc.runtime.FunctionDispatcher.dispatchFunction",bs.NUM,o),ks}for(var i=n.length,u=Vs.None,c=0;c<i;c+=1){var l=Ks(n[c]);0==(l&Ys(r,c))&&(u|=l)}if(u===Vs.None)return this.applyOperatorOrFunction(e,n);if(0!=(u&Ps.Array)){return this.arrayLift(r,function(n){return t.dispatchFunction(e,r,n)},n)}if(0!=((u&=~Ps.Array)&Ps.Rich))return vl(tc(["calc.runtime.evalFunction.FunctionDispatcher.dispatchFunction: overloading"]));u&=~Ps.Rich;var s=[];for(c=0;c<i;c+=1){var f=n[c];if(0!=(u&Ks(f))){var d=Ys(r,c);if(f=this.coerceOper(f,d),Ks(f)===Ps.Error&&0==(d&Ps.Error))return f}s[c]=f}return this.applyOperatorOrFunction(e,s)},e.prototype.dispatchStrictIf=function(e){var r=this,n=e[0];if("object"!=typeof n){var t=this.coerceOper(n,Ps.Boolean);return!0===t?e[1]:!1===t?e[2]:t}switch(n.kind){case Ps.Error:return n;case Ps.Missing:case Ps.Blank:return e[2];case Ps.Array:return this.arrayLift(qs,function(e){return r.dispatchStrictIf(e)},e);case Ps.Rich:return vl(tc(["calc.runtime.evalFunction.FunctionDispatcher.dispatchStrictIf: Strict IF with a rich value condition"]));case Ps.Range:var a="calc.runtime.FunctionDispatcher.dispatchStrictIf: "+("internal error: range condition "+E(n));return R.ULS.assertTag(595980809,c.LogCategory.msoulscat_ES_EWAJS,!1,a);default:return I("calc.runtime.FunctionDispatcher.dispatchStrictIf",n)}},e.prototype.dereferenceOper=function(e,r){return function(e,r,n,t){var a=[],o=ns(e,r,n,t,a);if(null==o){if(a.length>0)return vl(Ec(a));var i="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+E(n);return R.ULS.assertTag(595980819,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return o}(this.globals,this.locals,e,r)},e.prototype.dereferenceOpers=function(e,r){ts(this.globals,this.locals,e,r)},e.prototype.dereferenceAllOpers=function(e){for(var r=[],n=[],t=0;t<e.length;t+=1){var a=e[t];if("object"==typeof a&&a.kind===Ps.Range){for(var o=[],i=a.sheets,u=i.index,c=i.length,l=0;l<c;l+=1)for(var s=Ls(a.sheets.document,l+u),f=0;f<a.ranges.length;f+=1){var d=Ms(s,a.ranges[f]),E=es(this.globals,this.locals,d,r);null!=E&&o.push(E)}n.push({kind:pu.RangeValues,arrays:o})}else n.push(a)}return r.length>0?vl(Ec(r)):n},e.prototype.makeOperatorReducer=function(e,r){var n=this.getBinaryOperator(e);return function(e,t){return void 0===e?null!=r?r(t):t:n(e,t)}},e.prototype.makeBranchOperatorReducer=function(e,r){var n=this;return function(t,a){var o=n.makeOperatorReducer(e,r)(t,a);return void 0!==t&&!0===o?t:a}},e.prototype.reduceDerefOpers=function(e,r,n){function t(n,t){if("object"==typeof t){if(t.kind===Ps.Array)return a(n,new Qu(t.rows,t.cols,t.opers));if(t.kind===Ps.Rich)return n}var o=r(t);return null==o?n:e(n,o)}function a(e,r){for(var n=e,a=0;a<r.rows;a+=1)for(var o=0;o<r.cols;o+=1)n=t(n,r.get(a,o));return n}return n.reduce(function(e,r){return"object"==typeof r&&r.kind===pu.RangeValues?r.arrays.reduce(a,e):t(e,r)},void 0)},e.prototype.broadcastOper=function(e,r,n,t){if("object"!=typeof n)return zu(e,r,n);switch(n.kind){case Ps.Missing:case Ps.Blank:return zu(e,r,0);case Ps.Array:return 0!=(t&Ps.Array)?zu(e,r,n):function(e,r,n,t){return n.rows===e&&n.cols===r?n:1===n.rows&&1===n.cols?zu(e,r,n.get(0,0)):1===n.rows?new Yu(e,r,function(e,r){return r<n.cols?n.get(0,r):t}):1===n.cols?new Yu(e,r,function(e,r){return e<n.rows?n.get(e,0):t}):new Yu(e,r,function(e,r){return e<n.rows&&r<n.cols?n.get(e,r):t})}(e,r,new Qu(n.rows,n.cols,n.opers),Fs);case Ps.Range:default:return zu(e,r,n)}},e.prototype.coerceOper=function(e,r){return fs(this.globals,e,r)},e.prototype.getBinaryOperator=function(e){var r=this,n=Ws(e),t=[0,0];return function(a,o){return t[0]=a,t[1]=o,ts(r.globals,r.locals,t,n),r.runFunctionToCompletion(_u(e),n,t)}},e.prototype.getUnaryOperator=function(e){var r=this,n=Ws(e),t=[0];return function(a){return t[0]=a,ts(r.globals,r.locals,t,n),r.runFunctionToCompletion(_u(e),n,t)}},e.prototype.runFunctionToCompletion=function(e,r,n){var t=this.dispatchFunction(e,r,n);return"object"==typeof t&&t.kind===Eu.WorksheetFunction?this.runFunctionMachineToCompletion(t):t},e.prototype.runFunctionMachineToCompletion=function(e){for(;;){var r=e.next();if(null!=r)return r}},e}(),Zs=function(e){function r(r,n){var t=e.call(this,r)||this;return t.func=n,t}return Sn(r,e),r.prototype.next=function(){var e=this.func.next();return null==e?this.performDefaultTransition():this.performReturnTransition(Qs(e))},r.prototype.receiveSuccess=function(e){return R.ULS.assertTag(595980810,c.LogCategory.msoulscat_ES_EWAJS,!1,"calc.runtime.FunctionEvaluationMachine.receiveSuccess: received unexpected result")},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case uc.Unevaluated:for(var n=[],t=r.anchors,a=t.length-1;a>=0;a-=1){var o=this.context.createCellEvaluationMachine(this.context,t[a]);n.push(o)}return this.performDependencyTransition(n);default:return this.performReturnTransition(e)}},r}(Sl);function $s(e,r){return new Zs(e,r)}var ef=Kr.FormulaSource,rf=Xr.naErrorOper,nf=Jr.failure,tf=Jr.ResultKind,af=Jr.createResolver;function of(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Date.now()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function uf(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var r=Date.now()+e.yieldIntervalMs;return void 0===e.endTimeMs?r:Math.min(e.endTimeMs,r)}}var cf={kind:uc.Timeout};function lf(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Date.now()>=e}},machineContext:function(e){return{globals:e,visitedCellMap:gl.newVisitedMap(),resolver:af(e),createCellEvaluationMachine:wl,createFormulaEvaluationMachine:wf,createFunctionEvaluationMachine:$s}}(e)}}var sf,ff=function(){function e(e,r){N("calc.runtime.EvaluationRuntime",r.length),this.context=e,this.inputMachines=r.slice(),this.evaluationStack=[],this.results=[],this.nextIndex=0,this.currentResult=void 0}return e.prototype.evaluateAsync=function(e){var r=this;if(this.context.globals.interruptToken[0]===ic.Stop)return this.generatePartialResults(),R.ULS.traceTag(595953880,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime cancelled."),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var n=this.evaluate(uf(e));return n instanceof Array?(R.ULS.traceTag(595953881,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime complete."),Promise.resolve(n)):(R.ULS.traceTag(595953882,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime yielding."),new Promise(function(n){return e.scheduleFunction(function(){return R.ULS.traceTag(595964228,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Resuming async evaluation."),n(r.evaluateAsync(e))})}))}catch(e){return Promise.reject(nf(e))}},e.prototype.evaluate=function(e){try{for(;;){if(0===this.evaluationStack.length){if(!(this.nextIndex<this.inputMachines.length))return this.results;this.evaluationStack.push(this.inputMachines[this.nextIndex]),this.nextIndex+=1}if(this.context.timer.doTimeout(e))return cf;var r=this.evaluationStack[this.evaluationStack.length-1],n=this.evaluateMachine(r);switch(this.currentResult=void 0,n.kind){case cl.Default:break;case cl.Dependency:for(var t=0;t<n.machines.length;t+=1)this.evaluationStack.push(n.machines[t]);break;case cl.Call:this.evaluationStack.push(n.machine);break;case cl.Return:case cl.Write:this.performResultTransition(n);break;case uc.JavaScriptError:this.stopEvaluatingWithJavaScriptError(n);break;default:return I("calc.runtime.EvaluationRuntime.evaluate",n)}}}catch(e){var a="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+e.message;return R.ULS.assertTag(595980807,c.LogCategory.msoulscat_ES_EWAJS,!1,a)}},e.prototype.evaluateMachine=function(e){try{if(null==this.currentResult)return e.next();if(this.currentResult.kind===tf.Success)return e.receiveSuccess(this.currentResult)}catch(e){if(!(e instanceof pl))return Rc(e);this.currentResult=nf(e.reason)}try{return e.receiveFailure(this.currentResult)}catch(e){return Rc(e)}},e.prototype.performResultTransition=function(e){if(e.kind===cl.Write)try{this.writeResult(e.locals,e.result)}catch(e){return this.stopEvaluatingWithJavaScriptError(Rc(e))}var r=this.evaluationStack.pop();if(null!=r&&r.cleanup(),0===this.evaluationStack.length)this.results.push(e.result);else if(e.result.kind===tf.Success){(n=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===cl.Call&&(this.currentResult=e.result)}else{for(;this.evaluationStack.length>0;){var n;if((n=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===cl.Dependency)break;if(n.latestTransition===cl.Call){this.currentResult=e.result;break}var t=this.evaluationStack.pop();null!=t&&t.cleanup()}if(0===this.evaluationStack.length){var a="calc.runtime.EvaluationRuntime.evaluate: "+("internal error: empty stack while returning "+E(e.result));return R.ULS.assertTag(595980808,c.LogCategory.msoulscat_ES_EWAJS,!1,a)}}},e.prototype.writeResult=function(e,r){switch(r.kind){case tf.Success:this.setFormulaValue(e,r.value);break;case tf.Failure:this.context.globals.setCellFailure(e.range,r.reason)}this.context.globals.setDynamicPrecs(e.range,e.precedents)},e.prototype.setFormulaValue=function(e,r){var n=yc(r)?0:r;if(e.source===ef.Cell){if(Fc(n)){var t=void 0===n.opers[0]?rf:n.opers[0][0];return this.context.globals.setCellValue(e.range,t)}return this.context.globals.setCellValue(e.range,n)}var a=e.range.range,o=Pc(a.rows,a.cols,n).opers;return this.context.globals.setCellValues(e.range,o)},e.prototype.generatePartialResults=function(){for(var e=this.inputMachines.length-this.results.length,r=0;r<e;r+=1)this.results.push(nf(dc))},e.prototype.stopEvaluatingWithJavaScriptError=function(e){for(;;){var r=this.evaluationStack.pop();if(null==r)break;r.cleanup()}this.results.push(nf(e))},e}(),df=Kr.documentScope,Ef=Kr.nameLoc,pf=Kr.sheetIndex,vf=Kr.sheetRange,Tf=Kr.gridCell,hf=Qr.documentQualifier,Rf=Qr.QualifierKind,Sf=Qr.PosKind,If=Qr.CellRefKind,gf=Xr.ErrorType,Af=Xr.nameErrorOper,Nf=Xr.refErrorOper,Cf=Xr.OperKind,Of=Xr.arrayOper,mf=Xr.range3DOper,Df=Xr.rangeSeqOper,Lf=Jr.gridCellRange,Mf=Jr.ResultKind,_f=Jr.success,yf=Jr.failure,Ff=Jr.sheetGridRangeAnchor,kf=Jr.createResolutionHandler,Uf=Jr.createNameFinder,Pf=[void 0,Af],bf=ll;!function(e){e.Document="document",e.Sheet="sheet",e.Ident="sheet, then document"}(sf||(sf={}));var Bf=function(e){function r(r,n,t){var a=e.call(this,r)||this;return a.nameEvaluator=kf(Uf(function(e){var r=a.getNameFormulaAsTerm(a.locals,e);return void 0!==r&&a.checkForNameCycle(e,a.visitedNameMap),r},Pf),function(e){var r="name resolution; qualifier = "+E(e);return Mc("calc.runtime.FormulaEvaluationMachine.evalName",gf.NAME,r),Pf},vl),a.cellEvaluator=kf(function(e){return mf(e.sheet,e.range)},function(e){var r="error ref, qualifier = "+E(e.data.qualifier);return Mc("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",gf.REF,r),Nf},vl),a.term=Zc("calc.runtime.FormulaEvaluationMachine",t),a.locals=n,a.continuation=[],a.env=bf,a.visitedNameMap=Il.newVisitedMap(),a.dispatcher=new zs(a.context.globals,n),a}return Sn(r,e),r.prototype.next=function(){if(Wu(this.term)){var e=this.continuation;if(0===e.length){var r=this.dispatcher.dereferenceOper(this.term,Lc),n=this.dispatcher.coerceOper(r,Lc);return R.ULS.traceTag(595964229,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalFormula.next: Formula evaluation finished."),this.performReturnTransition(_f(n))}var t=e[e.length-1];return this.applyContinuation(this.term,t)}return this.reduceFormula(this.term)},r.prototype.receiveSuccess=function(e){return this.updateTermTransition(e.value)},r.prototype.receiveFailure=function(e){var r=e.reason;switch(r.kind){case uc.Unevaluated:for(var n=[],t=r.anchors,a=t.length-1;a>=0;a-=1){var o=this.context.createCellEvaluationMachine(this.context,t[a]);n.push(o)}return this.performDependencyTransition(n);default:return this.performReturnTransition(e)}},r.prototype.applyContinuation=function(e,r){var n=r.context;switch(n.kind){case Lu.App:var t=r.holeIndex,a=n.children.length;if((l=r.locals)[t]=e,t+1<a)return this.nextHoleTransition(r,n.children[t+1]);var o=n.data.funName,i=n.data.funType;this.dispatcher.dereferenceOpers(l,i);var u=this.dispatcher.dispatchFunction(o,i,l);return"object"==typeof u&&u.kind===Eu.WorksheetFunction?this.evaluateFunctionTransition(u,r.env):this.popContextTransition(r.env,u);case Lu.If:var l;if(0===(t=r.holeIndex)){var s=this.dispatcher.dereferenceOper(e,Cf.Boolean);if("object"!=typeof s){var f=this.dispatcher.coerceOper(s,Cf.Boolean),d=!0===f?n.children[1]:!1===f?n.children[2]:f;return this.popContextTransition(r.env,d)}switch(s.kind){case Cf.Error:return this.popContextTransition(r.env,s);case Cf.Missing:case Cf.Blank:return this.popContextTransition(r.env,n.children[2]);case Cf.Array:return r.locals=[s],this.nextHoleTransition(r,n.children[t+1]);case Cf.Rich:return this.performReturnTransition(yf(tc(["IF with a rich value condition"])));case Cf.Range:var p="calc.runtime.FormulaEvaluationMachine.applyContinuation: "+("internal error: range condition "+E(s));return R.ULS.assertTag(595980811,c.LogCategory.msoulscat_ES_EWAJS,!1,p);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation (if)",s)}}if((l=r.locals)[t]=e,1===t)return this.nextHoleTransition(r,n.children[t+1]);this.dispatcher.dereferenceOpers(l,qs);var v=this.dispatcher.dispatchStrictIf(l);return this.popContextTransition(r.env,v);case Lu.Name:var T=r.locals;return Il.unVisit(T,void 0,this.visitedNameMap),this.popContextTransition(r.env,e);case Lu.Let:var h=n.data,S=e,g=r.env;return this.popContextTransition(sl(h,S,g),n.children[1]);case Lu.Array:var A=this.dispatcher.dereferenceOper(e,mc),N=n.data,C=N.rows,O=N.cols,m=r.holeIndex,D=m%O,L=O===D+1,M=(m-D)/O,_=r.locals;if(_[M][D]=this.dispatcher.coerceOper(A,mc),C===M+1&&L)return this.popContextTransition(r.env,Of(C,O,_));var y=L?M+1:M,F=L?0:D+1;return this.nextHoleTransition(r,n.children[y][F]);default:return I("calc.runtime.FormulaEvaluationMachine.applyContinuation",n)}},r.prototype.reduceFormula=function(e){switch(e.kind){case Lu.CellRef:return this.updateTermTransition(this.evalCellRefTerm(this.locals,e));case Lu.App:var r=e.data.funName;if(!Uu(r)){var n=this.context.globals.getFirstOrderFunc(ku(r));if(n.kind===Mf.Failure)return vl(n.reason)}if(0===e.children.length){var t=this.dispatcher.dispatchFunction(r,e.data.funType,[]);return"object"==typeof t&&t.kind===Eu.WorksheetFunction?this.evaluateFunctionTransition(t,void 0):this.updateTermTransition(t)}return this.pushContextTransition(e,e.children[0],[]);case Lu.If:case Lu.Let:return this.pushContextTransition(e,e.children[0],void 0);case Lu.Name:var a=this.evalName(this.locals,e.data.qualifier,e.data.whole,this.visitedNameMap);return void 0!==a[0]?this.pushContextTransition(e,a[1],a[0]):this.updateTermTransition(a[1]);case Lu.Ident:var o=fl(e.data,this.env);if(null==o){var i="undefined local "+e.data;Mc("calc.runtime.FormulaEvaluationMachine.reduceFormula",gf.NAME,i)}return this.updateTermTransition(void 0===o?Af:o);case Lu.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map(function(){return[]}));case Lu.Fun:return this.performReturnTransition(yf(tc(["Step: FunNode to closure"])));default:return I("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},r.prototype.pushContextTransition=function(e,r,n){var t=function(e,r,n){return{context:e,holeIndex:0,env:r,locals:n}}(e,this.env,n);return this.continuation[this.continuation.length]=t,this.updateTermTransition(r)},r.prototype.popContextTransition=function(e,r){return this.env=e,this.continuation.pop(),this.updateTermTransition(r)},r.prototype.evaluateFunctionTransition=function(e,r){void 0!==r&&(this.env=r,this.continuation.pop());var n=this.context.createFunctionEvaluationMachine(this.context,e);return this.performCallTransition(n)},r.prototype.nextHoleTransition=function(e,r){return e.holeIndex+=1,this.env=e.env,this.updateTermTransition(r)},r.prototype.updateTermTransition=function(e){return this.term=e,this.performDefaultTransition()},r.prototype.evalDocumentQualifier=function(e){var r=this.context.globals.getDocumentLoc(e.path,e.document);return null!=r?r:sf.Document},r.prototype.getSheetIndex=function(e,r){var n=this.context.globals.getSheetIndex(e,r);return n.kind===Mf.Failure?vl(n.reason):null==n.value?void 0:n.value},r.prototype.evalSheetQualifier=function(e,r){var n=null==r.document?e.range.sheet.document:this.evalDocumentQualifier(r.document);if("string"==typeof n)return n;var t=this.getSheetIndex(n,r.sheet);return null==t?sf.Sheet:pf(n,t)},r.prototype.evalNameQualifier=function(e,r){var n;switch(r.kind){case Rf.Document:return"string"!=typeof(n=this.evalDocumentQualifier(r))?df(n):n;case Rf.Sheet:return this.evalSheetQualifier(e,r);case Rf.Ident:n=e.range.sheet.document;var t=this.getSheetIndex(n,r.name);return null!=t?pf(n,t):"string"!=typeof(n=this.evalDocumentQualifier(hf(r.name)))?df(n):sf.Ident;default:return I("calc.runtime.FormulaEvaluationMachine.evalNameQualifier",r)}},r.prototype.getNameFormulaAsTerm=function(e,r){e.precedents.names.push(r);var n=this.context.globals.getNameFormula(r);if(n.kind===Mf.Failure)return vl(n.reason);var t=n.value;return null!=t?Zc("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",t):void 0},r.prototype.checkNameCycle=function(e,r,n){return void 0!==Il.lookup(e,n)?vl(vc(Il.runFrom(e,n))):(Il.visit(e,!0,n),[e,r])},r.prototype.checkForNameCycle=function(e,r){if(void 0!==Il.lookup(e,r))return vl(vc(Il.runFrom(e,r)));Il.visit(e,!0,r)},r.prototype.evalName=function(e,r,n,t){if(Nr(Sr.CalcUnifyRangeResolutionCode)){var a=Ff(e.range),o=this.context.resolver.resolveName(a,r,n);return this.nameEvaluator(r,o)}if(null==r||r.kind===Rf.Relative){var i=e.range.sheet,u=Ef(i,n);if(null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);if(u=Ef(df(i.document),n),null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);var c="name resolution; qualifier = "+E(r);return Mc("calc.runtime.FormulaEvaluationMachine.evalName",gf.NAME,c),[void 0,Af]}var l=this.evalNameQualifier(e,r);if("string"!=typeof l){var s;u=Ef(l,n);if(null!=(s=this.getNameFormulaAsTerm(e,u)))return this.checkNameCycle(u,s,t);var f=null==l.index?"document":"sheet",d="name resolution, qualifier = "+E(r)+", resolved to "+f;return Mc("calc.runtime.FormulaEvaluationMachine.evalName",gf.NAME,d),[void 0,Af]}var p="qualifier resolution, qualifier = "+E(r)+", failed on "+l;return Mc("calc.runtime.FormulaEvaluationMachine.evalname",gf.NAME,p),[void 0,Af]},r.prototype.evalPos=function(e,r){return r.kind===Sf.Abs?r.index:e+r.index},r.prototype.evalCellRefSingle=function(e,r){return Tf(this.evalPos(e.row,r.row),this.evalPos(e.col,r.col))},r.prototype.evalCellRef=function(e,r){var n=e.range.range;switch(r.kind){case If.Error:return;case If.Single:var t=this.evalCellRefSingle(n,r);return Lf(t,t);case If.Range:var a=this.evalCellRefSingle(n,r.ref1),o=this.evalCellRefSingle(n,r.ref2);return Lf(a,o);case If.Row:return vl(tc(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]));case If.Col:return vl(tc(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]))}},r.prototype.evalCellRefTerm=function(e,r){if(Nr(Sr.CalcUnifyRangeResolutionCode)){var n=Ff(this.locals.range),t=this.context.resolver.resolveCellRef(n,r.data.qualifier,r.data.ref);return this.cellEvaluator(r,t)}var a=e.range.sheet.document,o=r.data.qualifier,i=this.evalCellRef(e,r.data.ref);if(null==i){var u="error ref, qualifier = "+E(o);return Mc("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",gf.REF,u),Nf}if(null!=o&&o.kind===Rf.Error){u="qualifier resolution, qualifier = "+E(o);return Mc("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",gf.REF,u),Nf}if(null!=o&&o.kind===Rf.SheetRange){var c=this.getSheetIndex(a,o.sheet1);if(null==c){u="qualifier resolution, qualifier = "+E(o)+", sheet 1";return Mc("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",gf.REF,u),Nf}var l=this.getSheetIndex(a,o.sheet2);if(null==l){u="qualifier resolution, qualifier = "+E(o)+", sheet 2";return Mc("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",gf.REF,u),Nf}if(c===l)return Df(pf(a,c),[i]);var s=vf(a,Math.min(c,l),Math.abs(l-c)+1);return mf(s,i)}var f=null==o||o.kind===Rf.Relative?e.range.sheet:this.evalSheetQualifier(e,o);if("string"==typeof f){u="qualifier resolution, qualifier = "+E(o)+", failed on "+f;return Mc("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",gf.REF,u),Nf}return Df(f,[i])},r}(Sl);function wf(e,r,n){return R.ULS.traceTag(595964230,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"calc.runtime.evalFormula.createFormulaEvaluationMachine: Creating formula evaluator."),new Bf(e,r,n)}function Gf(e,r,n,t){var a=lf(e),o=wf(a.machineContext,r,n);return function e(r,n){var t=r.evaluate(n);return t instanceof Array?t[0]:Sc(function(t){return e(r,"number"==typeof t?t:n)})}(new ff(a,[o]),t)}var Vf=Xr.SpecialPrecs,xf=Xr.precedents;function Wf(e){var r=gl.newVisitedMap();return{evalFormula:function(n,t,a,o){var i=hl(n,t,xf([],[],Vf.None,!0),r);return Gf(e,i,a,o)},evalCells:function(r){return Gl(e,r)},evalCellsAsync:function(r){return function(e,r){if(0===r.length)return Promise.resolve([]);for(var n=lf(e),t=[],a=0;a<r.length;a+=1)t.push(wl(n.machineContext,r[a]));var o=new ff(n,t),i=of(e.schedulerInfo);return o.evaluateAsync(i)}(e,r)}}}var Hf=Xr.OperKind,Kf=Xr.valueErrorOper,Xf=Xr.div0ErrorOper,Qf=Yr.OperatorId,Yf=Jr.isSheetIndex,Jf=32767;function jf(e){if("object"!=typeof e)return"number"==typeof e?e:void 0;switch(e.kind){case Hf.Error:return e;case Hf.Missing:case Hf.Blank:case Hf.Rich:return;default:return I("calc.funcs.arithmeticOperationCoerce",e)}}function qf(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(Qf.Concat,function(r){return e.coerceOper(r,Hf.String)}),function(e){return e},n);if(null==t){var a="calc.funcs.concat: returned undefined; args = "+E(r);return R.ULS.assertTag(595969627,c.LogCategory.msoulscat_ES_EWAJS,!1,a)}return"string"==typeof t&&t.length>Jf?Xr.valueErrorOper:t}function zf(e){return"object"==typeof e&&e.kind===Hf.Blank?1:0}function Zf(e){return function(r){if("boolean"==typeof r)return r;if("number"==typeof r)return e.coerceOper(r,Hf.Boolean);if("string"!=typeof r)switch(r.kind){case Hf.Error:return r;case Hf.Missing:case Hf.Blank:case Hf.Rich:return;default:return I("funcs.aggregationFuncs: booleanOperationCoerce",r)}}}function $f(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(Qf.And),Zf(e),n);return null==t?Kf:t}function ed(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(Qf.Or),Zf(e),n);return null==t?Kf:t}function rd(e){return function(r,n){return e(r)(n[0])}}function nd(e){return function(r,n){return e(r)(n[0],n[1])}}var td=Xr.numErrorOper,ad=Xr.div0ErrorOper,od=180/Math.PI,id=Math.PI/180;function ud(e,r){return Math.PI}var cd=rd(function(e){return e.getMathpack().sqrt}),ld=rd(function(e){return e.getMathpack().exp}),sd=nd(function(e){return e.getMathpack().power}),fd=rd(function(e){return e.getMathpack().ln}),dd=rd(function(e){return e.getMathpack().log10});function Ed(e,r){var n=r[0],t=r.length<2?10:r[1];return e.getMathpack().log(n,t)}var pd=rd(function(e){return e.getMathpack().sin}),vd=rd(function(e){return e.getMathpack().cos}),Td=rd(function(e){return e.getMathpack().tan}),hd=rd(function(e){return e.getMathpack().asin}),Rd=rd(function(e){return e.getMathpack().acos}),Sd=rd(function(e){return e.getMathpack().atan}),Id=nd(function(e){return e.getMathpack().atan2});function gd(e,r){var n=r,t=n[0],a=n[1],o=Math.pow(10,Math.ceil(a));return t<0?-Math.round(-t*o)/o:Math.round(t*o)/o}function Ad(e,r){var n=r,t=n[0],a=n[1],o=Math.pow(10,a<0?-Math.floor(-a):Math.floor(a));return t<0?-Math.ceil(-t*o)/o:Math.ceil(t*o)/o}function Nd(e,r){var n=r,t=n[0],a=n[1],o=Math.pow(10,a<0?-Math.floor(-a):Math.floor(a));return t<0?-Math.floor(-t*o)/o:Math.floor(t*o)/o}function Cd(e,r){var n=r,t=n[0],a=n[1];return 0===a?0:a<0&&t>0?td:a*Math.ceil(t/a)}function Od(e,r){var n=r,t=n[0],a=n[1];return 0===a?0===t?0:ad:a<0&&t>0?td:a*Math.floor(t/a)}function md(e,r){var n=r[0];return 2*(n<0?Math.floor(n/2):Math.ceil(n/2))}function Dd(e,r){var n=r[0];return Math.abs(n)}function Ld(e,r){var n=r[0];return n>0?1:0===n?0:n<0?-1:td}function Md(e,r){return r[0]*od}function _d(e,r){return r[0]*id}function yd(e,r){var n=r[0];if(Jr.operKind(n)===Xr.OperKind.Range){var t=n.sheets,a=n.ranges[0];if(1!==t.length||1!==a.rows||1!==a.cols)return Xr.valueErrorOper;n=e.dereferenceOper(n,Xr.OperKind.Number)}switch(Jr.operKind(n)===Xr.OperKind.String&&(n=e.coerceOper(n,Xr.OperKind.Number)),Jr.operKind(n)){case Xr.OperKind.Number:return 0==(1&Math.floor(Math.abs(n)));case Xr.OperKind.Error:return n;case Xr.OperKind.Missing:return Xr.naErrorOper;case Xr.OperKind.Blank:return!0;default:return Xr.valueErrorOper}}var Fd=Xr.valueErrorOper;function kd(e){return[e[0],Math.floor(e.length>1?e[1]:1)]}function Ud(e,r){var n=kd(r),t=n[0],a=n[1];return a<0?Fd:a>=t.length?t:t.substr(t.length-a,a)}function Pd(e,r){var n=kd(r),t=n[0],a=n[1];return a<0?Fd:a>=t.length?t:t.substr(0,a)}function bd(e,r){var n=r[0],t=r[1]-1,a=Math.floor(r[2]);return t<0||a<0?Fd:n.substr(t,a)}var Bd={};Bd[Yr.WorksheetFuncId.SUM]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(Qf.Add),jf,n);return null==t?0:t},Bd[Yr.WorksheetFuncId.PRODUCT]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.reduceDerefOpers(e.makeOperatorReducer(Qf.Mul),jf,n);return null==t?0:t},Bd[Yr.WorksheetFuncId.AVERAGE]=function(e,r){var n=e.makeOperatorReducer(Qf.Add),t=e.dereferenceAllOpers(r),a=e.reduceDerefOpers(n,jf,t),o=e.reduceDerefOpers(n,function(e){return function(r){if(null!=e(r))return 1}}(jf),t);if(null!=a&&null!=o)return e.getBinaryOperator(Qf.Div)(a,o);if(null==a&&null==o)return Xf;var i="calc.funcs.average: (sumOper == null) !== (countOper == null); args = "+E(r);return R.ULS.assertTag(595980871,c.LogCategory.msoulscat_ES_EWAJS,!1,i)},Bd[Yr.WorksheetFuncId.CONCAT]=qf,Bd[Yr.WorksheetFuncId.CONCATENATE]=qf,Bd[Yr.WorksheetFuncId.COUNTBLANK]=function(e,r){var n=r[0];if("object"!=typeof n||n.kind!==Hf.Range||!Yf(n.sheets)||1!==n.ranges.length)return Kf;var t=e.dereferenceAllOpers(r),a=e.makeOperatorReducer(Qf.Add),o=e.reduceDerefOpers(a,zf,t);return null==o?0:o},Bd[Yr.WorksheetFuncId.MAX]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.makeBranchOperatorReducer(Qf.Gt,function(e){return!1}),a=e.reduceDerefOpers(t,jf,n);return null==a?0:a},Bd[Yr.WorksheetFuncId.MIN]=function(e,r){var n=e.dereferenceAllOpers(r),t=e.makeBranchOperatorReducer(Qf.Lt,function(e){return!1}),a=e.reduceDerefOpers(t,jf,n);return null==a?0:a},Bd[Yr.WorksheetFuncId.ISERROR]=function(e,r){return Jr.operKind(r[0])===Xr.OperKind.Error},Bd[Yr.WorksheetFuncId.ISERR]=function(e,r){var n=r[0];return Jr.operKind(n)===Xr.OperKind.Error&&n.type!==Xr.ErrorType.NA},Bd[Yr.WorksheetFuncId.ISBLANK]=function(e,r){return Jr.operKind(r[0])===Xr.OperKind.Blank},Bd[Yr.WorksheetFuncId.ISLOGICAL]=function(e,r){return Jr.operKind(r[0])===Xr.OperKind.Boolean},Bd[Yr.WorksheetFuncId.ISNA]=function(e,r){var n=r[0];return Jr.operKind(n)===Xr.OperKind.Error&&n.type===Xr.ErrorType.NA},Bd[Yr.WorksheetFuncId.ISNONTEXT]=function(e,r){return Jr.operKind(r[0])!==Xr.OperKind.String},Bd[Yr.WorksheetFuncId.ISTEXT]=function(e,r){return Jr.operKind(r[0])===Xr.OperKind.String},Bd[Yr.WorksheetFuncId.ISNUMBER]=function(e,r){return Jr.operKind(r[0])===Xr.OperKind.Number},Bd[Yr.WorksheetFuncId.ISREF]=function(e,r){return Jr.operKind(r[0])===Xr.OperKind.Range},Bd[Yr.WorksheetFuncId.ISEVEN]=yd,Bd[Yr.WorksheetFuncId.ISODD]=function(e,r){var n=yd(e,r);return Jr.operKind(n)===Xr.OperKind.Boolean?!n:n};var wd,Gd=!1;function Vd(e){return Gd||(Gd=!0,Nr(Sr.CalcNewFunctions)&&(Bd[Yr.WorksheetFuncId.AND]=$f,Bd[Yr.WorksheetFuncId.OR]=ed,Bd[Yr.WorksheetFuncId.ABS]=Dd,Bd[Yr.WorksheetFuncId.CEILING]=Cd,Bd[Yr.WorksheetFuncId.DEGREES]=Md,Bd[Yr.WorksheetFuncId.FLOOR]=Od,Bd[Yr.WorksheetFuncId.RADIANS]=_d,Bd[Yr.WorksheetFuncId.ROUND]=gd,Bd[Yr.WorksheetFuncId.ROUNDUP]=Ad,Bd[Yr.WorksheetFuncId.ROUNDDOWN]=Nd,Bd[Yr.WorksheetFuncId.EVEN]=md,Bd[Yr.WorksheetFuncId.SIGN]=Ld,Bd[Yr.WorksheetFuncId.PI]=ud,Bd[Yr.WorksheetFuncId.SQRT]=cd,Bd[Yr.WorksheetFuncId.EXP]=ld,Bd[Yr.WorksheetFuncId.POWER]=sd,Bd[Yr.WorksheetFuncId.LN]=fd,Bd[Yr.WorksheetFuncId.LOG10]=dd,Bd[Yr.WorksheetFuncId.LOG]=Ed,Bd[Yr.WorksheetFuncId.SIN]=pd,Bd[Yr.WorksheetFuncId.COS]=vd,Bd[Yr.WorksheetFuncId.TAN]=Td,Bd[Yr.WorksheetFuncId.ASIN]=hd,Bd[Yr.WorksheetFuncId.ACOS]=Rd,Bd[Yr.WorksheetFuncId.ATAN]=Sd,Bd[Yr.WorksheetFuncId.ATAN2]=Id,Bd[Yr.WorksheetFuncId.LEFT]=Pd,Bd[Yr.WorksheetFuncId.RIGHT]=Ud,Bd[Yr.WorksheetFuncId.MID]=bd)),Bd[e]}function xd(e){if(null==e)return"";var r,n=Rr(e.sheet.document);n===O?r="illegalDocument":r=(null==n.path?"":"p:"+n.path.toLocaleUpperCase()+",")+"n:"+n.name.toLocaleUpperCase();return r+",i:"+e.sheet.index+",r:"+e.range.row+",c:"+e.range.col}!function(e){e.DerefOperKind=pu,e.FuncKind=Eu}(wd||(wd={}));var Wd=Jr.createResolutionHandler,Hd=Jr.createNameFinder;function Kd(e,r){return void 0===e&&void 0===r||void 0!==e&&void 0!==r&&Xd(e.name,r.name)&&Xd(e.path,r.path)}function Xd(e,r){return null==e&&null==r||null!=e&&null!=r&&e.toLocaleUpperCase()===r.toLocaleUpperCase()}function Qd(e,r,n,t){var a=function(e,r){if(void 0===e){var n=r.getCurrentDocumentLoc(),t=r.getCurrentSheetIndex();if(null==n||null==t)return;return M(n,t)}switch(e.kind){case ie.Error:return;case ie.Relative:var n=r.getCurrentDocumentLoc(),t=r.getCurrentSheetIndex();if(null==n||null==t)return;return M(n,t);case ie.Sheet:var a=void 0!==e.document?m(e.document.path,e.document.document):r.getCurrentDocumentLoc();if(null==a)return;var o=r.getSheetIndex(a,e.sheet);if(null==o)return;return M(a,o);case ie.SheetRange:if(null==(a=r.getCurrentDocumentLoc()))return;var i=r.getSheetIndex(a,e.sheet1),u=r.getSheetIndex(a,e.sheet2);if(null==i||null==u)return;return i===u?M(a,i):L(a,Math.min(i,u),Math.abs(i-u)+1);default:return I("calc.calc.qualifierToSheet",e)}}(e.qualifier,n);if(void 0!==a)if(Kd(r.sheet.document,a.document)||(t.crossDocRefs+=1),rr(a))switch(a.index!==r.sheet.index&&(t.crossSheetRefs+=1),e.ref.kind){case ue.Error:return void(t.errRefs+=1);case ue.Col:return void(t.columnRefs+=1);case ue.Row:return void(t.rowRefs+=1);case ue.Range:var o=ur(Yd(e.ref.ref1,r),Yd(e.ref.ref2,r));return n.maxRangeSize>0&&Gc(o)>n.maxRangeSize?void(t.largeRanges+=1):x(a,o);case ue.Single:var i=Yd(e.ref,r);return W(a,i);default:return I("calc.calc.cellRefToGridLoc",e.ref)}else t.crossSheetRefs+=1;else t.errRefs+=1}function Yd(e,r){return F(Jd(e.row,r.range.row),Jd(e.col,r.range.col))}function Jd(e,r){switch(e.kind){case ce.Abs:return e.index;case ce.Rel:return e.index+r}}function jd(e,r){var n=void 0;if(void 0===e.qualifier){var t=r.getCurrentDocumentLoc(),a=r.getCurrentSheetIndex();if(null==t||null==a)return;n=M(t,a)}else switch(e.qualifier.kind){case ie.Document:n=H(m(e.qualifier.path,e.qualifier.document));break;case ie.Relative:t=r.getCurrentDocumentLoc(),a=r.getCurrentSheetIndex();if(null==t||null==a)return;n=M(t,a);break;case ie.Ident:var o=r.getCurrentDocumentLoc();if(null==o)return;var i=r.getSheetIndex(o,e.qualifier.name);n=null==i?H(m(void 0,e.qualifier.name)):M(o,i);break;case ie.Sheet:if(null==(o=void 0!==e.qualifier.document?m(e.qualifier.document.path,e.qualifier.document.document):r.getCurrentDocumentLoc()))return;if(null==(i=r.getSheetIndex(o,e.qualifier.sheet)))return;n=M(o,i);break;default:return I("calc.calc.nameNodeToNameLoc",e.qualifier)}return K(n,e.whole)}function qd(e,r){switch(r.ref.kind){case ue.Error:e.errRefs+=1;break;case ue.Col:e.columnRefs+=1;break;case ue.Row:e.rowRefs+=1}}function zd(e,r){var n=r[e];return void 0===n&&(n=0),n}function Zd(e,r){var n=r[e];return void 0===n&&(n=0),n}function $d(){var e={columnRefs:0,crossDocRefs:0,crossSheetRefs:0,dependents:[],errRefs:0,functionsCount:mr(),largeRanges:0,nameRefs:0,operatorsCount:{},parserErrors:0,rowRefs:0,tableRefs:0,merge:function(r){e.columnRefs+=r.columnRefs,e.crossDocRefs+=r.crossDocRefs,e.crossSheetRefs+=r.crossSheetRefs,e.largeRanges+=r.largeRanges,e.nameRefs+=r.nameRefs,e.parserErrors+=r.parserErrors,e.rowRefs+=r.rowRefs,e.tableRefs+=r.tableRefs,e.errRefs+=r.errRefs,function(e,r){var n=mr();e.forEach(function(e){n[xd(e)]=!0}),r.forEach(function(r){var t=xd(r);n[t]||(e.push(r),n[t]=!0)})}(e.dependents,r.dependents),Object.keys(r.functionsCount).forEach(function(n){var t=e.functionsCount[n];void 0===t&&(t=0),e.functionsCount[n]=t+r.functionsCount[n]}),Object.keys(r.operatorsCount).forEach(function(n){var t=Number(n),a=e.operatorsCount[t];void 0===a&&(a=0),e.operatorsCount[t]=a+r.operatorsCount[t]})}};return e}function eE(e){var r={_logger:e,_dependencyGraph:mr(),haveDependents:function(e){return void 0!==r._dependencyGraph[xd(e)]},directDependents:function(e){var n=[],t=r._dependencyGraph[xd(e)];return void 0!==t&&t.forEach(function(e){n.push(e)}),n},allDependents:function(e){return r.getDependents(e,!1)},rootDependents:function(e){return r.getDependents(e,!0)},reset:function(){r._dependencyGraph=mr()},add:function(e,n,t){var a=In({},e);a.getCurrentDocumentLoc=function(){return Rr(e.getCurrentDocumentLoc())};var o=$d();if(null==t)return o;var i=void 0,u=void 0;Nr(Sr.CalcUnifyRangeResolutionCode)&&(i=function(e,r,n,t){return Wd(Hd(function(a){var o=r.nameRefToSheetGridRange(e,a);return null==o?o:(n.addDependency(o,e,r.maxRangeSize,t),o)},void 0),Or,function(){})}(n,a,r,o),u=function(e,r,n,t){return Wd(function(a){rr(a.sheet)||(t.crossSheetRefs+=1),Kd(e.sheet.document,a.sheet.document)||(t.crossDocRefs+=1),a.sheet.index!==e.sheet.index&&(t.crossSheetRefs+=1),tr(a)&&n.addDependency(a,e,r.maxRangeSize,t)},function(e){return qd(t,e)},function(e,r){e.kind===Ve.NotImplemented?qd(t,r):t.errRefs+=1})}(n,a,r,o));var l=[];for(l.push(t.node);l.length>0;){var s=l.pop();if(null!=s)switch(s.kind){case le.Literal:break;case le.Array:s.nodes.map(function(e){return e.map(function(e){l.push(e)})});break;case le.App:if("object"==typeof s.head){var f=s.head;switch(f.kind){case le.Operator:o.operatorsCount[f.id]=Zd(f.id,o.operatorsCount)+1;break;case le.Name:o.functionsCount[f.whole]=zd(f.whole,o.functionsCount)+1;break;default:l.push(f)}}s.args.map(function(e){l.push(e)});break;case le.Paren:l.push(s.node);break;case le.Name:if(o.nameRefs+=1,Nr(Sr.CalcUnifyRangeResolutionCode)&&void 0!==i)i(void 0,a.resolver.resolveName(n,s.qualifier,s.whole));else if(void 0===i){var d=jd(s,a);if(void 0!==d)null!=(E=a.nameRefToSheetGridRange(n,d))&&r.addDependency(E,n,a.maxRangeSize,o)}else R.ULS.traceTag(595952269,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Error,"Unreachable code hit: nameMapper should never be defined when Resolution BRS is off");break;case le.CellRef:if(Nr(Sr.CalcUnifyRangeResolutionCode)&&void 0!==u)u(s,a.resolver.resolveCellRef(n,s.qualifier,s.ref));else if(void 0===u){var E;void 0!==(E=Qd(s,n,a,o))&&r.addDependency(E,n,a.maxRangeSize,o)}else R.ULS.traceTag(595952270,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Error,"Unreachable code hit: cellMapper should never be defined when Resolution BRS is off");break;case le.Bad:o.parserErrors+=1;break;default:return I("calc.calc.recalcMapperImpl",s)}}return o},merge:function(e){r.mergeGraph(e.dependencyGraph())},dependencyGraph:function(){var e=eE(r._logger);return e.mergeGraph(r._dependencyGraph),e._dependencyGraph},mergeGraph:function(e){var n=function(n){var t=r._dependencyGraph[n],a=e[n];void 0===t&&(t=[]);var o=t,i=mr();o.forEach(function(e){i[xd(e)]=!0}),a.forEach(function(e){i[xd(e)]||o.push(e)}),r._dependencyGraph[n]=o};for(var t in e)n(t)},addDependency:function(e,n,t,a){if(ar(e)){var o=xd(e);r.updateDependency(o,n)&&a.dependents.push(e)}else if(Gc(e.range)>t)a.largeRanges+=1;else for(var i=e.range.row;i<e.range.row+e.range.rows;i+=1)for(var u=e.range.col;u<e.range.col+e.range.cols;u+=1){var c=W(e.sheet,F(i,u));r.addDependency(c,n,t,a)}},updateDependency:function(e,n){var t=r._dependencyGraph[e];return void 0===t&&(t=[]),!t.some(function(e){return function(e,r){return function(e,r){return e.document===r.document&&e.index===r.index}(e.sheet,r.sheet)&&function(e,r){return e.row===r.row&&e.col===r.col}(e.range,r.range)}(e,n)})&&(t.push(n),r._dependencyGraph[e]=t,!0)},getDependents:function(e,n){for(var t=mr(),a=[],o=r.directDependents(e);o.length>0;){var i=o.shift();if(void 0!==i){var u=xd(i);if(!t[u]){t[u]=!0;var c=r.directDependents(i);c.forEach(function(e){o.push(e)}),n&&0!==c.length||a.push(i)}}}return a},stats:function(){var e=Object.keys(r._dependencyGraph);if(void 0===e||0===e.length)return rE(0,0);var n=e.length,t=0;return e.forEach(function(e){var n=r._dependencyGraph[e];t+=n.length}),rE(n,t)}};return r}function rE(e,r){return{nodes:e,arcs:r}}var nE=Jr.createResolver,tE=Jr.success;function aE(e){return S(e),eE(e)}function oE(e,r,n,t,a,o,i,u,c,l){return{maxRangeSize:e,nameRefs:r,rowRefs:n,columnRefs:t,crossSheetRefs:a,crossDocRefs:o,getCurrentDocumentLoc:i,getCurrentSheetIndex:u,getSheetIndex:c,nameRefToSheetGridRange:l,resolver:nE({getSheetIndex:function(e,r){return tE(c(e,r))},getDocumentLoc:i})}}var iE=Kr.FormulaSource,uE=Kr.sheetGridCell,cE=Kr.gridCell,lE=Kr.documentLoc,sE=Kr.sheetIndex,fE=Qr.RefStyle,dE=Jr.ResultKind,EE=Jr.failure;function pE(e,r,n,t){return{getNumberFormatCategory:e,getCellFormat:r,knownFormats:n,formatValueTypes:t}}function vE(e,r,n){return{config:e,mathpack:r,formatInfo:n}}function TE(e){var r={globals:e,runtime:function(e){var r=e.config,n=e.mathpack,t={config:r},a=In({config:r},e.formatInfo),o={config:r,mathpack:n},i=fi(t),u=hu(a),c=el(o);return{parser:i,analyzer:u,compiler:c}}(e),cache:mr(),lazyCreateCacheItem:function(e){var n=xd(e),t=r.cache[n];return void 0===t&&(t=function(e,r){return{cell:e,rawValue:r,formula:void 0,compiledFormula:void 0,evalResult:void 0,format:void 0}}(e),r.cache[n]=t),t},size:function(){var e=0;for(var n in r.cache)e+=1;return e},clear:function(){r.cache=mr()},cells:function(){var e=Object.keys(r.cache);return void 0===e||0===e.length?[]:e.map(function(e){return r.cache[e].cell})},getItem:function(e){var n=xd(e);return r.cache[n]},getValue:function(e){var n=r.getItem(e);if(void 0!==n&&null!==n.rawValue)return n.rawValue},getFormula:function(e,n,t){var a=r.getItem(e);if(void 0!==a&&hE(r.runtime,a,n,t)&&RE(a.formula))return a.formula},getFormulaFormat:function(e){var n=r.getItem(e);if(void 0!==n)return n.format},getCompiledFormula:function(e,n){var t=r.getItem(e);if(void 0!==t&&function(e,r,n){if(RE(r.compiledFormula))return!0;if(!hE(e,r,n))return!1;if(void 0!==n&&n)return!1;r.compiledFormula=null;try{var t=e.compiler.compileFormula(r.cell,iE.Cell,r.formula);return t.kind===dE.Success&&(r.compiledFormula=t.value,!0)}catch(e){return R.ULS.traceTag(595968586,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Exception in formulaCache.lazyCompileFormula: "+E(e)),!1}}(r.runtime,t,n)&&RE(t.compiledFormula))return t.compiledFormula},getEvalResult:function(e){var n=r.getItem(e);if(void 0!==n)return n.evalResult},isEqualValue:function(e,n){var t=r.getItem(e);return void 0!==t&&t.rawValue===n},updateCellValue:function(e,n,t,a,o){if(!r.isEqualValue(e,n)){var i=r.lazyCreateCacheItem(e);if(i.rawValue=n,i.formula=void 0,i.compiledFormula=void 0,i.evalResult=void 0,i.format=void 0,null!=t){var u=t.getValue(e);void 0!==u&&n===u&&(i.formula=t.getFormula(e,!0),i.compiledFormula=t.getCompiledFormula(e,!0),i.evalResult=void 0,i.format=i.format)}null!=o&&(i.format=o),null!=a&&a.forEach(function(e){var n=r.getItem(e);void 0!==n&&(n.evalResult=void 0)})}},updateEvalResult:function(e,n,t){var a=r.lazyCreateCacheItem(e);a.evalResult=n,null!=t&&(a.format=t)},merge:function(e,n){e.cells().forEach(function(t){var a=e.getValue(t);void 0===a||!0!==n&&void 0!==r.getItem(t)||r.updateCellValue(t,a,e)})},parseCompileNameFormula:function(e,n,t){var a,o=void 0===t?fE.A1:t,i=iE.NameManager;if(void 0!==n)a=r.runtime.parser.parseFormula(o,n,i,e);else{var u=sE(lE(void 0,"Doc"),0),l=cE(0,0);a=r.runtime.parser.parseFormula(o,uE(u,l),i,e)}var s=E(e);if(a.kind!==dE.Success){var f="calc.formulaCache.parseCompileNameFormula: couldn't parse "+s;return R.ULS.traceTag(595969230,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,f),EE(On(f))}var d=r.runtime.analyzer.checkFormula(n,iE.NameManager,a.value);if(function(e){return e.isWellFormed}(d))return r.runtime.compiler.compileFormula(n,i,d);var p="calc.formulaCache.parseCompileNameFormula: formula "+s+" is not well-formed.";return R.ULS.traceTag(595969231,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,p),EE(cc(p))}};return r}function hE(e,r,n,t){if(RE(r.formula))return!0;if(!RE(r.rawValue))return!1;if(void 0!==r.formula&&null===r.formula)return!1;if(void 0!==n&&n)return!1;r.formula=null;var a=r.rawValue;try{var o=e.parser.parseFormula(Qr.RefStyle.A1,r.cell,iE.Cell,a);if(o.kind!==dE.Success)return!1;var i=e.analyzer.checkFormula(r.cell,iE.Cell,o.value,t);if(!i.isWellFormed)return!1;if(r.formula=i,Nr(Sr.CalcFormatCalculations)){var u=e.analyzer.findBestFormat(r.cell,iE.Cell,i);r.format=void 0===u?void 0:u.iformat}return!0}catch(e){return R.ULS.traceTag(595968585,c.LogCategory.msoulscat_ES_EWAJS,c.TraceLevel.Info,"Exception in formulaCache.lazyParseFormula: "+E(e)),!1}}function RE(e){return null!=e}n.d(r,"location",function(){return Kr}),n.d(r,"formula",function(){return Qr}),n.d(r,"value",function(){return Xr}),n.d(r,"signature",function(){return Yr}),n.d(r,"util",function(){return Jr}),n.d(r,"config",function(){return jr}),n.d(r,"parse",function(){return t}),n.d(r,"analyze",function(){return a}),n.d(r,"runtime",function(){return o}),n.d(r,"calc",function(){return i}),n.d(r,"funcs",function(){return u})}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map