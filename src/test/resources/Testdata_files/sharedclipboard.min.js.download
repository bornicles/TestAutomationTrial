var sharedClipboard=function(e){var r={};function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var i in e)t.d(n,i,function(r){return e[r]}.bind(null,i));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=4)}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(2);r.utils=n;var i=t(5);r.idbPromised=i;var o=t(1);r.ULS=o.ULS,r.TraceLevel=o.TraceLevel,r.LogCategory=o.LogCategory,r.NulLogger=o.NulLogger,r.ConsoleLogger=o.ConsoleLogger;var a=t(6);r.browserSupport=a;var s=t(7);r.perfWatch=s;var d=t(8);r.initEwaUtils=d.initEwaUtils,r.ewaUtils=d.ewaUtils;var c=t(9);r.initStopwatchFactory=c.initStopwatchFactory},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(r.TraceLevel||(r.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(r.LogCategory||(r.LogCategory={})),r.ULS={getFromExternalLogger:function(e){var r=e;return{ULS:{trace:function(e,t,n){return r.traceTag(0,e,t,n)},traceTag:function(e,t,n,i){return r.traceTag(e,t,n,i)},debugTrace:function(e,t,n){return r.debugTraceTag(0,e,t,n)},debugTraceTag:function(e,t,n,i){return r.debugTraceTag(e,t,n,i)},assert:function(e,t,n){return r.assertTag(0,e,t,n)},assertTag:function(e,t,n,i){return r.assertTag(e,t,n,i)},shipAssert:function(e,t,n){return r.shipAssertTag(0,e,t,n)},shipAssertTag:function(e,t,n,i){return r.shipAssertTag(e,t,n,i)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,r,t,n){console.assert(t,"shipAssertTag:",e,r,n)},e.prototype.assertTag=function(e,r,t,n){console.assert(t,"assertTag",e,r,n)},e.prototype.traceTag=function(e,r,t,n){console.log("traceTag",e,n,r,t)},e.prototype.debugTraceTag=function(e,r,t,n){console.log("debugTraceTag",e,n,r,t)},e}();r.ConsoleLogger=n;var i=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();r.NulLogger=i},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.forEachPromise=function(e,r,t){return e.reduce(function(e,n){return e.then(function(){return t&&t.stop?Promise.resolve(void 0):r(n,t)})},Promise.resolve(void 0))},r.defaultToJSONResultWhenStringifyFails="...",r.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(r,t){if(void 0===t&&(t=0),t<0||t>n)return r;if(null===r||void 0===r||"object"!=typeof r)return r;var i={};Object.getOwnPropertyNames(r).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(i[e]=r[e])});var o=Object.getPrototypeOf(r);o&&"object"==typeof o&&Object.keys(o).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(i[e]=r[e])});var a={};return Object.keys(i).forEach(function(r){a[r]=e(i[r],t+1)}),a}(e))}catch(e){return r.defaultToJSONResultWhenStringifyFails}};var n=5;var i="_",o=new RegExp("\\W+","g");r.getPerfWatchMarkName=function(e){if(!e)return"";var r=e.trim().substring(0,200).trim().replace(o,i).substring(0,80);return r&&r.length>0&&r.substr(r.length-1,1)===i&&(r=r.substr(0,r.length-1)),r&&r.length>0&&r.substr(0,1)===i&&(r=r.substr(1)),r},r.retry=function(e,r){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(r<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+r));for(var t=Promise.reject(void 0),n=function(r){t=t.catch(function(t){return e(r,t)})},i=1;i<=r;i+=1)n(i);return t}},function(e,r,t){"use strict";var n={};t.r(n),t.d(n,"sharedClipboardSettingsVariableName",function(){return z}),t.d(n,"defaultPromiseTimeoutInMinutes",function(){return K}),t.d(n,"getSharedClipboardSettings",function(){return Q}),t.d(n,"initializeSharedClipboardSettingsFromWindow",function(){return $}),t.d(n,"initializeSharedClipboardSettings",function(){return X}),t.d(n,"createEmptySharedClipboardSettings",function(){return Z});var i,o=t(0);function a(){return i}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var s=function(e,r){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};function d(e,r){function t(){this.constructor=e}s(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var c,u,l,p,g,f="";!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.SystemClipboardAndIndexedDB=1]="SystemClipboardAndIndexedDB",e[e.IndexedDB=2]="IndexedDB",e[e.IndexedDBAndInMemory=3]="IndexedDBAndInMemory",e[e.InMemory=4]="InMemory"}(c||(c={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.IndexedDBSetClipboardItems=4]="IndexedDBSetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.IndexedDBGetClipboardItems=6]="IndexedDBGetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.SelectClipboardStrategy=14]="SelectClipboardStrategy",e[e.IndexedDBProviderNotSupported=15]="IndexedDBProviderNotSupported",e[e.IndexedDBCacheInitialization=16]="IndexedDBCacheInitialization",e[e.IndexedDBGetCache=17]="IndexedDBGetCache",e[e.IndexedDBDeleteDb=18]="IndexedDBDeleteDb",e[e.IndexedDBSetItem=19]="IndexedDBSetItem",e[e.IndexedDBGetItem=20]="IndexedDBGetItem",e[e.IndexedDBGetAllKeys=21]="IndexedDBGetAllKeys",e[e.IndexedDBGetAllItems=22]="IndexedDBGetAllItems",e[e.IndexedDBRemoveItem=23]="IndexedDBRemoveItem",e[e.IndexedDBRemoveAllItems=24]="IndexedDBRemoveAllItems",e[e.IndexedDBClearAll=25]="IndexedDBClearAll",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IndexedDBCacheInitializationTimeout=30]="IndexedDBCacheInitializationTimeout",e[e.IndexedDBSetTimeout=31]="IndexedDBSetTimeout",e[e.IndexedDBGetTimeout=32]="IndexedDBGetTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy"}(l||(l={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste"}(p||(p={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(g||(g={}));var m=function(e){function r(t,n,i){var s=this,d=r.augmentParameterValue(t);if(s=e.call(this,d)||this,r.augmentParameterValue(n).length>0?a().ULS.traceTag(596456211,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Error '"+n+"': "+d):a().ULS.traceTag(596456212,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Error message: "+d),i){s.innerError=i;var c=i.message;c||(c=i.name);var u=r.augmentParameterValue(c);u.length>0&&a().ULS.traceTag(596456213,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Inner error message: "+u)}return s.name=r.augmentParameterValue(n),s.stack||(s.stack=(new Error).stack),s}return d(r,e),r.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():f},r}(Error),h=function(e){function r(t,n,i){var o=this,a=m.augmentParameterValue(n),s=r.getDefaultMessage(a),d=m.augmentParameterValue(t);return 0===d.length&&(d=s),(o=e.call(this,d,"MissingArgumentError",i)||this).name=a,o}return d(r,e),r.getDefaultMessage=function(e){var r="Missing argument";return e.length>0&&(r="Missing argument: '"+e+"'"),r},r}(m),b=function(e){function r(t,n,i,o){var a=this,s=m.augmentParameterValue(n),d=i;d||(d=f);var c=r.getDefaultMessage(s,d),u=m.augmentParameterValue(t);return 0===t.length&&(u=c),(a=e.call(this,u,"InvalidArgumentError",o)||this).name=s,a.value=d,a}return d(r,e),r.getDefaultMessage=function(e,r){return e.length>0?"Invalid '"+e+"' argument: '"+r+"'":"Invalid argument"},r}(m),v=function(e){function r(r,t){return e.call(this,r,"InvalidOperationError",t)||this}return d(r,e),r}(m);(function(e){function r(r,t){return e.call(this,r,"UnsupportedError",t)||this}d(r,e)})(m),function(e){function r(r,t){return e.call(this,r,"UnexpectedError",t)||this}d(r,e)}(m);function S(e,r){return function(e,r){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(r).length/2}(e,r)?r[e]:f}var w=function(e){function r(r,t,n,i,o){var a=e.call(this,t||"reason="+r,n,i)||this;return a.reason=r,a.reasonName=o,a}return d(r,e),r}(m),C=(function(e){function r(r,t,n){return e.call(this,r,t,"CopyError",n,S(r,l))||this}d(r,e)}(w),function(e){function r(r,t,n){return e.call(this,r,t,"PasteError",n,S(r,p))||this}d(r,e)}(w),function(e){function r(r,t,n){return e.call(this,r,t,"CancelError",n,S(r,g))||this}d(r,e)}(w),function(e){function r(r,t,n){return e.call(this,r,t,"ClipboardPlatformError",n,S(r,u))||this}return d(r,e),r}(w));!function(e){function r(r,t,n){return e.call(this,r,t,"SharedClipboardError",n,S(r,u))||this}d(r,e)}(w);function y(){return _}var _={userAgent:function(){return window&&window.navigator?window.navigator.userAgent:f},appVersion:function(){return window&&window.navigator?window.navigator.appVersion:f}},E={};new RegExp("(\\bTrident/| MSIE )");var I=16.16299,T=17.17123,L=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function P(){if(void 0===E.isEdgeProperty){E.isEdgeProperty=!1,E.isEdgeWithTextHtmlClipboardSupportProperty=!1,E.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;var e=y();if(e&&e.appVersion&&"function"==typeof e.appVersion){var r=e.appVersion();if(r){var t=r.match(L);if(t&&2===t.length){E.isEdgeProperty=!0;var n=Number(t[1]);isNaN(n)||(n>=I&&(E.isEdgeWithTextHtmlClipboardSupportProperty=!0),n>=T&&(E.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return E.isEdgeProperty}var D={postMessage:function(e,r,t,n){e.postMessage(r,t,n)}},A="text/plain",W="text/html";1..toString();var x,M,F=function(){var e={items:{}};return{getData:function(){return e},getItem:function(e){},setItem:function(e,r){throw new v("Cannot set an item with clipboard data format '"+e+"' in an immutable empty clipboard (content is "+(r&&r.length>0?"not ":f)+"empty)")},get:function(){return N(void 0)}}}();function U(e){return e&&e.items?Object.keys(e.items).length:0}function R(e){return U(e&&e.getData())}function j(e){void 0===e&&(e=void 0);var r=e;return r||(r={items:{}}),{getItem:function(e){return B(r,e)},setItem:function(e,t){!function(e,r,t){if(!e)throw new h(f,"clipboardItemsData");if(!e.items)throw new b(f,"clipboardItemsData.items");e.items[r]=t}(r,e,t)},getData:function(){return r},get:function(){return N(r)}}}function B(e,r){if(!e)throw new h(f,"clipboardItemsData");if(!e.items)throw new b(f,"clipboardItemsData.items");return e.items[r]}function O(e,r){if(!e||0===e.length||!r||!r.trim())return f;var t=void 0;return e.forEach(function(e){e.clipboardDataFormat===r&&(t=e.data)}),t||f}function J(e){if(e){var r=H(e);if(r){var t=Number(r);if(t&&!isNaN(t))return t}}}function H(e){if(e)return B(e,"metadata/system-clipboard-data-ccp-timestamp")}function N(e){var r=[];if(0===U(e))return r;for(var t in e.items){var n=B(e,t);n||(n=f);var i={clipboardDataFormat:t,data:n};r.push(i)}return r}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.IndexedDB=1]="IndexedDB",e[e.InMemory=2]="InMemory"}(x||(x={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose"}(M||(M={}));var z="sharedClipboardSettings",k=Z(),V=!1,G=1,q=3600,K=2;function Q(){if(!V)throw new v("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return k}function $(){V=!1,function(){if(!(window&&z in window))return k=Z(),void(V=!0);var e=window[z];if(!e||"string"!=typeof e)return k=Z(),void(V=!0);Y(JSON.parse(e))}()}function X(e){V=!1,Y(e)}function Y(e){if(!e)throw new h(f,"sharedClipboardSettingsCandidate");var r=Z();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(r.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(r.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(r.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return k=r,void(V=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return a().ULS.traceTag(596124181,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),k=r,void(V=!0);r.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var t=r.sharedClipboardHostingApp,n=t.indexOf(ee);n>=0&&(t=t.substr(n+1));try{r.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(e){}if(!r.sharedClipboardHostingApps||!Array.isArray(r.sharedClipboardHostingApps)||0===r.sharedClipboardHostingApps.length||r.sharedClipboardHostingApps.some(function(e){return!e||!e.trim()}))return a().ULS.traceTag(596124182,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),r.sharedClipboardHostingApp=f,r.sharedClipboardHostingApps=[],k=r,void(V=!0);try{r.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(e){}if(!r.sharedClipboardHostingEnvironments||!Array.isArray(r.sharedClipboardHostingEnvironments)||0===r.sharedClipboardHostingEnvironments.length||r.sharedClipboardHostingEnvironments.some(function(e){return!e||!e.trim()}))return a().ULS.traceTag(596124183,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),r.sharedClipboardHostingApp=f,r.sharedClipboardHostingApps=[],r.sharedClipboardHostingEnvironments=[],k=r,void(V=!0);if(r.sharedClipboardHostingApps.indexOf(r.sharedClipboardHostingApp)<0){if(r.sharedClipboardHostingApp===t)return a().ULS.traceTag(596124184,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+r.sharedClipboardHostingApp+"' should be listed in sharedClipboardHostingApps"),r.sharedClipboardHostingApp=f,r.sharedClipboardHostingApps=[],r.sharedClipboardHostingEnvironments=[],k=r,void(V=!0);if(r.sharedClipboardHostingApps.indexOf(t)<0)return a().ULS.traceTag(596124185,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+r.sharedClipboardHostingApp+"' or '"+t+"' should be listed in sharedClipboardHostingApps"),r.sharedClipboardHostingApp=f,r.sharedClipboardHostingApps=[],r.sharedClipboardHostingEnvironments=[],k=r,void(V=!0)}r.whitelistOriginComponents=!0,k=r,V=!0}function Z(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:f,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:G,sharedClipboardExpirationInMinutes:q,clipboardPromiseTimeoutInMinutes:K}}new RegExp("^\\d+$");var ee="-";var re=1;function te(e,r){return function(e){void 0===e||null===e?a().ULS.traceTag(595973151,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"validateUserHash: userHash is undefined."):e===re&&a().ULS.traceTag(596451804,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"validateUserHash: userHash is set to the default non-user-hash value of "+re)}(r),void 0===e||null===e||e===re||void 0===r||null===r||e!==r}function ne(e){if(!e)throw new h(f,"id");var r=e.trim().toLowerCase();if(0===r.length)throw new b(f,"id");return r}function ie(){return(Math.random()+1).toString(36).substring(7)}function oe(e){return"get"===e||"set"===e||"init"===e}var ae=function(e){if(!e)throw new h(f,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new h(f,"id");if(!e.operationCode)throw new h(f,"operationCode");if(!oe(e.operationCode))throw new b(f,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new b("'"+e.operationCode+"' expects no clipboard items","clipboardItemsData")};function se(e,r,t,n,i){var o={id:e,operationCode:r,failed:t,error:n,clipboardItemsData:i};return de(o),o}var de=function(e){if(!e)throw new h(f,"clipboardOperationResultMessage");if(!e.id||0===e.id.trim().length)throw new h(f,"id");if(!e.operationCode)throw new h(f,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode)throw new b(f,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new b("A failed '"+e.operationCode+"' operation expects a non-empty error argument","error");if(e.clipboardItemsData)throw new b("A failed '"+e.operationCode+"' operation does not expect a clipboardItemsData argument","clipboardItemsData")}else{if(e.error)throw new b("'"+e.operationCode+"' expects an empty error argument","error");if("unknownresult"===e.operationCode)throw new b("'"+e.operationCode+"' can only be used with a failure message","operationCode")}if("getresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new b("'"+e.operationCode+"' expects a clipboardItems argument","clipboardItemsData")}else if(e.clipboardItemsData)throw new b("'"+e.operationCode+"' expects no clipboardItemsData argument","clipboardItemsData")};function ce(e){if(!e||0===e.trim().length)throw new b(f,"className",e);return function(){var r=!1;function t(r){return e+":"+r+": already disposed"}return{dispose:function(){r=!0},logIfDisposed:function(e){return r&&a().ULS.traceTag(596456217,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,t(e)),r},throwIfDisposed:function(e){if(r)throw new v(t(e))}}}()}var ue="\n",le=new RegExp("("+ue+"\r)|(\r"+ue+")|(\r)","g"),pe=new RegExp("(\t)","g"),ge=new RegExp("<","g"),fe="&lt;",me=new RegExp(">","g"),he="&gt;",be="pre",ve="table",Se="tr",we="td",Ce="\x3c!--StartFragment--\x3e",ye="\x3c!--EndFragment--\x3e",_e=(Ce.length,ye.length,"Version:0.9"+ue+"StartHTML:0000000100"+ue+"EndHTML:{EndHTML0}"+ue+"StartFragment:0000000134"+ue+"EndFragment:{EndFragm}"+ue+"<html>"+ue+"<body>"+ue+Ce+ue),Ee=""+ye+ue+"</body>"+ue+"</html>",Ie="0000000000",Te="</html>".length,Le="data-ccp-timestamp",Pe=0;function De(e){if(0!==R(e)){var r=Date.now();J(e.getData())||e.setItem("metadata/system-clipboard-data-ccp-timestamp",r.toString());var t=function(e){var r=[];return e&&(r=e.get()),0===r.length&&r.push({clipboardDataFormat:A,data:f}),r}(e);if(!O(t,W)){var n=function(e){return O(e,A)}(t),i=function(e,r,t){if(t!==Pe&&!t)throw new h(f,"timestamp");if(isNaN(t))throw new b(f,"timestamp",t.toString());var n=function(e){return e?e.replace(le,"</"+we+"></"+Se+"><"+Se+"><"+we+">"):e}(function(e){return e?e.replace(pe,"</"+we+"><"+we+">"):e}(function(e){if(!e)return f;return e.replace(ge,fe).replace(me,he)}(r))),i="<"+e+" "+Le+"='"+t+"'><"+ve+"><"+Se+"><"+we+">"+n+"</"+we+"></"+Se+"></"+ve+"></"+e+">";if(!P()||P()&&E.isEdgeVersionWithTextHtmlWrapperSupportProperty)return i;return function(e){var r=Ie.length,t=_e.length+e.length+Ee.length,n=(t-Ee.length).toString();n.length<r&&(n=Ie.substr(0,r-n.length)+n);if(n.length!==r){var i="addClipboardWrapper: the string representation of the opening bracket position of the End Fragment xml comment is "+n.length+" but it should be "+r;throw a().ULS.shipAssertTag(596128536,o.LogCategory.msoulscat_ES_EWAJS,!1,i),new C(u.UnexpectedClipboardTextHtmlContentLength,i)}var s=(t-Te).toString();s.length<r&&(s=Ie.substr(0,r-s.length)+s);if(s.length!==r){var i="addClipboardWrapper: the string representation of the opening bracket position of the End Html tag is "+s.length+" but it should be "+r;throw a().ULS.shipAssertTag(596128537,o.LogCategory.msoulscat_ES_EWAJS,!1,i),new C(u.UnexpectedClipboardTextHtmlContentLength,i)}var d=_e.replace("{EndHTML0}",s).replace("{EndFragm}",n)+e+Ee;return a().ULS.shipAssertTag(596128538,o.LogCategory.msoulscat_ES_EWAJS,d.length===t,"addClipboardWrapper: The resulting text/html payload length of "+d.length+" differs from the expected length of "+t),d}(i)}(be,n,r);e.setItem(W,i)}}}var Ae=function(){function e(e){this.clipboardStrategyType=e,this.disposableImplementationExtension=ce(""+e)}return e.prototype.initialize=function(e){var r=this;return e.then(function(e){return r.clipboardStorage=e,a().ULS.traceTag(596453007,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Clipboard strategy type '"+r.clipboardStrategyType+"' was initialized."),Promise.resolve(r)},function(e){return a().ULS.traceTag(596453008,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Failed to initialize clipboard strategy type '"+r.clipboardStrategyType+"'. Error: "+o.utils.getStringifiedError(e)),Promise.reject(e)})},e.prototype.set=function(e,r){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return a().ULS.shipAssertTag(596121485,o.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new C(u.ClipboardStrategyNotInitialized))}return De(e),this.clipboardStorage.set(e,r)}catch(e){return Promise.reject(new C(u.SetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").set",e))}},e.prototype.get=function(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return a().ULS.shipAssertTag(596121486,o.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new C(u.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e)}catch(e){return Promise.reject(new C(u.GetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").get",e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),We=function(){function e(e){this.clipboardStorageType=e}return e.prototype.setMetadataAndCacheItems=function(e,r,t){var n=this,i=void 0;if(e&&e.found&&e.result){var o=e.result.lastSystemClipboardDataCcpTimestamp;o&&!isNaN(o)&&1!==o&&(i=o)}if(!r||0===R(r))return this.clear().then(function(){if(!i)return Promise.resolve();var e={id:"2",userHash:t.userHash,lastSystemClipboardDataCcpTimestamp:i};return n.setItem(e)});var a=J(r.getData());a&&(1!==a&&(i=a),function(e){if(e){var r=H(e);(r||r===f)&&delete e.items["metadata/system-clipboard-data-ccp-timestamp"]}}(r.getData()));var s=Date.now(),d={id:"2",created:s,lastUsed:s,userHash:t.userHash,lastSystemClipboardDataCcpTimestamp:i},c={id:"1",clipboardItemsData:r.getData()};return this.setItem(d).then(function(){return n.setItem(c)})},e.prototype.getCacheItemsAndUpdateMetadata=function(e){var r=this,t=F;return this.getItem("2").then(function(n){if(n&&n.found&&n.result){var i=n.result,s=i.userHash,d=e&&e.userHash;return r.clearClipboardNecessary(s,d)?r.clear().then(function(){return Promise.resolve(t)}):r.getItem("1").then(function(e){if(e&&e.found&&e.result){var n=e.result.clipboardItemsData;return a().ULS.traceTag(595952592,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"getCacheItemsAndUpdateMetadata: item count="+U(n)),i.lastUsed=Date.now(),r.setItem(i).then(function(){return n=function(e,r){if(!r||isNaN(r))return e;var t=e;return t||(t={items:{}}),t.items["metadata/system-clipboard-data-ccp-timestamp"]=r.toString(),t}(n,i.lastSystemClipboardDataCcpTimestamp),Promise.resolve(j(n))})}return Promise.resolve(t)})}return Promise.resolve(t)})},e.prototype.clearClipboardNecessary=function(e,r){return!1},e}(),xe=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Me(e){var r=e;return r&&0!==r.trim().length||(r=ie()),new je(r)}function Fe(){return xe?window.performance.now():Date.now()}function Ue(e){return xe?new Date(e+window.performance.timing.navigationStart):new Date(e)}function Re(e,r,t){if(!t)throw new h(f,"creationTimestamp");return(e?"Fulfilled":"Still unfulfilled")+" after "+(e?r?r-t:"?":Fe()-t)+"ms"}var je=function(){function e(r){var t=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=ne(r),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=Fe(),a().ULS.traceTag(596456225,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Deferred promise: creating deferred promise #"+this.sequenceId+" with id '"+this.id+"' on "+Ue(this.creationTimestamp)),this.promise=new Promise(function(e,r){a().ULS.traceTag(596456226,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Deferred promise: registering callback for promise #"+t.sequenceId+" with id '"+t.id+"' on "+Ue(Fe())),t.internalResolve=e,t.internalReject=r})}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):a().ULS.traceTag(596456257,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):a().ULS.traceTag(596456260,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Fe(),a().ULS.traceTag(596456261,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Deferred promise: marking promise #"+this.sequenceId+" with id '"+this.id+"' as fulfilled ("+(this.rejected?"rejected":"resolved")+"). "+Re(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)))},e.prototype.fulfillmentCheck=function(e){return a().ULS.traceTag(596456258,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Deferred promise: asked to "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"'"),this.isFulfilled&&a().ULS.traceTag(596456259,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"Deferred promise: cannot "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"' since it was "+(this.rejected?"rejected":"resolved")+" already on "+Ue(this.fulfillmentTimestamp)+". "+Re(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)),this.isFulfilled},e.sequenceId=0,e}();!function(){function e(){this.deferredResultMessagePromiseCache={}}e.prototype.getDeferredPromise=function(e){var r=ne(e);return this.deferredResultMessagePromiseCache[r]},e.prototype.getPromise=function(e){var r=this.getDeferredPromise(e);if(r)return a().ULS.traceTag(596456218,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '"+e+"'."),r.promise;a().ULS.traceTag(596456219,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '"+e+"'.")},e.prototype.addNewPromise=function(e){var r=Me(e);if(this.getDeferredPromise(r.id))throw new b("A deferred promise already exists in the cache for the specified id","id",r.id);var t=ne(r.id);return this.deferredResultMessagePromiseCache[t]=r,a().ULS.traceTag(596456220,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '"+r.id+"'."),r},e.prototype.getLength=function(){var e=0;for(var r in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var r=ne(e);delete this.deferredResultMessagePromiseCache[r],a().ULS.traceTag(596456222,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Deferred promise cache: deleted id '"+e+"'.")}else a().ULS.traceTag(596456221,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '"+e+"' since this id is not associated with an existing deferred promise.")},e.prototype.clear=function(){if(a().ULS.traceTag(596456223,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Deferred promise cache: clearing "+this.getLength()+" items from the cache"),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var r=this.deferredResultMessagePromiseCache[e];if(r)try{r.reject()}catch(r){a().ULS.traceTag(596456224,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '"+e+"' with this exception: "+r.message+". Ignoring.")}}this.deferredResultMessagePromiseCache={}}}();function Be(e){if(!e)throw new h(f,"validator");return{deserialize:function(r){return function(e,r){if(!e)throw new h(f,"incomingMessage");if(!r)throw new h(f,"validator");if(0===e.length)throw new b("An empty message is invalid","incomingMessage");var t,n=e.trim();if(0===n.length)throw new b("A message cannot contain only spaces","incomingMessage");try{t=JSON.parse(n)}catch(r){throw new b("Deserialization failed","incomingMessage","Contains "+e.length.toString()+" characters",r)}if(!t)throw new b("Deserialization returned nothing","incomingMessage");return r(t),t}(r,e)}}}function Oe(e){if(!e)throw new h(f,"validator");return{serialize:function(r){return function(e,r){if(!e)throw new h(f,"outgoingMessage");if(!r)throw new h(f,"validator");return r(e),function(e){var r;try{r=JSON.stringify(e)}catch(r){throw new b("Serialization failed","outgoingMessage",Object.keys(e).length+" properties",r)}return a().ULS.traceTag(596452375,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"The length of the serialized message is "+r.length),r}(e)}(r,e)}}}var Je="initmessageid";var He=function(){function e(e,r,t,n){this.serializer=e,this.deserializer=r,this.remoteWindow=t,this.remoteWindow=t,this._disposableImplementationExtension=ce(n)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(!function(e){if(e&&Array.isArray(e)&&0!==e.length){var r=0,t=void 0;if(e.forEach(function(e){if(r+=1,e)try{e()}catch(e){a().ULS.traceTag(596456216,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+r+" threw an exception: "+e.message),t||(t=new v(e.message,e))}else a().ULS.traceTag(596456215,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+r+" is empty")}),t)throw t}else a().ULS.traceTag(596456214,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new h(f,"outgoingMessage");if(!this.sender){var r="WindowRPCBase::postMessage - this.sender should be defined";throw a().ULS.shipAssertTag(596121484,o.LogCategory.msoulscat_ES_EWAJS,!1,r),new v(r)}this.sender.postMessage(e)},e}();function Ne(){return ze}var ze={addEventListener:function(e,r){return window.addEventListener(e,r)},removeEventListener:function(e,r){return window.removeEventListener(e,r)}};var ke="message",Ve=function(){function e(e,r,t){var n=this;if(this.deserializer=e,this.handler=r,this.windowMessageHandler=function(e){return n.onMessageReceived(e)},!e)throw new h(f,"deserializer");if(!r)throw new h(f,"handler");if(!t)throw new h(f,"windowRPC");this.disposableImplementationExtension=ce("WindowRPCReceiverInternal"),this.remoteWindow=t.remoteWindow,Ne().addEventListener(ke,this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Ne().removeEventListener(ke,this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return a().ULS.traceTag(596452370,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return a().ULS.traceTag(596452371,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return a().ULS.traceTag(596452372,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return a().ULS.traceTag(596452373,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var r=void 0;try{r=this.deserializer.deserialize(e.data)}catch(e){a().ULS.traceTag(596452374,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Window RPC Receiver: unable to deserialize incoming message. "+o.utils.getStringifiedError(e));try{this.handler.handleDeserializationError(o.utils.getStringifiedError(e))}catch(e){a().ULS.traceTag(596452184,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. "+o.utils.getStringifiedError(e))}return}if(r)try{this.handler.handleMessage(r).catch(function(e){a().ULS.traceTag(595985880,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+o.utils.getStringifiedError(e))})}catch(e){a().ULS.traceTag(596452186,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+o.utils.getStringifiedError(e))}else a().ULS.traceTag(596452185,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();var Ge=function(){function e(e,r,t){if(void 0===t&&(t=!1),this.serializer=e,this.delayedQueueEnabled=t,!e)throw new h(f,"serializer");if(!r)throw new h(f,"windowRPC");this.disposableImplementationExtension=ce("WindowRPCSenderInternal"),this.remoteWindow=r.remoteWindow}return e.prototype.postMessage=function(e){if(!e)throw new h(f,"outgoingMessage");if(!this.remoteWindow.window)throw new v("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new v("The remote window does not support postMessage");var r=this.serializer.serialize(e);D.postMessage(this.remoteWindow.window,r,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();var qe=new(t(1).ConsoleLogger);var Ke=function(e){function r(r,t,n,i){var o=e.call(this,t,r,n,"WindowRPCServerInternal")||this;if(o.windowRPCServerState=i,!i)throw new C(u.CreateWindowRPCServer,"windowRPCServerState is undefined.");return o.receiver=function(e,r,t){return new Ve(e,r,t)}(r,o,o),o.sender=function(e,r){return new Ge(e,r)}(t,o),o}return d(r,e),r.prototype.handleMessage=function(e){var r=this;if(a().ULS.traceTag(596452360,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"RPC Server - handleMessage: incomingMessage.id='"+(e&&e.id)+"'; incomingMessage.operationCode='"+(e&&e.operationCode)+"'; incomingMessage.clipboardItems.length="+U(e&&e.clipboardItemsData)),this.windowRPCServerState.isInitializationPending()&&e&&"init"===e.operationCode)return a().ULS.traceTag(596129562,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"The clipboard strategy is not initialized yet. Once it's done, it'll send an 'initresult' message."),Promise.resolve();var t=e&&e.id?e.id:"unknownmessageid",n=!e||!e.operationCode||!oe(e.operationCode),i={id:t,failed:n,error:void 0,operationCode:n?"unknownresult":e.operationCode+"result"};return this.routeOperation(e,i).then(function(e){return r.postMessage(e)}).catch(function(e){return a().ULS.traceTag(596452182,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"RPC Server - handleMessage: unable to send result message. Sending a failure message. "+o.utils.getStringifiedError(e)),i.clipboardItemsData=void 0,r.configureFailureInMessage(i,e),r.postMessage(i)}).catch(function(e){return a().ULS.traceTag(596452183,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"RPC Server - handleMessage: unable to send failure result message. "+o.utils.getStringifiedError(e)),Promise.reject(e)})},r.prototype.routeOperation=function(e,r){var t=this;if(this.windowRPCServerState.isInitializationPending()){var n=new C(u.SelectClipboardStrategy,"A clipboard strategy had not been selected and initialized yet");return this.resolveFailureMessage(r,n)}if(!this.windowRPCServerState.isInitializedSuccessfully())return this.resolveFailureMessage(r,this.windowRPCServerState.getClipboardInitError());var i=this.windowRPCServerState.getSelectedClipboardStrategy();if(!i)return this.resolveFailureMessage(r,new C(u.SelectClipboardStrategy,"selectedClipboardStrategy is not defined"));var o={userHash:e.userHash};if("set"===e.operationCode){var a=void 0;return e.clipboardItemsData&&(a=e.clipboardItemsData),i.set(j(a),o).then(function(){return Promise.resolve(r)},function(e){return t.resolveFailureMessage(r,e)})}if("get"===e.operationCode)return i.get(o).then(function(e){return r.clipboardItemsData=e.getData(),Promise.resolve(r)},function(e){return t.resolveFailureMessage(r,e)});if("init"===e.operationCode)return Promise.resolve(r);var s=new C(u.UnsupportedOperationCode,"Operation code '"+e.operationCode+"' is unsupported");return this.resolveFailureMessage(r,s)},r.prototype.handleDeserializationError=function(e){return this.postMessage({id:"unknownmessageid",failed:!0,error:e,operationCode:"unknownresult"}).catch(function(e){a().ULS.traceTag(596451867,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"RPC Server - handleDeserializationError: unable to send failure result message. "+o.utils.getStringifiedError(e))})},r.prototype.postMessage=function(r){try{return e.prototype.postMessage.call(this,r),Promise.resolve()}catch(e){return Promise.reject(new v("Unable to post message for operation '"+(r&&r.operationCode?r.operationCode:f)+"'",e))}},r.prototype.resolveFailureMessage=function(e,r){return this.configureFailureInMessage(e,r),Promise.resolve(e)},r.prototype.configureFailureInMessage=function(e,r){e.failed=!0,e.error=o.utils.getStringifiedError(r)},r}(He);function Qe(e){if(!e)return Promise.resolve(!1);var r=function(e){try{var r=window.parent,t=r.location.origin;return new Ke(Be(ae),Oe(de),{window:r,windowOrigin:t},e)}catch(e){return void a().ULS.shipAssertTag(595981475,o.LogCategory.msoulscat_ES_EWAJS,!1,"createWindowRPCServer failed with exception: "+o.utils.getStringifiedError(e))}}($e);if(!r)return a().ULS.traceTag(595947554,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"initModuleState: Failed to create windowRPCServer"),Promise.resolve(!1);var t=Me(Je);return(Xe={initMessageIdUniqueRunningSuffix:1,initializationDeferredPromise:t,windowRPCServer:r}).initializationDeferredPromise.promise.then(function(){return function(){var e=Ze();if(a().ULS.shipAssertTag(595947555,o.LogCategory.msoulscat_ES_EWAJS,!!e,"sendClipboardInitializationSuccessResult: windowRPCServer must be defined"),!e)return Promise.reject(new v("sendClipboardInitializationSuccessResult cannot post a message since WindowRPCServer could not be created"));var r=se(er(),"initresult",!1);return e.postMessage(r)}()},function(e){return function(e){var r=Ze();if(a().ULS.shipAssertTag(595947584,o.LogCategory.msoulscat_ES_EWAJS,!!r,"sendClipboardInitializationFailureResult: windowRPCServer must be defined"),!r)return Promise.reject(new v("sendClipboardInitializationFailureResult cannot post a message since WindowRPCServer could not be created"));var t=se(er(),"initresult",!0,o.utils.getStringifiedError(e));return r.postMessage(t)}(e)}).catch(function(){}),e.then(function(e){return function(e){if(a().ULS.traceTag(595947585,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"markInitializationSuccess: Created and initialized ClipboardStrategies '"+e+"'"),a().ULS.shipAssertTag(595947586,o.LogCategory.msoulscat_ES_EWAJS,!!Xe,"markInitializationSuccess: windowRPCServerInternalState must be defined"),!Xe)return;Xe.selectedClipboardStrategy=e,Xe.clipboardInitError=void 0,Xe.clipboardInitTimestamp=Date.now(),Xe.initializationDeferredPromise&&Xe.initializationDeferredPromise.resolve()}(e),Promise.resolve(!0)},function(e){return function(e){if(a().ULS.traceTag(595947587,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"markInitializationFailure: Failed to initialize ClipboardStrategies"),a().ULS.shipAssertTag(595947588,o.LogCategory.msoulscat_ES_EWAJS,!!Xe,"markInitializationFailure: windowRPCServerInternalState must be defined"),!Xe)return;Xe.selectedClipboardStrategy=void 0,Xe.clipboardInitError=e,Xe.clipboardInitTimestamp=Date.now(),Xe.initializationDeferredPromise&&Xe.initializationDeferredPromise.reject(Xe.clipboardInitError)}(e),Promise.resolve(!1)})}var $e={getSelectedClipboardStrategy:function(){if(!Xe)return;return Xe.selectedClipboardStrategy},isInitializationPending:Ye,isInitializedSuccessfully:function(){if(Xe)return!Ye()&&!!Xe.selectedClipboardStrategy;return!1},getClipboardInitError:function(){if(Xe)return Xe.clipboardInitError;return}},Xe=void 0;function Ye(){return!Xe||!Xe.initializationDeferredPromise||!Xe.initializationDeferredPromise.fulfilled()}function Ze(){if(Xe)return Xe.windowRPCServer}function er(){if(!Xe)return f;var e=Xe.initMessageIdUniqueRunningSuffix;return Xe.initMessageIdUniqueRunningSuffix+=1,""+Je+e}var rr="__ccpDB___",tr=function(e){function r(){var r=e.call(this,x.IndexedDB)||this;r.providerSupported=!1,r.cacheCloseHandler=function(){r.closeDB()},r.disposableImplementationExtension=ce("IndexedDBClipboardStorage");var t=o.idbPromised.getDbFactory();return t&&(r.providerSupported=!0,r.dbFactory=t),r}return d(r,e),r.prototype.get=function(e){return this.disposableImplementationExtension.throwIfDisposed("get"),a().ULS.traceTag(596452362,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"indexedDBClipboardStorage.get: commandParameters='"+(e?JSON.stringify(e):f)+"'"),this.getCacheItemsAndUpdateMetadata(e)},r.prototype.set=function(e,r){var t=this;return this.disposableImplementationExtension.throwIfDisposed("set"),a().ULS.traceTag(596452363,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"indexedDBClipboardStorage.set: item count="+R(e)+"'; commandParameters='"+(r?JSON.stringify(r):f)+"'"),this.getItem("2").then(function(n){return t.setMetadataAndCacheItems(n,e,r)})},r.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[A,W,"data/shadow-workbook"]},r.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.closeDB(),this.disposableImplementationExtension.dispose())},r.prototype.clear=function(){return this.removeAllItems()},r.prototype.clearClipboardNecessary=function(e,r){return te(e,r)},r.create=function(e,t){o.perfWatch.mark(t,"ccp_idb_create_start"),o.idbPromised.registerTraceSubscriber(function(e){o.perfWatch.mark(t,e)});var n=new r;return n.version=e,n.supported?n.ensureDb(!1,t).then(function(e){return o.perfWatch.mark(t,"ccp_idb_create_ensureDb_noVersion_done"),e.db.version}).then(function(r){return"number"==typeof e&&r<e?(o.perfWatch.mark(t,"ccp_idb_create_dbUpgrade"),n.removeAllItems().then(function(){return o.perfWatch.mark(t,"ccp_idb_create_clearAll_done"),n.ensureDb(!0,t)}).then(function(e){var r=e.db.version;return o.perfWatch.mark(t,"ccp_idb_create_ensureDb_upgrade_"+r),n})):"number"==typeof e&&r>e?(n.providerSupported=!1,Promise.reject(new C(u.IndexedDBProviderNotSupported,"indexedDB: The new version '"+e+"' is smaller than the current DB version '"+r+"'"))):Promise.resolve(n)}).then(function(e){return o.perfWatch.mark(t,"ccp_idb_create_done"),o.idbPromised.clearTraceSubscriber(),e}).catch(function(e){return o.perfWatch.mark(t,"ccp_idb_create_error"),o.idbPromised.clearTraceSubscriber(),Promise.reject(new C(u.IndexedDBCacheInitialization,f,e))}):(o.perfWatch.mark(t,"ccp_idb_not_supported"),Promise.reject(new C(u.IndexedDBProviderNotSupported)))},r.prototype.ensureDb=function(e,r){var t=this;if(void 0===e&&(e=!1),this.db)return Promise.resolve({db:this.db,dbName:rr});if(!this.supported)return Promise.reject(new C(u.IndexedDBProviderNotSupported));if(!this.dbFactory){var n="IndexedDBClipboardStorage.ensureDb: this.dbFactory should be defined";return a().ULS.shipAssertTag(596121483,o.LogCategory.msoulscat_ES_EWAJS,!1,n),Promise.reject(new v(n))}o.perfWatch.mark(r,"ccp_idb_ensureDb_start");var i,s=e?this.version:void 0;return o.idbPromised.initDb(this.dbFactory,rr,s,function(e){o.perfWatch.mark(r,"ccp_idb_ensureDb_CreateStore_start");var t=e.createObjectStore("__store__",{autoIncrement:!1,keyPath:"id"});return o.perfWatch.mark(r,"ccp_idb_ensureDb_CreateStore_finish"),[o.idbPromised.getStoreReadinessPromise(t)]}).then(function(e){return o.perfWatch.mark(r,"ccp_idb_ensureDb_initDb_complete"),i=e,t.db=e.db,o.perfWatch.mark(r,"ccp_idb_ensureDb_attachedToClose"),t.db.addEventListener("close",t.cacheCloseHandler),o.perfWatch.mark(r,"ccp_idb_ensureDb_finish"),Promise.resolve(i)}).catch(function(e){var n=o.utils.getStringifiedError(e);return a().ULS.traceTag(596452065,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Error in ensureDb: "+n),t.closeDB(),o.perfWatch.mark(r,"ccp_idb_ensureDb_error"),Promise.reject(new C(u.IndexedDBCacheInitialization,"db: '__ccpDB___'; store: '__store__'",new Error(n)))})},r.prototype.init=function(e){return o.perfWatch.mark(e,"ccp_idb_init_start"),this.closeDB(),o.perfWatch.mark(e,"ccp_idb_init_closeCache"),this.ensureDb(!1,e).then(function(){return o.perfWatch.mark(e,"ccp_idb_init_end"),Promise.resolve()})},r.prototype.closeDB=function(){this.db&&(this.db.removeEventListener("close",this.cacheCloseHandler),this.db.close(),this.db=void 0)},Object.defineProperty(r.prototype,"supported",{get:function(){return this.providerSupported},enumerable:!0,configurable:!0}),r.prototype.setItem=function(e){return this.ensureDb().then(function(r){return o.idbPromised.put(r.db,"__store__",void 0,e).catch(function(e){var r=o.utils.getStringifiedError(e);return a().ULS.traceTag(596452066,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Error in setItem: "+r),Promise.reject(new Error(r))})}).catch(function(e){return Promise.reject(new C(u.IndexedDBSetItem,"db: '__ccpDB___'; store: '__store__'",e))})},r.prototype.getItem=function(e){return this.ensureDb().then(function(r){return o.idbPromised.get(r.db,"__store__",e).then(function(e){return{result:e,found:void 0!==e}},function(e){var r=o.utils.getStringifiedError(e);return a().ULS.traceTag(596452067,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Error in getItem: "+r),Promise.reject(new Error(r))})}).catch(function(r){var t="db: '__ccpDB___'; store: '__store__'; key: '"+e+"'";return Promise.reject(new C(u.IndexedDBGetItem,t,r))})},r.prototype.removeItem=function(e){return this.ensureDb().then(function(r){return o.idbPromised.remove(r.db,"__store__",e).catch(function(e){var r=o.utils.getStringifiedError(e);return a().ULS.traceTag(596452096,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Error in removeItem: "+r),Promise.reject(new Error(r))})}).catch(function(r){var t="db: '__ccpDB___'; store: '__store__'; key: '"+e+"'";return Promise.reject(new C(u.IndexedDBRemoveItem,t,r))})},r.prototype.removeAllItems=function(){return this.ensureDb().then(function(e){return o.idbPromised.removeAll(e.db,"__store__").catch(function(e){var r=o.utils.getStringifiedError(e);return a().ULS.traceTag(596452097,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Error in removeAllItems: "+r),Promise.reject(new Error(r))})}).catch(function(e){return Promise.reject(new C(u.IndexedDBRemoveAllItems,"db: '__ccpDB___'; store: '__store__'",e))})},r.prototype.deleteDb=function(){var e=this;return this.ensureDb().then(function(r){return o.idbPromised.deleteDb(e.dbFactory,r.db.name).then(function(){return e.closeDB(),Promise.resolve(rr)},function(e){var r=o.utils.getStringifiedError(e);return a().ULS.traceTag(596452098,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,"Error in deleteDb: "+r),Promise.reject(new Error(r))})}).catch(function(e){return Promise.reject(new C(u.IndexedDBDeleteDb,"db: '__ccpDB___'; store: '__store__'",e))})},r}(We);function nr(){return a().ULS.traceTag(596452420,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Attempting to create clipboard strategy type '"+c.IndexedDB+"'"),(new ir).initialize(function(){a().ULS.traceTag(596452421,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Attempting to create clipboard storage type '"+x.IndexedDB+"'");var e=o.perfWatch.start("createIndexedDBClipboardStorage");return tr.create(n.getSharedClipboardSettings().sharedClipboardSchemaVersion,e).then(function(r){return o.perfWatch.success(e,function(e){return a().ULS.traceTag(596452062,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,e)}),Promise.resolve(r)}).catch(function(r){var t=f;return o.perfWatch.failure(e,function(e){t=e;var n="; Exception: "+o.utils.getStringifiedError(r);a().ULS.traceTag(596452063,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Error,t+n)},"Error in createIndexedDBClipboardStorage"),Promise.reject(new C(u.IndexedDBCacheInitialization,t,r))})}())}var ir=function(e){function r(){return e.call(this,c.IndexedDB)||this}return d(r,e),r}(Ae);function or(){return function(e){if(!e)throw new Error("The 'logger' argument is missing");i=o.ULS.getFromExternalLogger(e)}(qe),n.initializeSharedClipboardSettingsFromWindow(),Qe(nr())}t.d(r,"a",function(){return or})},function(e,r,t){"use strict";t.r(r);var n=t(0);for(var i in n)"default"!==i&&function(e){t.d(r,e,function(){return n[e]})}(i);var o=t(3);t.d(r,"initialize",function(){return o.a})},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n,i=t(2);function o(e,r,t){return e?!(r&&!e.objectStoreNames.contains(r))||(t({name:"ValidationError",message:"The database doesn't contain store name: "+r}),!1):(t({name:"ValidationError",message:"The database should be initialized"}),!1)}var a=void 0;function s(e){void 0!==a&&a(e)}function d(e,r,t,n){return new Promise(function(i,a){if(o(e,r,a)){var s,d=e.transaction([r],t);d.oncomplete=function(){return i()},d.onerror=function(){return a(s||d.error)},d.onabort=function(){return a(s||d.error)};var c=d.objectStore(r),u=n(c);u.onerror=function(){s=u.error}}})}r.registerTraceSubscriber=function(e){a=e},r.clearTraceSubscriber=function(){a=void 0},r.setTestDbFactory=function(e){n=e},r.getDbFactory=function(){if(n)return n;try{if(window&&"indexedDB"in window&&void 0!==window.indexedDB)return window.indexedDB}catch(t){var e=i.getStringifiedError(t);e&&e!==i.defaultToJSONResultWhenStringifyFails||!t||!t.message||(e=t.message);var r=i.getPerfWatchMarkName(e);s("indexedDB_access_error"+(r&&r.length>0?"_":"")+r)}},r.getStoreReadinessPromise=function(e){return new Promise(function(r,t){e.transaction.oncomplete=function(){return r()},e.transaction.onerror=function(){return t(e.transaction.error)}})},r.initDb=function(e,r,t,n){return new Promise(function(i,o){s("idb_open");var a=t||0===t?e.open(r,t):e.open(r),d=function(e){var r=!1,t=!1,n=function(e){s("idb_open_"+e)},a=function(){return t?(n("already_resolved"),!1):!r||(n("already_rejected"),!1)};return{rejectOnce:function(e){n("should_reject"),a()&&(n("rejecting"),r=!0,o(e))},resolveOnce:function(e){n("should_resolve"),a()&&(n("resolving"),t=!0,i(e))}}}();a.onupgradeneeded=function(e){s("idb_open_onupgradeneeded_start");var t=e.target.result;if(e.oldVersion>0&&function(e){s("idb_open_onupgradeneeded_deleteAllObjectStores");for(var r=[],t=e.objectStoreNames.length-1;t>=0;t-=1){var n=e.objectStoreNames.item(t);(n||""===n)&&r.push(n)}r.forEach(function(r){s("idb_open_onupgradeneeded_delete_store_"+r),e.deleteObjectStore(r)})}(t),n){s("idb_open_onupgradeneeded_create_stores");var i=n(t);i&&i.length>0&&Promise.all(i).then(function(){s("idb_open_onupgradeneeded_stores_ready"),d.resolveOnce({db:t,dbName:r})},function(e){s("idb_open_onupgradeneeded_stores_ready_error"),d.rejectOnce(e)})}s("idb_open_onupgradeneeded_end")},a.onsuccess=function(e){s("idb_open_onsuccess"),d.resolveOnce({db:e.target.result,dbName:r})},a.onerror=function(){s("idb_open_onerror"),d.rejectOnce(a.error)},a.onblocked=function(e){s("idb_open_onblocked"),d.rejectOnce(e)}})},r.deleteDb=function(e,r){return new Promise(function(t,n){var i=e.deleteDatabase(r);i.onsuccess=function(){return t()},i.onblocked=function(){return t()},i.onerror=function(){return n(i.error)}})},r.doTransactionAction=d,r.put=function(e,r,t,n){return d(e,r,"readwrite",function(e){return t?e.put(n,t):e.put(n)})},r.get=function(e,r,t){return new Promise(function(n,i){if(o(e,void 0,i)){var a;e.objectStoreNames.contains(r)||n(void 0);var s=void 0,d=e.transaction([r],"readonly");d.oncomplete=function(){return n(s)},d.onerror=function(){return i(a||d.error)},d.onabort=function(){return i(a||d.error)};var c=d.objectStore(r).get(t);c.onsuccess=function(e){s=e.target.result},c.onerror=function(){a=c.error}}})},r.getAllItems=function(e,r){return new Promise(function(t,n){if(o(e,r,n)){var i,a=[],s=e.transaction([r],"readonly");s.oncomplete=function(){return t(a)},s.onerror=function(){return n(i||s.error)},s.onabort=function(){return n(i||s.error)};var d=s.objectStore(r).openCursor();d.onsuccess=function(e){var r=e.target.result;r&&(a.push(r.value),r.continue())},d.onerror=function(){i=d.error}}})},r.getAllKeys=function(e,r){return new Promise(function(t,n){if(o(e,r,n)){var i,a=[],s=e.transaction([r],"readonly");s.oncomplete=function(){return t(a)},s.onerror=function(){return n(i||s.error)},s.onabort=function(){return n(i||s.error)};var d=s.objectStore(r).openCursor();d.onsuccess=function(e){var r=e.target.result;r&&(a.push(r.key),r.continue())},d.onerror=function(){i=d.error}}})},r.remove=function(e,r,t){return d(e,r,"readwrite",function(e){return e.delete(t)})},r.removeAll=function(e,r){return d(e,r,"readwrite",function(e){return e.clear()})}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={},i="promises";r.promises=function(){return void 0===n[i]&&(n[i]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n[i]}},function(e,r,t){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function i(e,r,t){e[r]=n()-t}Object.defineProperty(r,"__esModule",{value:!0}),r.start=function(e){var r=e,t=n(),o={},a=function(e,n,a){return function(e,r,t,n,o,a){i(e,"end",t);var s={sessionName:r,result:n?"success":"failure",message:a,marks:e},d=JSON.stringify(s);o(d)}(o,r,t,e,n,a)};return o.start=0,{mark:function(e){return function(e){return i(o,e,t)}(e)},end:function(e){return a(!0,e)},success:function(e,r){return a(!0,e,r)},failure:function(e,r){return a(!1,e,r)}}},r.mark=function(e,r){void 0!==e&&e.mark(r)},r.end=function(e,r){void 0!==e&&e.end(r)},r.success=function(e,r,t){void 0!==e&&e.success(r,t)},r.failure=function(e,r,t){void 0!==e&&e.failure(r,t)}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};r.ewaUtils=function(){return n},r.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){return Date.now()};r.initStopwatchFactory=function(e,r){return void 0===r&&(r=1),window.performance&&window.performance.now&&(n=function(){return window.performance.now()}),function(t){var i=n(),o=t;return{reset:function(e){null!=e&&(o=e),i=n()},stop:function(){var t=n()-i,a=JSON.stringify({Target:o,Duration:t.toFixed(r)});e(a)}}}}}]);
//# sourceMappingURL=sharedClipboard.min.js.map