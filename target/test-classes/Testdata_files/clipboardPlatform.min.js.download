var clipboardPlatform=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=392)}({0:function(e,t,r){"use strict";var n={};r.r(n),r.d(n,"sharedClipboardSettingsVariableName",function(){return fe}),r.d(n,"defaultPromiseTimeoutInMinutes",function(){return ye}),r.d(n,"getSharedClipboardSettings",function(){return Se}),r.d(n,"initializeSharedClipboardSettingsFromWindow",function(){return we}),r.d(n,"initializeSharedClipboardSettings",function(){return Ee}),r.d(n,"createEmptySharedClipboardSettings",function(){return Ie});var o={};r.r(o),r.d(o,"divTagName",function(){return pt}),r.d(o,"preWrappingTagName",function(){return mt}),r.d(o,"tableTagName",function(){return gt}),r.d(o,"trTagName",function(){return ft}),r.d(o,"tdTagName",function(){return bt}),r.d(o,"minCcpTimestampHtmlCustomAttributeValue",function(){return Tt}),r.d(o,"ensureOneLFPerNewLine",function(){return _t}),r.d(o,"trimToLength",function(){return Pt}),r.d(o,"ensureTextHtmlAndCcpTimestampItems",function(){return xt}),r.d(o,"createTextHtmlFromTextPlain",function(){return Dt}),r.d(o,"getFragmentFromTextHtml",function(){return jt}),r.d(o,"getCcpTimestampHtmlCustomAttributeFromWrappingTag",function(){return Ot}),r.d(o,"encodeAngleBrackets",function(){return At});var i,a=r(1);function s(){return i}function c(e){if(!e)throw new Error("The 'logger' argument is missing");i=a.ULS.getFromExternalLogger(e)}var d,l,u,p,m,g=r(2),f="";function b(e,t){return h(e,[t])}function h(e,t){if(!function(e){if(!(e&&"object"==typeof e&&"reason"in e))return!1;if(!function(e){if(!e&&0!==e)return!1;var t=Number(e);if(isNaN(t)||t.toString()!==e.toString())return!1;return!0}(e.reason))return!1;return!0}(e))return!1;if(!t||!Array.isArray(t)||t.length<1)return!1;var r=e.reason;return t.indexOf(r)>=0}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.SystemClipboardAndIndexedDB=1]="SystemClipboardAndIndexedDB",e[e.IndexedDB=2]="IndexedDB",e[e.IndexedDBAndInMemory=3]="IndexedDBAndInMemory",e[e.InMemory=4]="InMemory"}(d||(d={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.IndexedDBSetClipboardItems=4]="IndexedDBSetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.IndexedDBGetClipboardItems=6]="IndexedDBGetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.SelectClipboardStrategy=14]="SelectClipboardStrategy",e[e.IndexedDBProviderNotSupported=15]="IndexedDBProviderNotSupported",e[e.IndexedDBCacheInitialization=16]="IndexedDBCacheInitialization",e[e.IndexedDBGetCache=17]="IndexedDBGetCache",e[e.IndexedDBDeleteDb=18]="IndexedDBDeleteDb",e[e.IndexedDBSetItem=19]="IndexedDBSetItem",e[e.IndexedDBGetItem=20]="IndexedDBGetItem",e[e.IndexedDBGetAllKeys=21]="IndexedDBGetAllKeys",e[e.IndexedDBGetAllItems=22]="IndexedDBGetAllItems",e[e.IndexedDBRemoveItem=23]="IndexedDBRemoveItem",e[e.IndexedDBRemoveAllItems=24]="IndexedDBRemoveAllItems",e[e.IndexedDBClearAll=25]="IndexedDBClearAll",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IndexedDBCacheInitializationTimeout=30]="IndexedDBCacheInitializationTimeout",e[e.IndexedDBSetTimeout=31]="IndexedDBSetTimeout",e[e.IndexedDBGetTimeout=32]="IndexedDBGetTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer"}(l||(l={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste"}(p||(p={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(m||(m={}));var C=function(e){function t(r,n,o){var i=this,c=t.augmentParameterValue(r);if(i=e.call(this,c)||this,t.augmentParameterValue(n).length>0?s().ULS.traceTag(596456211,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Error '"+n+"': "+c):s().ULS.traceTag(596456212,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Error message: "+c),o){i.innerError=o;var d=o.message;d||(d=o.name);var l=t.augmentParameterValue(d);l.length>0&&s().ULS.traceTag(596456213,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Inner error message: "+l)}return i.name=t.augmentParameterValue(n),i.stack||(i.stack=(new Error).stack),i}return g.__extends(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():f},t}(Error),v=function(e){function t(r,n,o){var i=this,a=C.augmentParameterValue(n),s=t.getDefaultMessage(a),c=C.augmentParameterValue(r);return 0===c.length&&(c=s),(i=e.call(this,c,"MissingArgumentError",o)||this).name=a,i}return g.__extends(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '"+e+"'"),t},t}(C),y=function(e){function t(r,n,o,i){var a=this,s=C.augmentParameterValue(n),c=o;c||(c=f);var d=t.getDefaultMessage(s,c),l=C.augmentParameterValue(r);return 0===r.length&&(l=d),(a=e.call(this,l,"InvalidArgumentError",i)||this).name=s,a.value=c,a}return g.__extends(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '"+e+"' argument: '"+t+"'":"Invalid argument"},t}(C),S=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return g.__extends(t,e),t}(C),w=function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}return g.__extends(t,e),t}(C),E=function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}return g.__extends(t,e),t}(C);function L(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:f}var I=function(e){function t(t,r,n,o,i){var a=e.call(this,r||"reason="+t,n,o)||this;return a.reason=t,a.reasonName=i,a}return g.__extends(t,e),t}(C),T=function(e){function t(t,r,n){return e.call(this,t,r,"CopyError",n,L(t,u))||this}return g.__extends(t,e),t}(I),_=function(e){function t(t,r,n){return e.call(this,t,r,"PasteError",n,L(t,p))||this}return g.__extends(t,e),t}(I),P=function(e){function t(t,r,n){return e.call(this,t,r,"CancelError",n,L(t,m))||this}return g.__extends(t,e),t}(I),x=function(e){function t(t,r,n){return e.call(this,t,r,"ClipboardPlatformError",n,L(t,l))||this}return g.__extends(t,e),t}(I),D=function(e){function t(t,r,n){return e.call(this,t,r,"SharedClipboardError",n,L(t,l))||this}return g.__extends(t,e),t}(I);function j(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach(function(e){if(t+=1,e)try{e()}catch(e){s().ULS.traceTag(596456216,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" threw an exception: "+e.message),r||(r=new S(e.message,e))}else s().ULS.traceTag(596456215,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" is empty")}),r)throw r}else s().ULS.traceTag(596456214,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}function O(){return A}var A={userAgent:function(){return window&&window.navigator?window.navigator.userAgent:f},appVersion:function(){return window&&window.navigator?window.navigator.appVersion:f}},M={};function W(){M={}}var R=new RegExp("(\\bTrident/| MSIE )"),U=16.16299,B=17.17123,J=new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");function F(){if(void 0===M.isIEProperty){M.isIEProperty=!1;var e=O();if(e&&e.userAgent&&"function"==typeof e.userAgent){var t=e.userAgent();if(t){var r=t.match(R);r&&2===r.length&&(M.isIEProperty=!0)}}}return M.isIEProperty}function N(){if(void 0===M.isEdgeProperty){M.isEdgeProperty=!1,M.isEdgeWithTextHtmlClipboardSupportProperty=!1,M.isEdgeVersionWithTextHtmlWrapperSupportProperty=!1;var e=O();if(e&&e.appVersion&&"function"==typeof e.appVersion){var t=e.appVersion();if(t){var r=t.match(J);if(r&&2===r.length){M.isEdgeProperty=!0;var n=Number(r[1]);isNaN(n)||(n>=U&&(M.isEdgeWithTextHtmlClipboardSupportProperty=!0),n>=B&&(M.isEdgeVersionWithTextHtmlWrapperSupportProperty=!0))}}}}return M.isEdgeProperty}function k(){return N()&&M.isEdgeWithTextHtmlClipboardSupportProperty}function H(){return N()&&M.isEdgeVersionWithTextHtmlWrapperSupportProperty}function z(){return V}var V={postMessage:function(e,t,r,n){e.postMessage(t,r,n)}},G=function(e,t,r,n){return void 0===n&&(n=!1),e.addEventListener(t,r,n),function(){e.removeEventListener(t,r,n)}},Y="text/plain",K="text/html",q=1..toString();function Q(){return{items:{}}}var X,Z,$=function(){var e={items:{}};return{getData:function(){return e},getItem:function(e){},setItem:function(e,t){throw new S("Cannot set an item with clipboard data format '"+e+"' in an immutable empty clipboard (content is "+(t&&t.length>0?"not ":f)+"empty)")},get:function(){return ge(void 0)}}}();function ee(){return $}function te(e){return e&&e.items?Object.keys(e.items).length:0}function re(e){return te(e&&e.getData())}function ne(e){void 0===e&&(e=void 0);var t=e;return t||(t={items:{}}),{getItem:function(e){return oe(t,e)},setItem:function(e,r){!function(e,t,r){if(!e)throw new v(f,"clipboardItemsData");if(!e.items)throw new y(f,"clipboardItemsData.items");e.items[t]=r}(t,e,r)},getData:function(){return t},get:function(){return ge(t)}}}function oe(e,t){if(!e)throw new v(f,"clipboardItemsData");if(!e.items)throw new y(f,"clipboardItemsData.items");return e.items[t]}function ie(e,t){if(!e||0===e.length||!t||!t.trim())return f;var r=void 0;return e.forEach(function(e){e.clipboardDataFormat===t&&(r=e.data)}),r||f}function ae(e){return ie(e,Y)}function se(e){var t=[];return e&&(t=e.get()),0===t.length&&t.push({clipboardDataFormat:Y,data:f}),t}function ce(e){if(e){var t=me(e);if(t){var r=Number(t);if(r&&!isNaN(r))return r}}}function de(e){if(e){var t=me(e);(t||t===f)&&delete e.items["metadata/system-clipboard-data-ccp-timestamp"]}}function le(e){if(e){var t=me(e);(t||t===f)&&(e.items["metadata/system-clipboard-data-ccp-timestamp"]=q)}}function ue(e,t){if(!t||isNaN(t))return e;var r=e;return r||(r={items:{}}),r.items["metadata/system-clipboard-data-ccp-timestamp"]=t.toString(),r}function pe(e){var t=te(e);if(0===t)return!0;var r=0,n=me(e);return(n||n===f)&&(r+=1),r===t}function me(e){if(e)return oe(e,"metadata/system-clipboard-data-ccp-timestamp")}function ge(e){var t=[];if(0===te(e))return t;for(var r in e.items){var n=oe(e,r);n||(n=f);var o={clipboardDataFormat:r,data:n};t.push(o)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.IndexedDB=1]="IndexedDB",e[e.InMemory=2]="InMemory"}(X||(X={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose"}(Z||(Z={}));var fe="sharedClipboardSettings",be=Ie(),he=!1,Ce=1,ve=3600,ye=2;function Se(){if(!he)throw new S("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return be}function we(){he=!1,function(){if(!(window&&fe in window))return be=Ie(),void(he=!0);var e=window[fe];if(!e||"string"!=typeof e)return be=Ie(),void(he=!0);Le(JSON.parse(e))}()}function Ee(e){he=!1,Le(e)}function Le(e){if(!e)throw new v(f,"sharedClipboardSettingsCandidate");var t=Ie();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return be=t,void(he=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return s().ULS.traceTag(596124181,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),be=t,void(he=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,n=r.indexOf(We);n>=0&&(r=r.substr(n+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(e){}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some(function(e){return!e||!e.trim()}))return s().ULS.traceTag(596124182,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],be=t,void(he=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(e){}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some(function(e){return!e||!e.trim()}))return s().ULS.traceTag(596124183,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],be=t,void(he=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return s().ULS.traceTag(596124184,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],be=t,void(he=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return s().ULS.traceTag(596124185,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' or '"+r+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp=f,t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],be=t,void(he=!0)}t.whitelistOriginComponents=!0,be=t,he=!0}function Ie(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:f,sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:Ce,sharedClipboardExpirationInMinutes:ve,clipboardPromiseTimeoutInMinutes:ye}}var Te,_e,Pe="://",xe="http",De="https",je=".",Oe="/",Ae=":",Me=new RegExp("^\\d+$"),We="-",Re=!1;function Ue(e){if(!e)throw new v(f,"origin");var t=e.trim().toLowerCase(),r=f,n=t.split(Pe,3);if(!n||0===n.length||!n[0]||n[0]!==xe&&n[0]!==De)throw new y("Missing protocol","origin",e);if(1===n.length)throw new y("Missing domain","origin",e);if(n.length>2)throw new y("'"+Pe+"' should appear once","origin",e);var o=n[1];if(!o)throw new y("Missing domain","origin",e);if(r=n[0]+Pe,!(n=(o=o.trim()).trim().split(Oe,3))||0===n.length||!n[0]||!n[0].trim())throw new y("Missing domain","origin",e);if(n.length>2)throw new y("The last part of the origin should be the domain","origin",e);if(2===n.length&&n[1])throw new y("The last part of the origin should be the domain","origin",e);if(!(n=o.split(Ae,3))||0===n.length||!n[0]||!n[0].trim())throw new y("Missing domain","origin",e);if(n.length>2||2===n.length&&(!n[1]||!n[1].trim()))throw new y("The last part of the origin should be the domain and an optional port number","origin",e);if(r+=o=n[0].trim(),2===n.length){var i=n[1].trim(),c=Me.exec(i);if(!c||1!==c.length)throw new y("Invalid port number","origin",e);var d=Number(i);if(isNaN(d))throw new y("Invalid port number","origin",e);r+=Ae+i}return s().ULS.traceTag(596452423,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"getValidatedOrigin: origin = '"+e+"'; validated origin = '"+r+"'"),r}function Be(e){He();var t=Ue(e),r=t.split(Pe);if(!r||2!==r.length||!r[0]||!r[1])throw new y("Invalid origin","parentOrigin",e);var n=Se(),o=f;if(n.whitelistOriginComponents){var i=r[0]+Pe;if(!(r=r[1].split(je))||r.length<2||!r[0])throw new y("Invalid origin","parentOrigin",e);r.splice(0,1,n.sharedClipboardHostingApp),o=i+r.join(je)}else o=t;return s().ULS.traceTag(596452424,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"getSharedClipboardValidatedOrigin: app's origin = '"+e+"'; Shared Clipboard iframe origin = '"+o+"'"),o}function Je(e){He();var t=Ue(e),r=Ue(function(){var e=f;return window&&window.location&&window.location.origin&&((e=window.location.origin)||(e=f)),{origin:e}}().origin);if(t===r)return t;if(!Se().whitelistOriginComponents)throw new S("validateOriginForReceivedMessage: Caller origin '"+e+"' doesn't match the current window's origin '"+r+"'");var n=Fe(t),o=Fe(r);if(n.protocol!==o.protocol)throw new S("validateRemoteWindowOrigin: Caller origin's protocol '"+n.protocol+"' doesn't match the current window origin's protocol '"+o.protocol+"'");if(n.environment!==o.environment)throw new S("validateRemoteWindowOrigin: Caller origin's environment '"+n.environment+"' doesn't match the current window origin's environment '"+o.environment+"'");return t}function Fe(e){He();var t=e.split(Pe,2),r=t[0],n=Ne(t[1]),o={protocol:r};if(o.environment=ke(e,n,_e),n.length<=o.environment.length+1)throw new y("Missing app component","origin",e);if(n.charAt(o.environment.length)!==je)throw new y("Missing a domain separator after the environment component","origin",e);var i=n.substr(o.environment.length+je.length);if(o.app=ke(e,i,Te),o.app.length<i.length&&i.charAt(o.app.length)!==We)throw new y("When the Office Online app name is not the domain prefix, '"+We+"' should precede it","origin",e);return o}function Ne(e){if(!e)throw new v(f,"stringToReverse");for(var t=e.length,r=f,n=t-1;n>=0;n-=1)r+=e.charAt(n);return r}function ke(e,t,r){if(!t)throw new v(f,"reversedValidatedHostname");if(!r)throw new v(f,"reversedStringsToLengthMap");var n=t.length,o=Object.keys(r).filter(function(e){var o=r[e];return o<=n&&t.substr(0,o)===e});if(o&&o.length>0)return Ne(o[0]);throw new y("Invalid origin","validatedOrigin",e)}function He(){if(!Re){var e=Se();e.whitelistOriginComponents&&(Te=ze(e.sharedClipboardHostingApps),_e=ze(e.sharedClipboardHostingEnvironments),Re=!0)}}function ze(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach(function(e){t[Ne(e)]=e.length}),t):t}var Ve=1;function Ge(e){void 0===e||null===e?s().ULS.traceTag(595973151,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"validateUserHash: userHash is undefined."):e===Ve&&s().ULS.traceTag(596451804,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"validateUserHash: userHash is set to the default non-user-hash value of "+Ve)}function Ye(e,t){return Ge(t),void 0===e||null===e||e===Ve||void 0===t||null===t||e!==t}function Ke(){return Xe()}function qe(){return Xe()}function Qe(e){if(!e)throw new v(f,"id");var t=e.trim().toLowerCase();if(0===t.length)throw new y(f,"id");return t}function Xe(){return(Math.random()+1).toString(36).substring(7)}function Ze(e,t,r,n){var o={id:e,operationCode:t,userHash:r,clipboardItemsData:n};return et(o),o}function $e(e){return"get"===e||"set"===e||"init"===e}var et=function(e){if(!e)throw new v(f,"clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new v(f,"id");if(!e.operationCode)throw new v(f,"operationCode");if(!$e(e.operationCode))throw new y(f,"operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new y("'"+e.operationCode+"' expects no clipboard items","clipboardItemsData")};function tt(e,t,r,n,o){var i={id:e,operationCode:t,failed:r,error:n,clipboardItemsData:o};return rt(i),i}var rt=function(e){if(!e)throw new v(f,"clipboardOperationResultMessage");if(!e.id||0===e.id.trim().length)throw new v(f,"id");if(!e.operationCode)throw new v(f,"operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode)throw new y(f,"operationCode",e.operationCode);if(e.failed){if(!e.error)throw new y("A failed '"+e.operationCode+"' operation expects a non-empty error argument","error");if(e.clipboardItemsData)throw new y("A failed '"+e.operationCode+"' operation does not expect a clipboardItemsData argument","clipboardItemsData")}else{if(e.error)throw new y("'"+e.operationCode+"' expects an empty error argument","error");if("unknownresult"===e.operationCode)throw new y("'"+e.operationCode+"' can only be used with a failure message","operationCode")}if("getresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new y("'"+e.operationCode+"' expects a clipboardItems argument","clipboardItemsData")}else if(e.clipboardItemsData)throw new y("'"+e.operationCode+"' expects no clipboardItemsData argument","clipboardItemsData")};function nt(e){if(!e||0===e.trim().length)throw new y(f,"className",e);return function(){var t=!1;function r(t){return e+":"+t+": already disposed"}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&s().ULS.traceTag(596456217,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new S(r(e))}}}()}var ot="\n",it=new RegExp("("+ot+"\r)|(\r"+ot+")|(\r)","g"),at=new RegExp("(\t)","g"),st=10240,ct=new RegExp("<","g"),dt="&lt;",lt=new RegExp(">","g"),ut="&gt;",pt="div",mt="pre",gt="table",ft="tr",bt="td",ht="\x3c!--StartFragment--\x3e",Ct="\x3c!--EndFragment--\x3e",vt=ht.length,yt=Ct.length,St="Version:0.9"+ot+"StartHTML:0000000100"+ot+"EndHTML:{EndHTML0}"+ot+"StartFragment:0000000134"+ot+"EndFragment:{EndFragm}"+ot+"<html>"+ot+"<body>"+ot+ht+ot,wt=""+Ct+ot+"</body>"+ot+"</html>",Et="0000000000",Lt="</html>".length,It="data-ccp-timestamp",Tt=0;function _t(e){return e?e.replace(it,ot):e}function Pt(e){return e?e.length<=st?e:e.substr(0,st):f}function xt(e){if(0!==re(e)){var t=Date.now();ce(e.getData())||e.setItem("metadata/system-clipboard-data-ccp-timestamp",t.toString());var r=se(e);if(!ie(r,K)){var n=ae(r),o=Dt(mt,n,t);e.setItem(K,o)}}}function Dt(e,t,r){if(r!==Tt&&!r)throw new v(f,"timestamp");if(isNaN(r))throw new y(f,"timestamp",r.toString());var n=function(e){return e?e.replace(it,"</"+bt+"></"+ft+"><"+ft+"><"+bt+">"):e}(function(e){return e?e.replace(at,"</"+bt+"><"+bt+">"):e}(At(t))),o="<"+e+" "+It+"='"+r+"'><"+gt+"><"+ft+"><"+bt+">"+n+"</"+bt+"></"+ft+"></"+gt+"></"+e+">";return!N()||H()?o:function(e){var t=Et.length,r=St.length+e.length+wt.length,n=(r-wt.length).toString();n.length<t&&(n=Et.substr(0,t-n.length)+n);if(n.length!==t){var o="addClipboardWrapper: the string representation of the opening bracket position of the End Fragment xml comment is "+n.length+" but it should be "+t;throw s().ULS.shipAssertTag(596128536,a.LogCategory.msoulscat_ES_EWAJS,!1,o),new x(l.UnexpectedClipboardTextHtmlContentLength,o)}var i=(r-Lt).toString();i.length<t&&(i=Et.substr(0,t-i.length)+i);if(i.length!==t){var o="addClipboardWrapper: the string representation of the opening bracket position of the End Html tag is "+i.length+" but it should be "+t;throw s().ULS.shipAssertTag(596128537,a.LogCategory.msoulscat_ES_EWAJS,!1,o),new x(l.UnexpectedClipboardTextHtmlContentLength,o)}var c=St.replace("{EndHTML0}",i).replace("{EndFragm}",n)+e+wt;return s().ULS.shipAssertTag(596128538,a.LogCategory.msoulscat_ES_EWAJS,c.length===r,"addClipboardWrapper: The resulting text/html payload length of "+c.length+" differs from the expected length of "+r),c}(o)}function jt(e){if(!e)return f;if(!e.trim())return e;var t=e.indexOf(ht),r=e.indexOf(Ct);if(t<0||r<0||t>r)return e;var n=t+vt,o=r-n,i=e.indexOf(ht,n),a=e.indexOf(Ct,r+yt);return i>=0||a>=0?e:e.substr(n,o)}function Ot(e){var t=function(e,t,r){if(!t||!t.trim())return;if(!r||!r.trim())throw new v(f,"attributeName");var n=new RegExp("<"+e+" "+r+"=['\"](\\d+)['\"][ >]?","i").exec(t);if(!n||n.length<2)return;return n[1]}(mt,e,It);if(t&&t.trim()){var r=Number(t);if((r||r===Tt)&&!isNaN(r))return r}}function At(e){return e?e.replace(ct,dt).replace(lt,ut):f}var Mt=function(){function e(e){this.clipboardStrategyType=e,this.disposableImplementationExtension=nt(""+e)}return e.prototype.initialize=function(e){var t=this;return e.then(function(e){return t.clipboardStorage=e,s().ULS.traceTag(596453007,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Clipboard strategy type '"+t.clipboardStrategyType+"' was initialized."),Promise.resolve(t)},function(e){return s().ULS.traceTag(596453008,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"Failed to initialize clipboard strategy type '"+t.clipboardStrategyType+"'. Error: "+a.utils.getStringifiedError(e)),Promise.reject(e)})},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121485,a.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new x(l.ClipboardStrategyNotInitialized))}return xt(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new x(l.SetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").set",e))}},e.prototype.get=function(e){try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return s().ULS.shipAssertTag(596121486,a.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new x(l.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e)}catch(e){return Promise.reject(new x(l.GetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").get",e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),Wt=function(){function e(e){this.clipboardStorageType=e}return e.prototype.setMetadataAndCacheItems=function(e,t,r){var n=this,o=void 0;if(e&&e.found&&e.result){var i=e.result.lastSystemClipboardDataCcpTimestamp;i&&!isNaN(i)&&1!==i&&(o=i)}if(!t||0===re(t))return this.clear().then(function(){if(!o)return Promise.resolve();var e={id:"2",userHash:r.userHash,lastSystemClipboardDataCcpTimestamp:o};return n.setItem(e)});var a=ce(t.getData());a&&(1!==a&&(o=a),de(t.getData()));var s=Date.now(),c={id:"2",created:s,lastUsed:s,userHash:r.userHash,lastSystemClipboardDataCcpTimestamp:o},d={id:"1",clipboardItemsData:t.getData()};return this.setItem(c).then(function(){return n.setItem(d)})},e.prototype.getCacheItemsAndUpdateMetadata=function(e){var t=this,r=ee();return this.getItem("2").then(function(n){if(n&&n.found&&n.result){var o=n.result,i=o.userHash,c=e&&e.userHash;return t.clearClipboardNecessary(i,c)?t.clear().then(function(){return Promise.resolve(r)}):t.getItem("1").then(function(e){if(e&&e.found&&e.result){var n=e.result.clipboardItemsData;return s().ULS.traceTag(595952592,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"getCacheItemsAndUpdateMetadata: item count="+te(n)),o.lastUsed=Date.now(),t.setItem(o).then(function(){return n=ue(n,o.lastSystemClipboardDataCcpTimestamp),Promise.resolve(ne(n))})}return Promise.resolve(r)})}return Promise.resolve(r)})},e.prototype.clearClipboardNecessary=function(e,t){return!1},e}(),Rt=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function Ut(e){var t=e;return t&&0!==t.trim().length||(t=Ke()),new Nt(t)}function Bt(){return Rt?window.performance.now():Date.now()}function Jt(e){return Rt?new Date(e+window.performance.timing.navigationStart):new Date(e)}function Ft(e,t,r){if(!r)throw new v(f,"creationTimestamp");return(e?"Fulfilled":"Still unfulfilled")+" after "+(e?t?t-r:"?":Bt()-r)+"ms"}var Nt=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=Qe(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=Bt(),s().ULS.traceTag(596456225,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise: creating deferred promise #"+this.sequenceId+" with id '"+this.id+"' on "+Jt(this.creationTimestamp)),this.promise=new Promise(function(e,t){s().ULS.traceTag(596456226,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise: registering callback for promise #"+r.sequenceId+" with id '"+r.id+"' on "+Jt(Bt())),r.internalResolve=e,r.internalReject=t})}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):s().ULS.traceTag(596456257,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):s().ULS.traceTag(596456260,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=Bt(),s().ULS.traceTag(596456261,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise: marking promise #"+this.sequenceId+" with id '"+this.id+"' as fulfilled ("+(this.rejected?"rejected":"resolved")+"). "+Ft(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)))},e.prototype.fulfillmentCheck=function(e){return s().ULS.traceTag(596456258,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise: asked to "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"'"),this.isFulfilled&&s().ULS.traceTag(596456259,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"Deferred promise: cannot "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"' since it was "+(this.rejected?"rejected":"resolved")+" already on "+Jt(this.fulfillmentTimestamp)+". "+Ft(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)),this.isFulfilled},e.sequenceId=0,e}();function kt(){return new Ht}var Ht=function(){function e(){this.deferredResultMessagePromiseCache={}}return e.prototype.getDeferredPromise=function(e){var t=Qe(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return s().ULS.traceTag(596456218,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '"+e+"'."),t.promise;s().ULS.traceTag(596456219,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '"+e+"'.")},e.prototype.addNewPromise=function(e){var t=Ut(e);if(this.getDeferredPromise(t.id))throw new y("A deferred promise already exists in the cache for the specified id","id",t.id);var r=Qe(t.id);return this.deferredResultMessagePromiseCache[r]=t,s().ULS.traceTag(596456220,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '"+t.id+"'."),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=Qe(e);delete this.deferredResultMessagePromiseCache[t],s().ULS.traceTag(596456222,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: deleted id '"+e+"'.")}else s().ULS.traceTag(596456221,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '"+e+"' since this id is not associated with an existing deferred promise.")},e.prototype.clear=function(){if(s().ULS.traceTag(596456223,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Deferred promise cache: clearing "+this.getLength()+" items from the cache"),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){s().ULS.traceTag(596456224,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '"+e+"' with this exception: "+t.message+". Ignoring.")}}this.deferredResultMessagePromiseCache={}},e}();function zt(e){if(!e)throw new v(f,"validator");return{deserialize:function(t){return function(e,t){if(!e)throw new v(f,"incomingMessage");if(!t)throw new v(f,"validator");if(0===e.length)throw new y("An empty message is invalid","incomingMessage");var r,n=e.trim();if(0===n.length)throw new y("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(n)}catch(t){throw new y("Deserialization failed","incomingMessage","Contains "+e.length.toString()+" characters",t)}if(!r)throw new y("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function Vt(e){if(!e)throw new v(f,"validator");return{serialize:function(t){return function(e,t){if(!e)throw new v(f,"outgoingMessage");if(!t)throw new v(f,"validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new y("Serialization failed","outgoingMessage",Object.keys(e).length+" properties",t)}return s().ULS.traceTag(596452375,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"The length of the serialized message is "+t.length),t}(e)}(t,e)}}}function Gt(e){if(!e)throw new v(f,"remoteWindow");if(!("window"in e&&e.window))throw new v(f,"remoteWindow.window");if(!("windowOrigin"in e&&e.windowOrigin))throw new v(f,"remoteWindow.windowOrigin");var t=Je(e.windowOrigin);return{window:e.window,windowOrigin:t}}var Yt=function(){function e(e,t,r,n){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=nt(n)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(j([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new v(f,"outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw s().ULS.shipAssertTag(596121484,a.LogCategory.msoulscat_ES_EWAJS,!1,t),new S(t)}this.sender.postMessage(e)},e}();function Kt(){return qt}var qt={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};function Qt(e,t,r){return new $t(e,t,r)}function Xt(e,t,r){return new $t(e,t,r)}var Zt="message",$t=function(){function e(e,t,r){var n=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return n.onMessageReceived(e)},!e)throw new v(f,"deserializer");if(!t)throw new v(f,"handler");if(!r)throw new v(f,"windowRPC");this.disposableImplementationExtension=nt("WindowRPCReceiverInternal"),this.remoteWindow=r.remoteWindow,Kt().addEventListener(Zt,this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(Kt().removeEventListener(Zt,this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return s().ULS.traceTag(596452370,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return s().ULS.traceTag(596452371,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(this.remoteWindow.window&&e.source!==this.remoteWindow.window)return s().ULS.traceTag(596452372,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return s().ULS.traceTag(596452373,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){s().ULS.traceTag(596452374,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"Window RPC Receiver: unable to deserialize incoming message. "+a.utils.getStringifiedError(e));try{this.handler.handleDeserializationError(a.utils.getStringifiedError(e))}catch(e){s().ULS.traceTag(596452184,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. "+a.utils.getStringifiedError(e))}return}if(t)try{this.handler.handleMessage(t).catch(function(e){s().ULS.traceTag(595985880,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+a.utils.getStringifiedError(e))})}catch(e){s().ULS.traceTag(596452186,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+a.utils.getStringifiedError(e))}else s().ULS.traceTag(596452185,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();function er(e,t){return new rr(e,t)}function tr(e,t){return new rr(e,t)}var rr=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new v(f,"serializer");if(!t)throw new v(f,"windowRPC");this.disposableImplementationExtension=nt("WindowRPCSenderInternal"),this.remoteWindow=t.remoteWindow}return e.prototype.postMessage=function(e){if(!e)throw new v(f,"outgoingMessage");if(!this.remoteWindow.window)throw new S("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new S("The remote window does not support postMessage");var t=this.serializer.serialize(e);z().postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function nr(){try{return localStorage.setItem("XLO_CCP","1"),"1"===localStorage.getItem("XLO_CCP")}catch(e){return!1}}r.d(t,"Mb",function(){return s}),r.d(t,"ob",function(){return c}),r.d(t,"sb",function(){return b}),r.d(t,"tb",function(){return h}),r.d(t,"a",function(){return C}),r.d(t,"t",function(){return v}),r.d(t,"r",function(){return y}),r.d(t,"s",function(){return S}),r.d(t,"B",function(){return w}),r.d(t,"A",function(){return E}),r.d(t,"b",function(){return I}),r.d(t,"m",function(){return T}),r.d(t,"x",function(){return _}),r.d(t,"c",function(){return P}),r.d(t,"e",function(){return x}),r.d(t,"z",function(){return D}),r.d(t,"Hb",function(){return j}),r.d(t,"nb",function(){return W}),r.d(t,"xb",function(){return F}),r.d(t,"ub",function(){return N}),r.d(t,"wb",function(){return k}),r.d(t,"vb",function(){return H}),r.d(t,"lb",function(){return z}),r.d(t,"Y",function(){return f}),r.d(t,"Fb",function(){return" "}),r.d(t,"Eb",function(){return"."}),r.d(t,"Cb",function(){return"1"}),r.d(t,"j",function(){return d}),r.d(t,"k",function(){return"copy"}),r.d(t,"o",function(){return"cut"}),r.d(t,"v",function(){return"paste"}),r.d(t,"l",function(){return"copy"}),r.d(t,"p",function(){return"cut"}),r.d(t,"w",function(){return"paste"}),r.d(t,"D",function(){return G}),r.d(t,"F",function(){return"1"}),r.d(t,"Bb",function(){return"2"}),r.d(t,"V",function(){return Y}),r.d(t,"W",function(){return"Text"}),r.d(t,"Lb",function(){return K}),r.d(t,"Ab",function(){return"metadata/is-last-copy-was-external"}),r.d(t,"Db",function(){return"metadata/system-clipboard-data-ccp-timestamp"}),r.d(t,"qb",function(){return 1}),r.d(t,"rb",function(){return q}),r.d(t,"fb",function(){return Q}),r.d(t,"gb",function(){return ee}),r.d(t,"db",function(){return te}),r.d(t,"cb",function(){return re}),r.d(t,"G",function(){return ne}),r.d(t,"bb",function(){return oe}),r.d(t,"ab",function(){return ie}),r.d(t,"eb",function(){return ae}),r.d(t,"hb",function(){return se}),r.d(t,"ib",function(){return ce}),r.d(t,"X",function(){return de}),r.d(t,"Ib",function(){return le}),r.d(t,"E",function(){return ue}),r.d(t,"Gb",function(){return pe}),r.d(t,"h",function(){return X}),r.d(t,"q",function(){return Z}),r.d(t,"f",function(){return l}),r.d(t,"n",function(){return u}),r.d(t,"y",function(){return p}),r.d(t,"d",function(){return m}),r.d(t,"U",function(){return We}),r.d(t,"jb",function(){return Be}),r.d(t,"Qb",function(){return Je}),r.d(t,"u",function(){return Ve}),r.d(t,"Rb",function(){return Ge}),r.d(t,"Kb",function(){return Ye}),r.d(t,"O",function(){return Ke}),r.d(t,"J",function(){return qe}),r.d(t,"Z",function(){return Qe}),r.d(t,"H",function(){return Ze}),r.d(t,"zb",function(){return $e}),r.d(t,"Ob",function(){return et}),r.d(t,"I",function(){return tt}),r.d(t,"Pb",function(){return rt}),r.d(t,"i",function(){return Mt}),r.d(t,"g",function(){return Wt}),r.d(t,"K",function(){return Ut}),r.d(t,"L",function(){return kt}),r.d(t,"M",function(){return nt}),r.d(t,"N",function(){return zt}),r.d(t,"P",function(){return Vt}),r.d(t,"pb",function(){return"initmessageid"}),r.d(t,"Nb",function(){return"unknownmessageid"}),r.d(t,"kb",function(){return Gt}),r.d(t,"C",function(){return Yt}),r.d(t,"S",function(){return Qt}),r.d(t,"Q",function(){return Xt}),r.d(t,"T",function(){return er}),r.d(t,"R",function(){return tr}),r.d(t,"yb",function(){return nr}),r.d(t,"mb",function(){return o}),r.d(t,"Jb",function(){return n})},1:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10);t.utils=n;var o=r(33);t.idbPromised=o;var i=r(11);t.ULS=i.ULS,t.TraceLevel=i.TraceLevel,t.LogCategory=i.LogCategory,t.NulLogger=i.NulLogger,t.ConsoleLogger=i.ConsoleLogger;var a=r(17);t.browserSupport=a;var s=r(18);t.perfWatch=s;var c=r(34);t.initEwaUtils=c.initEwaUtils,t.ewaUtils=c.ewaUtils;var d=r(35);t.initStopwatchFactory=d.initStopwatchFactory},10:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachPromise=function(e,t,r){return e.reduce(function(e,n){return e.then(function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)})},Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){if(void 0===r&&(r=0),r<0||r>n)return t;if(null===t||void 0===t||"object"!=typeof t)return t;var o={};Object.getOwnPropertyNames(t).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])});var i=Object.getPrototypeOf(t);i&&"object"==typeof i&&Object.keys(i).forEach(function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])});var a={};return Object.keys(o).forEach(function(t){a[t]=e(o[t],r+1)}),a}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=5;var o="_",i=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(i,o).substring(0,80);return t&&t.length>0&&t.substr(t.length-1,1)===o&&(t=t.substr(0,t.length-1)),t&&t.length>0&&t.substr(0,1)===o&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(void 0),n=function(t){r=r.catch(function(r){return e(t,r)})},o=1;o<=t;o+=1)n(o);return r}},11:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,o){return t.traceTag(e,r,n,o)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,o){return t.debugTraceTag(e,r,n,o)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,o){return t.assertTag(e,r,n,o)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,o){return t.shipAssertTag(e,r,n,o)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var o=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e}();t.NulLogger=o},17:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={},o="promises";t.promises=function(){return void 0===n[o]&&(n[o]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n[o]}},18:function(e,t,r){"use strict";function n(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function o(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.start=function(e){var t=e,r=n(),i={},a=function(e,n,a){return function(e,t,r,n,i,a){o(e,"end",r);var s={sessionName:t,result:n?"success":"failure",message:a,marks:e},c=JSON.stringify(s);i(c)}(i,t,r,e,n,a)};return i.start=0,{mark:function(e){return function(e){return o(i,e,r)}(e)},end:function(e){return a(!0,e)},success:function(e,t){return a(!0,e,t)},failure:function(e,t){return a(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)}},2:function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return o}),r.d(t,"__assign",function(){return i}),r.d(t,"__rest",function(){return a}),r.d(t,"__decorate",function(){return s}),r.d(t,"__param",function(){return c}),r.d(t,"__metadata",function(){return d}),r.d(t,"__awaiter",function(){return l}),r.d(t,"__generator",function(){return u}),r.d(t,"__exportStar",function(){return p}),r.d(t,"__values",function(){return m}),r.d(t,"__read",function(){return g}),r.d(t,"__spread",function(){return f}),r.d(t,"__await",function(){return b}),r.d(t,"__asyncGenerator",function(){return h}),r.d(t,"__asyncDelegator",function(){return C}),r.d(t,"__asyncValues",function(){return v}),r.d(t,"__makeTemplateObject",function(){return y}),r.d(t,"__importStar",function(){return S}),r.d(t,"__importDefault",function(){return w});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}function s(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(a,s)}c((n=n.apply(e,t||[])).next())})}function u(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function p(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function m(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function f(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function h(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){i.push([e,t,r,n])>1||s(e,t)})})}function s(e,t){try{!function(e){e.value instanceof b?Promise.resolve(e.value.v).then(c,d):l(i[0][2],e)}(o[e](t))}catch(e){l(i[0][3],e)}}function c(e){s("next",e)}function d(e){s("throw",e)}function l(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}}function C(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:b(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function v(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=m(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}}function y(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function w(e){return e&&e.__esModule?e:{default:e}}},33:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(10);function i(e,t,r){return e?!(t&&!e.objectStoreNames.contains(t))||(r({name:"ValidationError",message:"The database doesn't contain store name: "+t}),!1):(r({name:"ValidationError",message:"The database should be initialized"}),!1)}var a=void 0;function s(e){void 0!==a&&a(e)}function c(e,t,r,n){return new Promise(function(o,a){if(i(e,t,a)){var s,c=e.transaction([t],r);c.oncomplete=function(){return o()},c.onerror=function(){return a(s||c.error)},c.onabort=function(){return a(s||c.error)};var d=c.objectStore(t),l=n(d);l.onerror=function(){s=l.error}}})}t.registerTraceSubscriber=function(e){a=e},t.clearTraceSubscriber=function(){a=void 0},t.setTestDbFactory=function(e){n=e},t.getDbFactory=function(){if(n)return n;try{if(window&&"indexedDB"in window&&void 0!==window.indexedDB)return window.indexedDB}catch(r){var e=o.getStringifiedError(r);e&&e!==o.defaultToJSONResultWhenStringifyFails||!r||!r.message||(e=r.message);var t=o.getPerfWatchMarkName(e);s("indexedDB_access_error"+(t&&t.length>0?"_":"")+t)}},t.getStoreReadinessPromise=function(e){return new Promise(function(t,r){e.transaction.oncomplete=function(){return t()},e.transaction.onerror=function(){return r(e.transaction.error)}})},t.initDb=function(e,t,r,n){return new Promise(function(o,i){s("idb_open");var a=r||0===r?e.open(t,r):e.open(t),c=function(e){var t=!1,r=!1,n=function(e){s("idb_open_"+e)},a=function(){return r?(n("already_resolved"),!1):!t||(n("already_rejected"),!1)};return{rejectOnce:function(e){n("should_reject"),a()&&(n("rejecting"),t=!0,i(e))},resolveOnce:function(e){n("should_resolve"),a()&&(n("resolving"),r=!0,o(e))}}}();a.onupgradeneeded=function(e){s("idb_open_onupgradeneeded_start");var r=e.target.result;if(e.oldVersion>0&&function(e){s("idb_open_onupgradeneeded_deleteAllObjectStores");for(var t=[],r=e.objectStoreNames.length-1;r>=0;r-=1){var n=e.objectStoreNames.item(r);(n||""===n)&&t.push(n)}t.forEach(function(t){s("idb_open_onupgradeneeded_delete_store_"+t),e.deleteObjectStore(t)})}(r),n){s("idb_open_onupgradeneeded_create_stores");var o=n(r);o&&o.length>0&&Promise.all(o).then(function(){s("idb_open_onupgradeneeded_stores_ready"),c.resolveOnce({db:r,dbName:t})},function(e){s("idb_open_onupgradeneeded_stores_ready_error"),c.rejectOnce(e)})}s("idb_open_onupgradeneeded_end")},a.onsuccess=function(e){s("idb_open_onsuccess"),c.resolveOnce({db:e.target.result,dbName:t})},a.onerror=function(){s("idb_open_onerror"),c.rejectOnce(a.error)},a.onblocked=function(e){s("idb_open_onblocked"),c.rejectOnce(e)}})},t.deleteDb=function(e,t){return new Promise(function(r,n){var o=e.deleteDatabase(t);o.onsuccess=function(){return r()},o.onblocked=function(){return r()},o.onerror=function(){return n(o.error)}})},t.doTransactionAction=c,t.put=function(e,t,r,n){return c(e,t,"readwrite",function(e){return r?e.put(n,r):e.put(n)})},t.get=function(e,t,r){return new Promise(function(n,o){if(i(e,void 0,o)){var a;e.objectStoreNames.contains(t)||n(void 0);var s=void 0,c=e.transaction([t],"readonly");c.oncomplete=function(){return n(s)},c.onerror=function(){return o(a||c.error)},c.onabort=function(){return o(a||c.error)};var d=c.objectStore(t).get(r);d.onsuccess=function(e){s=e.target.result},d.onerror=function(){a=d.error}}})},t.getAllItems=function(e,t){return new Promise(function(r,n){if(i(e,t,n)){var o,a=[],s=e.transaction([t],"readonly");s.oncomplete=function(){return r(a)},s.onerror=function(){return n(o||s.error)},s.onabort=function(){return n(o||s.error)};var c=s.objectStore(t).openCursor();c.onsuccess=function(e){var t=e.target.result;t&&(a.push(t.value),t.continue())},c.onerror=function(){o=c.error}}})},t.getAllKeys=function(e,t){return new Promise(function(r,n){if(i(e,t,n)){var o,a=[],s=e.transaction([t],"readonly");s.oncomplete=function(){return r(a)},s.onerror=function(){return n(o||s.error)},s.onabort=function(){return n(o||s.error)};var c=s.objectStore(t).openCursor();c.onsuccess=function(e){var t=e.target.result;t&&(a.push(t.key),t.continue())},c.onerror=function(){o=c.error}}})},t.remove=function(e,t,r){return c(e,t,"readwrite",function(e){return e.delete(r)})},t.removeAll=function(e,t){return c(e,t,"readwrite",function(e){return e.clear()})}},34:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return n},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");n=e}},35:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),window.performance&&window.performance.now&&(n=function(){return window.performance.now()}),function(r){var o=n(),i=r;return{reset:function(e){null!=e&&(i=e),o=n()},stop:function(){var r=n()-o,a=JSON.stringify({Target:i,Duration:r.toFixed(t)});e(a)}}}}},392:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r(2),i=r(1),a=!0;function s(){return a}function c(){a=!1}var d=!0;function l(){return d}function u(){d=!1}function p(){var e=void 0;try{e=window.clipboardData}catch(e){Object(n.Mb)().ULS.traceTag(595985225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"ieSystemClipboard.getDataTransfer: An error occurred when attempting to access window.clipboardData. Error: "+i.utils.getStringifiedError(e))}return e}function m(){if(Object(n.Mb)().ULS.shipAssertTag(596455701,i.LogCategory.msoulscat_ES_EWAJS,Object(n.xb)(),"The browser must be IE"),!Object(n.xb)())throw new n.s("The browser must be IE")}var g="command",f="copy",b="paste",h="object",C=!1,v=!0,y=void 0;function S(){if(void 0===y&&(y=!1,"chrome"in window)){var e=window.chrome;e&&("runtime"in e&&e.runtime?"sendMessage"in e.runtime&&e.runtime.sendMessage?y=!0:Object(n.Mb)().ULS.traceTag(596455703,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"chrome.runtime.sendMessage is not available"):Object(n.Mb)().ULS.traceTag(596455704,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"chrome.runtime is not available"))}return y}var w=new RegExp("</"+n.mb.divTagName+"><"+n.mb.divTagName+">","g"),E="</"+n.mb.divTagName+">\\n<"+n.mb.divTagName+">";function L(e){if(!S())return Promise.reject(new n.e(n.f.MissingBrowserExtensionCapability));var t=Ee().getChromeExtensionIds();if(0===t.length)return Promise.reject(new n.e(n.f.NoBrowserExtensionsInConfiguration));var r=n.Y;if(Object(n.db)(e)>0){var o=Object(n.bb)(e,n.V);if(o){o=n.mb.encodeAngleBrackets(o);var a=Date.now(),s=Object(n.bb)(e,n.Lb);if(Object(n.Mb)().ULS.shipAssertTag(596444116,i.LogCategory.msoulscat_ES_EWAJS,!!s,"chromeSystemClipboard - '"+f+"': cannot find a text/html clipboard item"),s){var c=n.mb.getCcpTimestampHtmlCustomAttributeFromWrappingTag(s);Object(n.Mb)().ULS.shipAssertTag(596444117,i.LogCategory.msoulscat_ES_EWAJS,!!c,"chromeSystemClipboard - '"+f+"': cannot find the 'data-ccp-timestamp' HTML custom attribute in the text/html clipboard item"),c&&(a=c)}r=n.mb.createTextHtmlFromTextPlain(n.mb.preWrappingTagName,o,a)}}var d={};return d[g]=f,d[h]=r,t.reduce(function(e,t){return e.then(function(e){var r="chromeSystemClipboard: browser extension '"+t+"' will not be called since the previous extension was called successfully with command '"+f+"'";return Object(n.Mb)().ULS.assertTag(596455705,i.LogCategory.msoulscat_ES_EWAJS,!e,r),Object(n.Mb)().ULS.traceTag(595985886,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,r),C},function(e){return Object(n.Mb)().ULS.traceTag(596455706,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"chromeSystemClipboard: browser extension '"+t+"' will be called with command '"+f+"'"),Promise.resolve(v)}).then(function(e){return e?function(e,t){return new Promise(function(r,o){window.chrome.runtime.sendMessage(e,t,void 0,function(t){var i=window.chrome.runtime.lastError;if(i){var a=n.Y;"message"in i&&"string"==typeof i.message&&(a=i.message),o(new n.e(n.f.UnavailableBrowserExtension,"chromeSystemClipboard - '"+f+"': browser extension '"+e+"' is not available. Error: "+a))}else r(C)})})}(t,d):Promise.resolve(C)})},Promise.reject(void 0)).then(function(e){return e?Promise.reject(new n.e(n.f.NoAvailableBrowserExtensions)):Promise.resolve()})}function I(){if(!S())return Promise.reject(new n.e(n.f.MissingBrowserExtensionCapability));var e=Ee().getChromeExtensionIds();if(0===e.length)return Promise.reject(new n.e(n.f.NoBrowserExtensionsInConfiguration));var t={};return t[g]=b,e.reduce(function(e,r){return e.then(function(e){var t="chromeSystemClipboard: browser extension '"+r+"' will not be called since the previous extension was called successfully with command '"+b+"'";return Object(n.Mb)().ULS.assertTag(595985887,i.LogCategory.msoulscat_ES_EWAJS,!!e&&!e.tryTheNextExtension,t),Object(n.Mb)().ULS.traceTag(596455707,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t),e},function(e){return Object(n.Mb)().ULS.traceTag(596455708,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"chromeSystemClipboard: browser extension '"+r+"' will be called with command '"+b+"'"),Promise.resolve({tryTheNextExtension:!0,text:n.Y,html:n.Y})}).then(function(e){return e.tryTheNextExtension?function(e,t){return new Promise(function(r,o){window.chrome.runtime.sendMessage(e,t,void 0,function(t){var i=window.chrome.runtime.lastError;if(!t&&t!==n.Y||"string"!=typeof t||i){var a=n.Y;"message"in i&&"string"==typeof i.message&&(a=i.message),o(new n.e(n.f.UnavailableBrowserExtension,"chromeSystemClipboard - '"+b+"': browser extension '"+e+"' is not available. Error: "+a))}else{var s=t,c=document.createElement(n.mb.divTagName),d=s.replace(w,E);c.innerHTML=d,r({tryTheNextExtension:!1,text:c.innerText,html:s})}})})}(r,t):Promise.resolve(e)})},Promise.reject(void 0)).then(function(e){if(!e||!("tryTheNextExtension"in e)||e.tryTheNextExtension)return Promise.reject(new n.e(n.f.NoAvailableBrowserExtensions));var t=Object(n.G)();return t.setItem(n.V,e.text),t.setItem(n.Lb,e.html),t})}function T(e){return!!(e&&e.setData&&e.getData)}function _(e){if(e){var t=void 0;try{t=e.clipboardData}catch(e){throw Object(n.Mb)().ULS.traceTag(595985224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"systemClipboard.getDataTransfer: An error occurred when attempting to access rawEvent.clipboardData. Error: "+i.utils.getStringifiedError(e)),e}return t}Object(n.Mb)().ULS.traceTag(596456320,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"A clipboard event parameter is missing")}function P(e,t,r,o){var a=!1;try{var s=_(r);if(!s||!T(s))return Object(n.Mb)().ULS.traceTag(596456264,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"setData - programmatic "+n.k+" and "+n.o+" is broken. There is no valid data transfer object. clipboardDataFormat = '"+e+"'"),!1;!1===(a=s.setData(e,t))&&Object(n.Mb)().ULS.traceTag(596456265,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"setData returned false for '"+e+"'.")}catch(t){Object(n.Mb)().ULS.traceTag(596456266,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"setData with '"+e+"' threw an exception: "+i.utils.getStringifiedError(t))}return void 0===a&&(a=!0),a}function x(e,t,r,o){if(m(),!o&&!s()&&!l())return Object(n.Mb)().ULS.traceTag(596456269,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"setData - programmatic "+n.k+" and "+n.o+" clipboard access is not supported. rawEvent is empty = "+!!r),!1;var a=p();if(!a||!T(a))return Object(n.Mb)().ULS.traceTag(596456270,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"setData - "+n.k+" and "+n.o+" is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '"+e+"'"),o||(Object(n.Mb)().ULS.shipAssertTag(596456271,i.LogCategory.msoulscat_ES_EWAJS,s()&&l(),"setData - programmatic "+n.k+" and "+n.o+" is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '"+s()+"'. isProgrammaticAccessSupported = '"+l()+"'. clipboardDataFormat = '"+e+"'"),c(),u()),!1;var d,g=e;g===n.V&&(g=n.W);try{!1===(d=a.setData(g,t))&&Object(n.Mb)().ULS.traceTag(596456272,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"setData returned false for '"+g+"'.")}catch(e){Object(n.Mb)().ULS.traceTag(596456273,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"setData with '"+g+"' threw an exception: "+e.message)}return!o&&s()&&(c(),!1===d&&u()),void 0===d&&(d=!0),d}function D(){return s()&&x(n.V,n.Y,void 0,!1),!!l()||(Object(n.Mb)().ULS.traceTag(596456274,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"document.execCommand - programmatic clipboard access is not allowed for '"+n.k+"' and '"+n.o+"'."),!1)}var j={execCommandCopy:function(){var e;try{e=document.execCommand(n.k,!1,null)}catch(e){Object(n.Mb)().ULS.traceTag(596456262,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"document.execCommand('"+n.k+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return void 0===e&&(e=!0),e},execCommandCut:function(){var e;try{e=document.execCommand(n.o,!1,null)}catch(e){Object(n.Mb)().ULS.traceTag(596456263,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"document.execCommand('"+n.o+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return void 0===e&&(e=!0),e},setData:P,browserExtensionCopy:function(e){return Promise.reject(new n.e(n.f.NoBrowserExtensionsInConfiguration))},defaultClipboardDataFormat:n.V},O={execCommandCopy:function(){if(m(),!D())return!1;try{document.execCommand(n.k,!1,null)}catch(e){Object(n.Mb)().ULS.traceTag(596456267,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"document.execCommand('"+n.k+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return!0},execCommandCut:function(){if(m(),!D())return!1;try{document.execCommand(n.o,!1,null)}catch(e){Object(n.Mb)().ULS.traceTag(596456268,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"document.execCommand('"+n.o+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return!0},setData:x,browserExtensionCopy:function(e){return Promise.reject(new n.e(n.f.NoBrowserExtensionsInConfiguration))},defaultClipboardDataFormat:n.W},A={execCommandCopy:function(){var e=!1;try{void 0===(e=document.execCommand(n.k,!1,null))&&(e=!0)}catch(e){Object(n.Mb)().ULS.traceTag(596455647,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Chrome: document.execCommand('"+n.k+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return e},execCommandCut:function(){var e=!1;try{void 0===(e=document.execCommand(n.o,!1,null))&&(e=!0)}catch(e){Object(n.Mb)().ULS.traceTag(596455648,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Chrome: document.execCommand('"+n.o+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return e},setData:function(e,t,r,o){var a=!1;try{var s=_(r);if(!s||!T(s))return Object(n.Mb)().ULS.traceTag(596455649,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Chrome: setData - programmatic "+n.k+" and "+n.o+" is broken. There is no valid data transfer object. clipboardDataFormat = '"+e+"'"),!1;void 0===(a=s.setData(e,t))?a=!0:a||Object(n.Mb)().ULS.traceTag(596455650,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Chrome: setData returned false for '"+e+"'.")}catch(t){Object(n.Mb)().ULS.traceTag(596455651,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Chrome: setData with '"+e+"' threw an exception: "+i.utils.getStringifiedError(t))}return a},browserExtensionCopy:function(e){return L(e)},defaultClipboardDataFormat:n.V},M=void 0;function W(e,t,r,n){return R().setData(e,t,r,n)}function R(){return void 0===M&&(M=S()?A:j),M}function U(e,t,r){if(m(),!r&&!s()&&!l())return Object(n.Mb)().ULS.traceTag(596456327,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getData - programmatic "+n.v+" clipboard access is not supported. rawEvent is empty = "+!!t),n.Y;var o=p();if(!o||!T(o))return Object(n.Mb)().ULS.traceTag(596456328,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"getData - "+n.v+" is broken. There is no valid global data transfer object. Do not try again to fetch it. clipboardDataFormat = '"+e+"'"),r||(Object(n.Mb)().ULS.shipAssertTag(596456329,i.LogCategory.msoulscat_ES_EWAJS,s()&&l(),"getData - programmatic "+n.v+" is broken because the global data transfer object was previously available and now it's not available. isBeforeFirstProgrammaticAccess = '"+s()+"'. isProgrammaticAccessSupported = '"+l()+"'. clipboardDataFormat = '"+e+"'"),c(),u()),n.Y;var a=e;a===n.V&&(a=n.W);var d=n.Y;try{(d=o.getData(a))||(d=n.Y),Object(n.Mb)().ULS.traceTag(596456330,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getData('"+a+"') returned "+d.length+" characters")}catch(e){Object(n.Mb)().ULS.traceTag(596456331,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getData with '"+a+"' threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return!r&&s()&&(c(),d===n.Y&&(P(e,n.Fb,void 0)?U(e,void 0,!1)===n.Y?u():P(e,n.Y,void 0):u())),d}Object(n.xb)()&&(M=O);var B={execCommandPaste:function(){var e;try{e=document.execCommand(n.v,!1,null)}catch(e){Object(n.Mb)().ULS.traceTag(596456322,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"document.execCommand('"+n.v+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return void 0===e&&(e=!0),e},getData:function(e,t,r){var o=n.Y;try{var a=_(t);if(!a||!T(a))return o;(o=a.getData(e))||(o=n.Y),Object(n.Mb)().ULS.traceTag(596456323,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getData('"+e+"') returned "+o.length+" characters")}catch(t){Object(n.Mb)().ULS.traceTag(596456324,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"getData with '"+e+"' threw an exception. This is a browser bug. Ignoring. Exception:: "+i.utils.getStringifiedError(t))}return o},browserExtensionPaste:function(){return Promise.reject(new n.e(n.f.NoBrowserExtensionsInConfiguration))}},J={execCommandPaste:function(){if(m(),s()&&U(n.V,void 0,!1),!l())return Object(n.Mb)().ULS.traceTag(596456325,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"document.execCommand - programmatic clipboard '"+n.v+"' access is not allowed in this session."),!1;try{document.execCommand(n.v,!1,null)}catch(e){Object(n.Mb)().ULS.traceTag(596456326,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"document.execCommand('"+n.v+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return!0},getData:U,browserExtensionPaste:function(){return Promise.reject(new n.e(n.f.NoBrowserExtensionsInConfiguration))}},F={execCommandPaste:function(){var e=!1;try{void 0===(e=document.execCommand(n.v,!1,null))&&(e=!0)}catch(e){Object(n.Mb)().ULS.traceTag(596455698,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Chrome: document.execCommand('"+n.v+"') threw an exception. This is a browser bug. Ignoring. Exception: "+e.message)}return e},getData:function(e,t,r){var o=n.Y;try{var a=_(t);if(!a||!T(a))return o;(o=a.getData(e))||(o=n.Y),Object(n.Mb)().ULS.traceTag(596455699,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Chrome: getData('"+e+"') returned "+o.length+" characters")}catch(t){Object(n.Mb)().ULS.traceTag(596455700,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Chrome: getData with '"+e+"' threw an exception. This is a browser bug. Ignoring. Exception:: "+i.utils.getStringifiedError(t))}return o},browserExtensionPaste:function(){return I()}},N=void 0;function k(){return void 0===N&&(N=S()?F:B),N}Object(n.xb)()&&(N=J);var H="ccpContentEditable",z="div";function V(){var e=document.getSelection();if(e&&e.getRangeAt&&"function"==typeof e.getRangeAt&&!(e.rangeCount<1))return e.getRangeAt(0)}function G(e,t){void 0===t&&(t=void 0),Object(n.Mb)().ULS.shipAssertTag(596444114,i.LogCategory.msoulscat_ES_EWAJS,!1===e&&!t||!0===e&&(!!t||t===n.Y),"enableClipboardEvents: useTextHtmlContentCandidate = '"+e+"', textHtmlContentCandidate is "+(t||t===n.Y?n.Y:"not ")+"provided");var r=document.activeElement&&document.activeElement.id,o=function(e,t){var r=K();r&&r.tagName&&r.tagName.toLowerCase()!==z&&(r.parentElement&&r.parentElement.removeChild(r),r=void 0);r||(r=function(){var e=document.createElement(z);return function(e){e.id=H,e.contentEditable="true",e.spellcheck=!1,e.setAttribute("autocomplete","off"),e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("aria-hidden","true"),e.tabIndex=-1,e.style.display="inline-block",e.style.position="absolute",e.style.fontSize="10",e.style.height="0px",e.style.width="0px",e.style.top="0px",e.style.left="0px",e.style.zIndex="-100",e.style.overflow="hidden",e.onmousemove=function(){e.onmousemove=null,Object(n.Mb)().ULS.assertTag(595957699,i.LogCategory.msoulscat_ES_EWAJS,!1,"contentEditableElement.onmousemove: Mouse move event is not expected on element '"+H+"'. it should be covered by other elements")}}(e),document.body.appendChild(e),e}());var o=t;e?o||(o=n.Y):o=function(){var e=document.createElement("span");return e.innerText=n.Eb,e}().outerHTML;return r.innerHTML=o,r}(e,t);r&&r===o.id&&(r=void 0),o.focus();var a=document.getSelection();if(a){a.removeAllRanges();var s=document.createRange();s.selectNodeContents(o),a.addRange(s)}return r}function Y(){var e=K();if(!e)return!1;try{var t=e.clientLeft+e.scrollWidth/2,r=e.clientTop+e.scrollTop/2,o=document.elementFromPoint(t,r);return!!o&&(o.id===e.id||!!o.parentElement&&o.parentElement.id===e.id)}catch(e){return Object(n.Mb)().ULS.traceTag(595957534,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"isContentEditableElementVisibleToUser: hit test failed with error: "+i.utils.getStringifiedError(e)),!1}}function K(){return document.getElementById(H)}var q=function(){function e(){this.lastDeferredCutCopyPromise=void 0,this.removeLastCutCopyEventListenerCallback=void 0,this.lastDeferredPastePromise=void 0,this.selectedRangeToRestore=void 0,this.removeLastPasteEventListenerCallback=void 0,this.activeElementIdToRestore=void 0,this.clipboardStorageType=n.h.SystemClipboard,this.disposableImplementationExtension=Object(n.M)("SystemClipboardStorage")}return e.prototype.get=function(e){var t=this;if(this.disposableImplementationExtension.throwIfDisposed("get"),Object(n.Mb)().ULS.traceTag(596449096,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"SystemClipboardStorage.get: isKeyboardEvent = '"+e.isKeyboardEvent+"'"),e.skipSystemClipboardAccess){Object(n.Mb)().ULS.traceTag(596124883,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"SystemClipboardStorage.get: Skipping system clipboard access");var r=Object(n.D)(document,n.w,function(e){return t.skipSystemClipboardPasteHandler(e,r)},!0);return this.removeLastPasteEventListenerCallback=r,Promise.resolve(Object(n.gb)())}if(Object(n.Rb)(e.userHash),this.lastDeferredPastePromise&&!this.lastDeferredPastePromise.fulfilled()){var o=this.lastDeferredPastePromise,a="There exists a pending deferred promise with id '"+o.id+"', representing an active "+n.v+" event. Scheduling a rejection to execute after the current operation.";Object(n.Mb)().ULS.traceTag(596455680,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,a),window.setTimeout(function(){o.reject(new n.e(n.f.RejectingPendingPastePromiseDueToNewPasteOperation,a))},0)}this.clearPasteCallbackConfiguration(this.lastDeferredPastePromise,!0,!1);var s=Object(n.K)();this.lastDeferredPastePromise=s;var c=s.id,d=Object(n.D)(document,n.w,function(r){return t.pasteHandler(r,s,e.isKeyboardEvent,d)},!0);this.removeLastPasteEventListenerCallback=d,this.selectedRangeToRestore=V(),this.activeElementIdToRestore=G(!1);try{var l=!1;if(Object(n.xb)()&&e.isKeyboardEvent||(l=k().execCommandPaste()),e.isKeyboardEvent);else if(!l)return this.clearPasteCallbackConfiguration(s,!0,!0),k().browserExtensionPaste().catch(function(e){return Promise.reject(new n.e(n.f.ClipboardIsInaccessible,"document.execCommand("+n.v+") failed in SystemClipboard.get. Deferred promise id = '"+c+"'",e))})}catch(e){return this.clearPasteCallbackConfiguration(s,!0,!1),Promise.reject(new n.e(n.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '"+c+"'",e))}return s.promise.catch(function(e){return Object(n.sb)(e,n.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(e):Promise.reject(new n.e(n.f.GetClipboardItems,"Failed in SystemClipboard.get. Deferred promise id = '"+c+"'",e))})},e.prototype.set=function(t,r){var o=this;if(this.disposableImplementationExtension.throwIfDisposed("set"),Object(n.Mb)().ULS.traceTag(596449097,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"SystemClipboardStorage.set: isKeyboardEvent = '"+r.isKeyboardEvent+"'; cutCopyPasteFlags = '"+r.commandType+"'"),!this.hasPlainText(t))return Object(n.Mb)().ULS.traceTag(596124884,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"SystemClipboardStorage.set: No plain text to write, skipping system clipboard access."),Promise.resolve();if(Object(n.cb)(t)>0&&Object(n.Rb)(r.userHash),Object(n.xb)()&&!r.isKeyboardEvent){if(r.silentClipboardAccessFailures&&s())return Object(n.Mb)().ULS.traceTag(596455681,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Aborting attempt to store content in the clipboard since silentClipboardAccessFailures is on and the user did not select Allow access in IE's clipboard access dialog"),Object(n.Ib)(t.getData()),Promise.resolve();if(!s()&&!l())return Object(n.Mb)().ULS.traceTag(596455682,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection."),Object(n.Ib)(t.getData()),Promise.resolve()}if(this.lastDeferredCutCopyPromise&&!this.lastDeferredCutCopyPromise.fulfilled()){var a=this.lastDeferredCutCopyPromise,c="There exists a pending deferred promise with id '"+a.id+"', representing an active "+n.o+"/"+n.k+" event. Scheduling a rejection to execute after the current operation.";Object(n.Mb)().ULS.traceTag(596455683,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,c),window.setTimeout(function(){a.reject(new n.e(r.isKeyboardEvent?n.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation:n.f.RejectingBlockedSyncCutCopyPromise,c))},0)}this.clearCutCopyCallbackConfiguration(this.lastDeferredCutCopyPromise,!0,!1);var d=Object(n.K)();this.lastDeferredCutCopyPromise=d;var u=d.id;try{var p=Object(n.hb)(t),m=e.getClipboardCutCopyEventType(r.commandType),g=Object(n.D)(document,m,function(e){return o.cutCopyHandler(e,d,p,r.isKeyboardEvent,r.commandType,g)});this.removeLastCutCopyEventListenerCallback=g;var f=n.Y;Object(n.xb)()&&(f=Object(n.ab)(p,n.Lb)),this.selectedRangeToRestore=V(),this.activeElementIdToRestore=G(!!f,f);var b=!1;if(Object(n.xb)()&&r.isKeyboardEvent||(b=r.commandType===n.q.Cut?R().execCommandCut():R().execCommandCopy()),r.isKeyboardEvent);else if(!b)return this.clearCutCopyCallbackConfiguration(d,!0,!0),!Object(n.xb)()||s()||l()?function(e){return R().browserExtensionCopy(e)}(t.getData()).then(function(){d.resolve()},function(e){return d.resolve(),r.silentClipboardAccessFailures?(Object(n.Mb)().ULS.traceTag(596455685,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Failed to programmatically clear/set the clipboard via a browser extension. silentClipboardAccessFailures is on. Deferred promise id = '"+u+"'. Error: "+i.utils.getStringifiedError(e)),Object(n.Ib)(t.getData()),Promise.resolve()):Promise.reject(new n.e(n.f.ClipboardIsInaccessible,"browserExtensionCopy for '"+(r.commandType===n.q.Cut?n.o:n.k)+"' failed in SystemClipboard.set. Deferred promise id = '"+u+"'",e))}):(Object(n.Mb)().ULS.traceTag(596455684,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Aborting attempt to store content in the clipboard since the user selected Dont Allow in IE's clipboard access dialog. Use the active selection. Deferred promise id = '"+u+"'"),Object(n.Ib)(t.getData()),d.resolve(),Promise.resolve())}catch(e){return this.clearCutCopyCallbackConfiguration(d,!0,!1),Promise.reject(new n.e(n.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '"+u+"'",e))}return d.promise.catch(function(e){return e&&Object(n.tb)(e,[n.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,n.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.reject(new n.e(n.f.SetClipboardItems,"Failed in SystemClipboard.set. Deferred promise id = '"+u+"'",e))})},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[n.V,n.Lb]},e.prototype.cutCopyHandler=function(e,t,r,o,a,s){var c=this;try{if(Object(n.Mb)().ULS.traceTag(596449098,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '"+o+"'; cutCopyPasteFlags = '"+a+"'; bubbles = '"+e.bubbles+"'; eventPhase = '"+e.eventPhase+"'"),s(),this.removeLastCutCopyEventListenerCallback===s&&(this.removeLastCutCopyEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("cutCopyHandler"))return;if(Object(n.Mb)().ULS.shipAssertTag(596455686,i.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.cutCopyHandler: the deferred promise parameter is missing. isKeyboardEvent = '"+o+"'; cutCopyPasteFlags = '"+a+"'"),!t)return;if(Object(n.Mb)().ULS.traceTag(596455687,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"SystemClipboardStorage.cutCopyHandler: isKeyboardEvent = '"+o+"'; cutCopyPasteFlags = '"+a+"'; deferred promise id = '"+t.id+"'"),Object(n.Mb)().ULS.shipAssertTag(596455688,i.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.cutCopyHandler: deferred promise '"+t.id+"' is already fulfilled. isKeyboardEvent = '"+o+"'; cutCopyPasteFlags = '"+a+"'"),t.fulfilled())return;var d=function(){t.resolve(),c.clearCutCopyCallbackConfiguration(t,!1,!1)},l=Object(n.ab)(r,n.Lb);if(l&&Object(n.xb)())window.setTimeout(d,0);else{l&&W(n.Lb,l,e,o);var u=Object(n.eb)(r);W(R().defaultClipboardDataFormat,u,e,o),e.preventDefault(),d()}}catch(e){this.clearCutCopyCallbackConfiguration(t,!1,!1),Object(n.Mb)().ULS.traceTag(596455689,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"SystemClipboardStorage.cutCopyHandler callback with deferred promise id '"+(t?t.id:n.Y)+"' (fulfilled = '"+(t?t.fulfilled():n.Y)+"') failed with this exception: "+(e&&e.message?e.message:"NA")+". Call stack: "+(e.stack?e.stack:"NA")),t&&t.reject(new n.e(n.f.SetClipboardItems,"Failed in SystemClipboard.set > cutCopyHandler callback. Deferred promise id = '"+t.id+"'. Error: "+(e&&e.message?e.message:"NA"),e))}},e.prototype.pasteHandler=function(e,t,r,o){var a=this,s=!0;try{if(Object(n.Mb)().ULS.traceTag(596449099,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '"+r+"'; eventPhase='"+e.eventPhase+"'"),o(),this.removeLastPasteEventListenerCallback===o&&(this.removeLastPasteEventListenerCallback=void 0),this.disposableImplementationExtension.logIfDisposed("pasteHandler"))return;if(Object(n.Mb)().ULS.shipAssertTag(596455690,i.LogCategory.msoulscat_ES_EWAJS,!!t,"SystemClipboardStorage.pasteHandler: the deferred promise parameter is missing. isKeyboardEvent = '"+r+"'"),!t)return;if(Object(n.Mb)().ULS.traceTag(596455691,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"SystemClipboardStorage.pasteHandler: isKeyboardEvent = '"+r+"'; deferred promise id = '"+t.id+"'"),Object(n.Mb)().ULS.shipAssertTag(596455692,i.LogCategory.msoulscat_ES_EWAJS,!t.fulfilled(),"SystemClipboardStorage.pasteHandler: deferred promise '"+t.id+"' is already fulfilled. isKeyboardEvent = '"+r+"'"),t.fulfilled())return;var c=Object(n.G)();this.getSupportedDataFormats().forEach(function(t){var o=function(e,t,r){return k().getData(e,t,r)}(t,e,r);t===n.Lb&&(o=n.mb.getFragmentFromTextHtml(o)),c.setItem(t,o)}),e.stopPropagation(),s=!1,Object(n.xb)()?window.setTimeout(function(){var e=function(){var e=K();return Object(n.Mb)().ULS.shipAssertTag(596444113,i.LogCategory.msoulscat_ES_EWAJS,!!e,"getTextHtmlContent: the content editable element does not exist"),e?e.innerHTML:n.Y}();c.setItem(n.Lb,e),t.resolve(c),a.clearPasteCallbackConfiguration(t,!1,!1)},0):(e.preventDefault(),t.resolve(c),this.clearPasteCallbackConfiguration(t,!1,!1))}catch(r){try{s&&e.stopPropagation(),e.preventDefault()}catch(e){Object(n.Mb)().ULS.traceTag(595985030,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"SystemClipboardStorage.pasteHandler: failed when performing stopPropagation/preventDefault on the raw event. Failed with an exception: "+i.utils.getStringifiedError(e))}this.clearPasteCallbackConfiguration(t,!1,!1),Object(n.Mb)().ULS.traceTag(596455693,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"SystemClipboardStorage.pasteHandler callback with deferred promise id '"+(t?t.id:n.Y)+"' (fulfilled = '"+(t?t.fulfilled():n.Y)+"') failed with an exception: "+(r&&r.message?r.message:"NA")+". Call stack: "+(r.stack?r.stack:"NA")),t&&t.reject(new n.e(n.f.GetClipboardItems,"Failed in SystemClipboard.get > pasteHandler callback. Deferred promise id = '"+t.id+"'. Error: "+(r&&r.message?r.message:"NA"),r))}},e.prototype.skipSystemClipboardPasteHandler=function(e,t){try{t(),e.stopPropagation(),e.preventDefault()}catch(e){Object(n.Mb)().ULS.traceTag(595993058,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"SystemClipboardStorage.skipSystemClipboardPasteHandler: failed with an exception: "+(e&&e.message?e.message:"NA")+". Call stack: "+(e.stack?e.stack:"NA"))}this.removeLastPasteEventListenerCallback===t&&(this.removeLastPasteEventListenerCallback=void 0)},e.prototype.hasPlainText=function(e){return!!e&&Object.keys(e.getData().items).indexOf(n.V)>-1},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(n.Hb)([function(){e.lastDeferredCutCopyPromise&&!e.lastDeferredCutCopyPromise.fulfilled()&&(e.lastDeferredCutCopyPromise.reject(),e.lastDeferredCutCopyPromise=void 0,e.removeLastCutCopyEventListenerCallback&&(e.removeLastCutCopyEventListenerCallback(),e.removeLastCutCopyEventListenerCallback=void 0))},function(){e.lastDeferredPastePromise&&!e.lastDeferredPastePromise.fulfilled()&&(e.lastDeferredPastePromise.reject(),e.lastDeferredPastePromise=void 0,e.removeLastPasteEventListenerCallback&&(e.removeLastPasteEventListenerCallback(),e.removeLastPasteEventListenerCallback=void 0))}]),this.disposableImplementationExtension.dispose())},e.getClipboardCutCopyEventType=function(e){if(!e)return n.l;if(e===n.q.Copy)return n.l;if(e===n.q.Cut)return n.p;throw new n.r(n.Y,"cutCopyPasteFlags",e.toString())},e.prototype.restoreFocusToPreviouslyActiveElement=function(){if(this.activeElementIdToRestore){var e=document.getElementById(this.activeElementIdToRestore);e&&e.focus()}},e.prototype.restoreSelection=function(){this.selectedRangeToRestore&&(!function(e){if(void 0===e&&(e=void 0),e){var t=document.getSelection();t&&t.removeAllRanges&&"function"==typeof t.removeAllRanges&&t.addRange&&"function"==typeof t.addRange&&(t.removeAllRanges(),t.addRange(e))}}(this.selectedRangeToRestore),this.selectedRangeToRestore=void 0)},e.prototype.clearCutCopyCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Object(n.Mb)().ULS.shipAssertTag(595957697,i.LogCategory.msoulscat_ES_EWAJS,!Y(),"SystemClipboardStorage.set: ccpContentEditable is visible to the user during a copy/cut operation, but it should not be visible."),e===this.lastDeferredCutCopyPromise?this.lastDeferredCutCopyPromise=void 0:e&&this.lastDeferredCutCopyPromise&&e.id===this.lastDeferredCutCopyPromise.id&&(this.lastDeferredCutCopyPromise=void 0),t&&this.removeLastCutCopyEventListenerCallback&&(r||Object(n.Mb)().ULS.traceTag(596449290,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"SystemClipboardStorage.set: the "+n.o+"/"+n.k+" event listener was not called. Calling removeLastCutCopyEventListenerCallback()"),this.removeLastCutCopyEventListenerCallback(),this.removeLastCutCopyEventListenerCallback=void 0)},e.prototype.clearPasteCallbackConfiguration=function(e,t,r){this.restoreFocusToPreviouslyActiveElement(),this.restoreSelection(),Object(n.Mb)().ULS.shipAssertTag(595957698,i.LogCategory.msoulscat_ES_EWAJS,!Y(),"SystemClipboardStorage.clearPasteCallbackConfiguration: ccpContentEditable is visible to the user during a paste operation, but it should not be visible"),e===this.lastDeferredPastePromise?this.lastDeferredPastePromise=void 0:e&&this.lastDeferredPastePromise&&e.id===this.lastDeferredPastePromise.id&&(this.lastDeferredPastePromise=void 0),t&&this.removeLastPasteEventListenerCallback&&(r||Object(n.Mb)().ULS.traceTag(596449291,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"SystemClipboardStorage.get: the "+n.v+" event listener was not called. Calling removeLastPasteEventListenerCallback()"),this.removeLastPasteEventListenerCallback(),this.removeLastPasteEventListenerCallback=void 0)},e}(),Q="load",X="clipboard",Z="Shared Clipboard iframe content",$="clipboard/shared.aspx",ee=encodeURIComponent("WacCluster"),te={initialized:!1,origin:n.Y,src:n.Y,deferredPromise:void 0},re=void 0;function ne(){return te}function oe(){var e=document.createElement("iframe");return e.style.display="none",e.id=X,Object(n.Mb)().ULS.shipAssertTag(595952726,i.LogCategory.msoulscat_ES_EWAJS,!re,"createIframe: the last shared clipboard iframe's onload event listener should have been removed. Removing it and registering a new event listener."),ie(),re=Object(n.D)(e,Q,function(e){return function(e){Object(n.Mb)().ULS.traceTag(595952727,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"CCP iframe onload event: Entering"),ie();var t=ne().deferredPromise;if(!t)return void Object(n.Mb)().ULS.shipAssertTag(595952728,i.LogCategory.msoulscat_ES_EWAJS,!1,"CCP iframe onload event: the CCP iframe does not have a matching deferred promise to notify subscribers when the iframe loaded");var r=t.id;try{ne().deferredPromise=void 0;var o=e.target;if(!o){var a="CCP iframe onload event: the CCP iframe should exist when its onload event is called. Rejecting deferred promise id '"+r+"'";return Object(n.Mb)().ULS.shipAssertTag(595952729,i.LogCategory.msoulscat_ES_EWAJS,!1,a),void t.reject(new n.s(a))}if(!o.contentWindow||!o.contentDocument){var a="CCP iframe onload event: the contentWindow of the CCP iframe does not exist. Rejecting deferred promise id '"+r+"'";return Object(n.Mb)().ULS.shipAssertTag(595952730,i.LogCategory.msoulscat_ES_EWAJS,!1,a),void t.reject(new n.s(a))}var s=n.Y,c=o.contentDocument.getElementsByTagName("Title");if(c&&c.length>0){var d=c[0];d&&(s=d.text||d.textContent||n.Y)}if(!s||s.trim()!==Z){var a="CCP iframe onload event: the CCP iframe page does not exist. Rejecting deferred promise id '"+r+"'";return Object(n.Mb)().ULS.shipAssertTag(595952731,i.LogCategory.msoulscat_ES_EWAJS,!1,a),void t.reject(new n.s(a))}Object(n.Mb)().ULS.traceTag(595952732,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"CCP iframe onload event: resolving deferred promise id '"+r+"' with the iframe's content window"),t.resolve(o.contentWindow)}catch(e){var a="iframeOnLoad: an error has occurred: ["+e+"]. Rejecting deferred promise id '"+r+"'";Object(n.Mb)().ULS.traceTag(595952733,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,a),t.reject(new n.s(a,e))}}(e)}),e.src=ne().src,e}function ie(){if(re){try{re()}catch(e){}re=void 0}}var ae=void 0;function se(e){return ae||(ae=ne()),ae.initialized?ae.origin:(ae.origin=Object(n.jb)(e),ae.src=function(){var e=ne().origin,t=e;"/"!==e.charAt(e.length-1)&&(t+="/"),t+=$;var r=Ee();if(r){var n=r.getWacCluster();n&&(t.indexOf("?")>=0?t+="&":t+="?",t+=ee+"="+encodeURIComponent(n))}return t}(),ae.initialized=!0,ae.origin)}function ce(){if(!ae)return Promise.reject("state in undefined, please make sure to call initialize first");var e=function(){if(!ne().initialized)throw new n.s("getIframe: the initialize function should be called beforehand");var e=document.getElementsByTagName("iframe");if(e&&0!==e.length){Object(n.Mb)().ULS.traceTag(595952723,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getIframe: found "+e.length+" iframes");for(var t=0;t<e.length;t+=1){var r=e[t];if(r&&r.id&&r.id===X)return r}Object(n.Mb)().ULS.traceTag(595952724,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getIframe: the CCP iframe does not exist")}else Object(n.Mb)().ULS.traceTag(595952722,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getIframe: found no iframes")}();e&&(Object(n.Mb)().ULS.traceTag(596448770,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"ensureIframeWindow: The CCP iframe exists. Removing the iframe and re-adding it. iframe.src "+(void 0!==e.src&&void 0!==ae.src&&e.src.toLowerCase()===ae.src.toLowerCase()?"===":"!==")+" src; deferredPromise "+(void 0===ae.deferredPromise?"does not exist":"exists")+"; The iframe's content window "+(void 0===e.contentWindow?"does not exist":"exists")+"."),function(e){if(!e)throw new n.t(n.Y,"iframe");Object(n.Mb)().ULS.traceTag(595952725,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"removeIframe: removing the CCP iframe"),ie(),e.parentNode&&e.parentNode.removeChild(e)}(e),e=void 0);var t=ae.deferredPromise,r=t?t.id:n.Y;if(t){ie(),ae.deferredPromise=void 0;var o="ensureIframeWindow: the CCP iframe does not exist and the deferred promise of its content window should not exist as well. Rejecting deferred promise id '"+r+"' and creating a new one";Object(n.Mb)().ULS.shipAssertTag(596453587,i.LogCategory.msoulscat_ES_EWAJS,!1,o),t.reject(new n.s(o)),t=void 0}ae.deferredPromise=Object(n.K)(Object(n.O)()),r=(t=ae.deferredPromise).id;try{e=oe(),document.getElementsByTagName("body")[0].appendChild(e)}catch(e){o="ensureIframeWindow: unable to create and/or add a CCP iframe. Dropping tentative deferred promise id '"+r+"'";return Object(n.Mb)().ULS.traceTag(596453588,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,o),ae.deferredPromise=void 0,ie(),Promise.reject(new n.s(o,e))}return t&&!t.fulfilled()?t.promise:(ie(),e.contentWindow?(ae.deferredPromise=void 0,Promise.resolve(e.contentWindow)):(Object(n.Mb)().ULS.shipAssertTag(596453589,i.LogCategory.msoulscat_ES_EWAJS,!1,"ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '"+r+"'"),Promise.reject(new n.s("ensureIframeWindow: the iframe's content window should exist. Deferred promise id = '"+r+"'"))))}var de=function(e){function t(t,r,n){return e.call(this,t,r,n,"WindowRPCClientInternal")||this}return o.__extends(t,e),t.prototype.init=function(e){this.deferredResultMessagePromiseCache=Object(n.L)(),this.sender=Object(n.R)(this.serializer,this),this.receiver=Object(n.Q)(this.deserializer,this,this);var t=function(e){var t=!1;try{e&&e.document&&"complete"===e.document.readyState&&(t=!0)}catch(e){}return Object(n.Mb)().ULS.traceTag(596448771,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"isIframeReady: the iframe is "+(t?"":"not ")+"ready"),t}(this.remoteWindow.window);return Object(n.Mb)().ULS.shipAssertTag(596448769,i.LogCategory.msoulscat_ES_EWAJS,t,"RPC Client - init: the iframe should be ready"),this.postInitMessage(e).catch(function(e){return Object(n.Mb)().ULS.traceTag(596129250,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Init failure or timeout. Error: "+i.utils.getStringifiedError(e)),Object(n.sb)(e,n.f.IndexedDBCacheInitializationTimeout)?Promise.reject(e):Promise.reject(new n.e(n.f.IndexedDBCacheInitialization,"failed to init the Shared Clipboard",e))})},t.prototype.postInitMessage=function(e){var t=Object(n.H)(n.pb,"init");if(!this.deferredResultMessagePromiseCache){var r="RPC Client - postInitMessage: this.deferredResultMessagePromiseCache should be defined";return Object(n.Mb)().ULS.shipAssertTag(596121487,i.LogCategory.msoulscat_ES_EWAJS,!1,r),Promise.reject(new n.s(r))}var o=this.postMessage(t),a=this.deferredResultMessagePromiseCache.getDeferredPromise(t.id),s=Date.now();return setTimeout(function(){if(a&&!a.fulfilled()){var e=Date.now(),t="indexedDB initialization started on "+new Date(s)+" and timed out on "+new Date(e)+" after "+(e-s)+" ms";Object(n.Mb)().ULS.traceTag(596129251,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,t),a.reject(new n.e(n.f.IndexedDBCacheInitializationTimeout,t))}},e),o},t.prototype.postMessage=function(t){try{if(!t)throw new n.t(n.Y,"outgoingMessage");if(Object(n.Mb)().ULS.shipAssertTag(596452175,i.LogCategory.msoulscat_ES_EWAJS,!!t.id,"postMessage: outgoingMessage.id must be defined"),e.prototype.postMessage.call(this,t),!this.deferredResultMessagePromiseCache){var r="RPC Client - postMessage: this.deferredResultMessagePromiseCache should be defined";throw Object(n.Mb)().ULS.shipAssertTag(596121488,i.LogCategory.msoulscat_ES_EWAJS,!1,r),new n.s(r)}return this.deferredResultMessagePromiseCache.addNewPromise(t.id).promise}catch(e){return Promise.reject(new n.s("Unable to post message for operation '"+(t?t.operationCode:void 0)+"'",e))}},t.prototype.handleMessage=function(e){if(Object(n.Mb)().ULS.traceTag(596452376,i.LogCategory.msoulscat_ES_EWAJS,e&&e.failed?i.TraceLevel.Warning:i.TraceLevel.Info,"RPC Client - handleMessage: incomingMessage.id='"+(e&&e.id)+"'; incomingMessage.operationCode='"+(e&&e.operationCode)+"'; incomingMessage.failed='"+(e&&e.failed)+"'; incomingMessage.error='"+(e&&e.error)+"'; incomingMessage.clipboardItems.length="+Object(n.db)(e&&e.clipboardItemsData)),!this.deferredResultMessagePromiseCache){var t="RPC Client - handleMessage: this.deferredResultMessagePromiseCache should be defined";return Object(n.Mb)().ULS.shipAssertTag(596121489,i.LogCategory.msoulscat_ES_EWAJS,!1,t),Promise.reject(new n.s(t))}var r="initresult"===e.operationCode?n.pb:e.id,o=this.deferredResultMessagePromiseCache.getDeferredPromise(r);return o?(this.deferredResultMessagePromiseCache.delete(r),e.failed?o.reject(e.error):o.resolve(e),Promise.resolve()):(Object(n.Mb)().ULS.traceTag(596452377,i.LogCategory.msoulscat_ES_EWAJS,"initresult"===e.operationCode?i.TraceLevel.Warning:i.TraceLevel.Error,r===e.id?"RPC Client - handleMessage: no deferred promise with id '"+e.id+"'; dropping this result.":"RPC Client - handleMessage: no deferred promise with id '"+r+"' for message id '"+e.id+"'; dropping this result."),Promise.resolve())},t.prototype.handleDeserializationError=function(e){return Object(n.Mb)().ULS.traceTag(596452379,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"RPC Client - handleDeserializationError. There are "+(this.deferredResultMessagePromiseCache?this.deferredResultMessagePromiseCache.getLength():0)+" deferred promise(s) in the cache. Error: "+e),Promise.resolve()},t.prototype.dispose=function(){var t=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(n.Hb)([function(){t.deferredResultMessagePromiseCache&&t.deferredResultMessagePromiseCache.clear()}]),e.prototype.dispose.call(this))},t}(n.C);function le(){return!!i.idbPromised.getDbFactory()}var ue=function(e){function t(){var t=e.call(this,n.h.IndexedDB)||this;return t.initialized=!1,t.disposableImplementationExtension=Object(n.M)("IndexedDBClipboardStorage"),t}return o.__extends(t,e),t.prototype.initialize=function(){var e=this;if(!le())return Promise.reject(new n.e(n.f.IndexedDBProviderNotSupported));var t=se(window.location.origin);return this.windowRPCClient=function(e,t){return new de(Object(n.P)(n.Ob),Object(n.N)(n.Pb),{window:t,windowOrigin:e})}(t,void 0),i.utils.retry(function(t,r){var o=Object(n.sb)(r,n.f.IndexedDBCacheInitializationTimeout)?5e3:0;return e.initializeIframe(t,2e4+o*(t-1))},3).then(function(t){return e.initialized=!0,t})},t.prototype.initializeIframe=function(e,t){var r=this;if(!this.windowRPCClient){var o="IndexedDBClipboardStorage::initializeIframe - this.windowRPCClient should be defined";return Object(n.Mb)().ULS.shipAssertTag(596121490,i.LogCategory.msoulscat_ES_EWAJS,!1,o),Promise.reject(new n.s(o))}var a=i.perfWatch.start("IndexedDBClipboardStorage_initialize_"+e);i.perfWatch.mark(a,"start"),this.windowRPCClient.remoteWindow.window=void 0;var s=function(r){var o=Object(n.sb)(r,n.f.IndexedDBCacheInitializationTimeout)?" due to a timeout of approx. "+t+" ms":n.Y;i.perfWatch.mark(a,"finish_error"),i.perfWatch.failure(a,function(e){return Object(n.Mb)().ULS.traceTag(596452419,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,e)},"Attempt #"+e+" failed to initialize clipboard storage type '"+n.h.IndexedDB+"' with an iframe and an initialized indexedDB"+o+". "+(e<3?"Retrying...":"No more retries!")+". Error: "+i.utils.getStringifiedError(r))},c=Object(n.K)();return ce().then(function(o){if(i.perfWatch.mark(a,"iframe_loaded"),i.perfWatch.mark(a,"iframe_waiting_for_idb_init"),!r.windowRPCClient){var c="IndexedDBClipboardStorage::initializeIframe - this.windowRPCClient should be defined";Object(n.Mb)().ULS.shipAssertTag(596121491,i.LogCategory.msoulscat_ES_EWAJS,!1,c);var d=new n.s(c);return s(d),Promise.reject(d)}return r.windowRPCClient.remoteWindow.window=o,r.windowRPCClient.init(t).then(function(){return i.perfWatch.mark(a,"iframe_idb_init_complete"),i.perfWatch.mark(a,"finish"),i.perfWatch.success(a,function(e){return Object(n.Mb)().ULS.traceTag(596452418,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,e)},"Attempt #"+e+" initialized clipboard storage type '"+n.h.IndexedDB+"' with an iframe and an initialized indexedDB"),Promise.resolve()})}).then(function(){c.resolve(r)}).catch(function(e){s(e),c.reject(e)}),c.promise},t.prototype.get=function(e){if(this.disposableImplementationExtension.throwIfDisposed("get"),Object(n.Mb)().ULS.traceTag(596452380,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"IndexedDBClipboardStorage.get: isKeyboardEvent = "+e.isKeyboardEvent+"; silentClipboardAccessFailures = "+(e.silentClipboardAccessFailures||!1)),!this.initialized)return Promise.reject(new n.e(n.f.IndexedDBCacheInitialization));var t=i.perfWatch.start("IndexedDBClipboardStorage_get");i.perfWatch.mark(t,"start"),Object(n.Rb)(e.userHash);var r=Object(n.H)(Object(n.O)(),"get",e.userHash),o=function(e){return i.perfWatch.mark(t,"finish_error"),i.perfWatch.failure(t,function(e){return Object(n.Mb)().ULS.traceTag(596452188,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,e)},"Failed in IndexedDBClipboardStorage.get. Error: "+i.utils.getStringifiedError(e)),Promise.reject(new n.e(n.f.IndexedDBGetClipboardItems,"Failed in IndexedDBClipboardStorage.get",e))};if(!this.windowRPCClient){var a="IndexedDBClipboardStorage::get - this.windowRPCClient should be defined";return Object(n.Mb)().ULS.shipAssertTag(596121492,i.LogCategory.msoulscat_ES_EWAJS,!1,a),o(new n.s(a))}return this.windowRPCClient.postMessage(r).then(function(e){return Object(n.Mb)().ULS.shipAssertTag(596452176,i.LogCategory.msoulscat_ES_EWAJS,!!e,"IndexedDBClipboardStorage.get: postMessage must have returned a result message"),e?e.failed?Promise.reject(new n.e(n.f.IndexedDBGetClipboardItems,"IndexedDBClipboardStorage.get: the indexedDB operation failed. Error: "+e.error)):(i.perfWatch.mark(t,"finish"),i.perfWatch.success(t,function(e){return Object(n.Mb)().ULS.traceTag(596452187,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,e)}),e.clipboardItemsData?Promise.resolve(Object(n.G)(e.clipboardItemsData)):Promise.resolve(Object(n.gb)())):Promise.reject(new n.e(n.f.NoGetOperationResultMessage,"IndexedDBClipboardStorage.get: postMessage succeeded but returned nothing"))}).catch(function(e){return o(e)})},t.prototype.set=function(e,t){if(this.disposableImplementationExtension.throwIfDisposed("set"),Object(n.Mb)().ULS.traceTag(596452381,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"IndexedDBClipboardStorage.set: isKeyboardEvent = "+t.isKeyboardEvent+"; silentClipboardAccessFailures = "+(t.silentClipboardAccessFailures||!1)),!this.initialized)return Promise.reject(new n.e(n.f.IndexedDBCacheInitialization));var r,o=i.perfWatch.start("IndexedDBClipboardStorage_set");i.perfWatch.mark(o,"start"),Object(n.cb)(e)>0?(Object(n.Rb)(t.userHash),r=Object(n.H)(Object(n.O)(),"set",t.userHash,e.getData())):r=Object(n.H)(Object(n.O)(),"set");var a=function(e){return i.perfWatch.mark(o,"finish_error"),i.perfWatch.failure(o,function(e){return Object(n.Mb)().ULS.traceTag(596452190,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,e)},"Failed in IndexedDBClipboardStorage.set. Error: "+i.utils.getStringifiedError(e)),Promise.reject(new n.e(n.f.IndexedDBSetClipboardItems,"Failed in IndexedDBClipboardStorage.set",e))};if(!this.windowRPCClient){var s="IndexedDBClipboardStorage::set - this.windowRPCClient should be defined";return Object(n.Mb)().ULS.shipAssertTag(596121493,i.LogCategory.msoulscat_ES_EWAJS,!1,s),a(new n.s(s))}return this.windowRPCClient.postMessage(r).then(function(e){return Object(n.Mb)().ULS.shipAssertTag(596452177,i.LogCategory.msoulscat_ES_EWAJS,!!e,"IndexedDBClipboardStorage.set: postMessage must have returned a result message"),e?e.failed?Promise.reject(new n.e(n.f.IndexedDBSetClipboardItems,"IndexedDBClipboardStorage.set: the indexedDB operation failed. Error: "+e.error)):(i.perfWatch.mark(o,"finish"),i.perfWatch.success(o,function(e){return Object(n.Mb)().ULS.traceTag(596452189,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,e)}),Promise.resolve()):Promise.reject(new n.e(n.f.NoSetOperationResultMessage,"IndexedDBClipboardStorage.set: postMessage succeeded but returned nothing"))}).catch(function(e){return a(e)})},t.prototype.clearClipboardNecessary=function(e,t){return Object(n.Kb)(e,t)},t.prototype.setItem=function(e){return Promise.resolve()},t.prototype.getItem=function(e){return Promise.resolve({found:!1})},t.prototype.clear=function(){return Promise.resolve()},t.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[n.V,n.Lb,"data/shadow-workbook"]},t.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},t}(n.g);var pe=function(e){function t(){var t=e.call(this,n.h.InMemory)||this;return t.disposableImplementationExtension=Object(n.M)("InMemoryClipboardStorage"),t}return o.__extends(t,e),t.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.inMemoryClipboardItems=void 0,this.inMemoryMetadata=void 0,this.disposableImplementationExtension.dispose())},t.prototype.get=function(e){return this.disposableImplementationExtension.throwIfDisposed("get"),Object(i.ewaUtils)().isChangeGateEnabled("VSO:2481191_CCP_StorageLogicConsolidation")?this.getCacheItemsAndUpdateMetadata(e):this.inMemoryClipboardItems?Promise.resolve(Object(n.G)(this.inMemoryClipboardItems.clipboardItemsData)):Promise.resolve(Object(n.gb)())},t.prototype.set=function(e,t){if(this.disposableImplementationExtension.throwIfDisposed("set"),Object(i.ewaUtils)().isChangeGateEnabled("VSO:2481191_CCP_StorageLogicConsolidation"))return this.setMetadataAndCacheItems({found:!0,result:this.inMemoryMetadata},e,t);var r=void 0;return e&&(r=e.getData()),this.inMemoryClipboardItems={clipboardItemsData:r},Promise.resolve()},t.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),[n.V,n.Lb,"data/shadow-workbook"]},t.prototype.getItem=function(e){return e?e===n.Bb?Promise.resolve({found:!0,result:this.inMemoryMetadata}):e===n.F?this.inMemoryClipboardItems?Promise.resolve({found:!0,result:this.inMemoryClipboardItems}):Promise.resolve({found:!1}):Promise.reject(new n.e(n.f.GetClipboardItems,"inMemoryClipboardStorage.getItem: called with illegal key")):Promise.reject(new n.e(n.f.GetClipboardItems,"inMemoryClipboardStorage.getItem: called with undefined key"))},t.prototype.setItem=function(e){var t=e.id;return t?(t===n.Bb&&(this.inMemoryMetadata=e),t===n.F&&(this.inMemoryClipboardItems=e),Promise.resolve()):Promise.reject(new n.e(n.f.SetClipboardItems,"inMemoryClipboardStorage.setItem: provided item has no id property"))},t.prototype.clear=function(){return this.disposableImplementationExtension.throwIfDisposed("clear"),this.inMemoryClipboardItems=void 0,this.inMemoryMetadata=void 0,Promise.resolve()},t}(n.g);function me(e){switch(Object(n.Mb)().ULS.traceTag(596453009,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '"+e+"'"),e){case n.h.SystemClipboard:return Promise.resolve(new q);case n.h.IndexedDB:return(new ue).initialize();case n.h.InMemory:return Promise.resolve(new pe)}return Promise.reject(new n.e(n.f.UnsupportedClipboardStorageType,"Clipboard storage type '"+e+"' is not supported"))}function ge(){return(new fe).initialize(me(n.h.SystemClipboard))}var fe=function(e){function t(){return e.call(this,n.j.SystemClipboard)||this}return o.__extends(t,e),t}(n.i);function be(){return(new he).initialize(me(n.h.IndexedDB))}var he=function(e){function t(){return e.call(this,n.j.IndexedDB)||this}return o.__extends(t,e),t}(n.i);var Ce=function(e){function t(){return e.call(this,n.j.InMemory)||this}return o.__extends(t,e),t}(n.i);var ve=function(){function e(){this.clipboardStrategyType=n.j.IndexedDBAndInMemory,this.disposableImplementationExtension=Object(n.M)(""+n.j.IndexedDBAndInMemory)}return e.prototype.initialize=function(){var e=this;return this.indexedDBClipboardStrategy=void 0,this.inMemoryClipboardStrategy=void 0,be().then(function(t){return e.indexedDBClipboardStrategy=t,e.mergeLastSetClipboardItemsIntoTheIndexedDB()}).catch(function(){return Promise.resolve(e)}),(new Ce).initialize(me(n.h.InMemory)).then(function(t){return e.inMemoryClipboardStrategy=t,Promise.resolve(e)})},e.prototype.get=function(e){var t=this;return this.inMemoryClipboardStrategy?this.inMemoryClipboardStrategy.get(e).then(function(r){try{return Object(n.Mb)().ULS.traceTag(595961944,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"IndexedDBAndInMemoryClipboardStrategy.get: inMemoryClipboardItems = '"+(r?Object(n.cb)(r):"undefined")+"'; isKeyboardEvent = "+e.isKeyboardEvent+"; silentClipboardAccessFailures = "+(e.silentClipboardAccessFailures||!1)),t.disposableImplementationExtension.throwIfDisposed("get"),t.indexedDBClipboardStrategy?t.indexedDBClipboardStrategy.get(e):r||Object(n.gb)()}catch(e){return Promise.reject(new n.e(n.f.GetClipboardItems,"Failed in clipboardStrategy.get",e))}},function(e){return Promise.reject(new n.e(n.f.GetClipboardItems,"Failed in clipboardStrategy.get",e))}):Promise.reject(new n.e(n.f.ClipboardStrategyNotInitialized,"IndexedDBAndInMemoryClipboardStrategy.get: inMemoryClipboardStrategy is null or undefined"))},e.prototype.set=function(e,t){var r=this;if(!this.inMemoryClipboardStrategy)return Promise.reject(new n.e(n.f.ClipboardStrategyNotInitialized,"IndexedDBAndInMemoryClipboardStrategy.set: inMemoryClipboardStrategy is null or undefined"));var o=this.inMemoryClipboardStrategy;return this.inMemoryClipboardStrategy.get({}).then(function(a){try{return r.disposableImplementationExtension.throwIfDisposed("set"),Object(n.Mb)().ULS.traceTag(595961945,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"IndexedDBAndInMemoryClipboardStrategy.set: inMemoryClipboardItems = '"+(a?Object(n.cb)(a):"undefined")+"'; clipboardItems = '"+(e?Object(n.cb)(e):"undefined")+"'\n        isKeyboardEvent = "+t.isKeyboardEvent+"; silentClipboardAccessFailures = "+(t.silentClipboardAccessFailures||!1)),r.lastSetCommandParameters=t,o.set(e,t).then(function(){return r.indexedDBClipboardStrategy?r.indexedDBClipboardStrategy.set(e,t):Promise.resolve()})}catch(e){return Promise.reject(new n.e(n.f.SetClipboardItems,"Failed in clipboardStrategy.set",e))}},function(e){return Promise.reject(new n.e(n.f.SetClipboardItems,"Failed in clipboardStrategy.set",e))})},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(n.Hb)([function(){e.indexedDBClipboardStrategy&&e.indexedDBClipboardStrategy.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.mergeLastSetClipboardItemsIntoTheIndexedDB=function(){var e=this;if(!this.indexedDBClipboardStrategy)return Promise.reject("IndexedDBAndInMemoryClipboardStrategy.mergeLastSetClipboardItemsIntoTheIndexedDB - The indexedDB strategy must be initialized before this method is called");if(!this.inMemoryClipboardStrategy)return Promise.reject("IndexedDBAndInMemoryClipboardStrategy.mergeLastSetClipboardItemsIntoTheIndexedDB - The inMemory strategy must be initialized before this method is called");if(!this.lastSetCommandParameters)return Object(n.Mb)().ULS.traceTag(595952712,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"IndexedDBAndInMemoryClipboardStrategy.mergeLastSetClipboardItemsIntoTheIndexedDB: no lastSetCommandParameters, skipping merge"),this.clearPreInitLocalCache(),Promise.resolve();var t=this.indexedDBClipboardStrategy;return this.inMemoryClipboardStrategy.get({}).then(function(r){return r&&Object(n.cb)(r)>0&&e.lastSetCommandParameters?t.set(r,e.lastSetCommandParameters).then(function(){return Object(n.Mb)().ULS.traceTag(595961800,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"IndexedDBAndInMemoryClipboardStrategy.mergeLastSetClipboardItemsIntoTheIndexedDB: merge in-memory items to indexedDB succeeded."),e.clearPreInitLocalCache(),Promise.resolve()},function(t){return function(){return Object(n.Mb)().ULS.traceTag(595961801,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"IndexedDBAndInMemoryClipboardStrategy.mergeLastSetClipboardItemsIntoTheIndexedDB: failed to merge in-memory items to indexedDB with error "+i.utils.getStringifiedError(t)),e.clearPreInitLocalCache(),Promise.reject(t)}}):(Object(n.Mb)().ULS.traceTag(595961802,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"IndexedDBAndInMemoryClipboardStrategy.mergeLastSetClipboardItemsIntoTheIndexedDB: no in-memory clipboardItems, skipping..."),e.clearPreInitLocalCache(),Promise.resolve())},function(e){return Promise.reject(new n.e(n.f.SetClipboardItems,"Failed in clipboardStrategy.mergeLastSetClipboardItemsIntoTheIndexedDB",e))})},e.prototype.clearPreInitLocalCache=function(){this.inMemoryClipboardStrategy&&this.lastSetCommandParameters&&this.inMemoryClipboardStrategy.set(Object(n.gb)(),{}),this.lastSetCommandParameters=void 0},e}();var ye=function(){function e(){this.initialized=!1,this.clipboardStrategyType=n.j.SystemClipboardAndIndexedDB,this.disposableImplementationExtension=Object(n.M)(""+n.j.SystemClipboardAndIndexedDB)}return e.prototype.initialize=function(){var e=this;return this.initialized=!1,this.systemClipboardStrategy=void 0,this.indexedDBClipboardStrategy=void 0,ge().then(function(t){return e.systemClipboardStrategy=t,(new ve).initialize().then(function(t){return e.indexedDBClipboardStrategy=t,e.initialized=!0,Promise.resolve(e)}).catch(function(){return e.initialized=!0,Promise.resolve(e)})})},e.prototype.set=function(e,t){var r=this;try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new n.e(n.f.ClipboardStrategyNotInitialized));var o={systemClipboardOperationResult:Object(n.I)(n.Eb,"setresult",!1),indexedDBClipboardOperationResult:Object(n.I)(n.Eb,"setresult",!1)};return this.systemClipboardStrategy.set(e,t).then(function(){return Promise.resolve(o)},function(e){return o.systemClipboardOperationResult.failed=!0,o.systemClipboardOperationResultError=e,Object(n.tb)(e,[n.f.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation,n.f.RejectingBlockedSyncCutCopyPromise])?Promise.reject(e):Promise.resolve(o)}).then(function(o){return r.indexedDBClipboardStrategy?(o.systemClipboardOperationResult.failed&&Object(n.Ib)(e.getData()),r.indexedDBClipboardStrategy.set(e,t).then(function(){return Promise.resolve(o)},function(e){return Object(n.Mb)().ULS.traceTag(596128072,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Failed to save to indexedDB. clipboardStrategyType: '"+n.j.IndexedDB+"', Command Id: '"+(t.id?t.id:n.Y)+"', Error: "+i.utils.getStringifiedError(e)),o.indexedDBClipboardOperationResult.failed=!0,o.indexedDBClipboardOperationResultError=e,Promise.resolve(o)})):(o.indexedDBClipboardOperationResult.failed=!0,Promise.resolve(o))}).then(function(e){if(e.systemClipboardOperationResult.failed&&e.indexedDBClipboardOperationResult.failed){var t=e.systemClipboardOperationResultError;return t||(t=e.indexedDBClipboardOperationResultError),t?Promise.reject(t):Promise.reject(new n.e(n.f.SetClipboardItems,n.Y))}return Promise.resolve()})}catch(e){return Promise.reject(new n.e(n.f.SetClipboardItems,"Failed in system clipboard.set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.initialized||!this.systemClipboardStrategy)return Promise.reject(new n.e(n.f.ClipboardStrategyNotInitialized));var r={systemClipboardOperationResult:Object(n.I)(n.Eb,"getresult",!1,void 0,Object(n.fb)()),indexedDBClipboardOperationResult:Object(n.I)(n.Eb,"getresult",!1,void 0,Object(n.fb)())};return this.systemClipboardStrategy.get(e).then(function(e){return r.systemClipboardOperationResult.clipboardItemsData=e.getData(),Promise.resolve(r)},function(e){return r.systemClipboardOperationResult.failed=!0,r.systemClipboardOperationResultError=e,Object(n.sb)(e,n.f.RejectingPendingPastePromiseDueToNewPasteOperation)?Promise.reject(e):Promise.resolve(r)}).then(function(r){return t.indexedDBClipboardStrategy?t.indexedDBClipboardStrategy.get(e).then(function(e){return r.indexedDBClipboardOperationResult.clipboardItemsData=e.getData(),Promise.resolve(r)},function(t){return Object(n.Mb)().ULS.traceTag(595953879,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Failed to get from indexedDB. clipboardStrategyType: '"+n.j.IndexedDB+"', Command Id: '"+(e.id?e.id:n.Y)+"', Error: "+i.utils.getStringifiedError(t)),r.indexedDBClipboardOperationResult.failed=!0,r.indexedDBClipboardOperationResultError=t,Promise.resolve(r)}):(r.indexedDBClipboardOperationResult.failed=!0,Promise.resolve(r))}).then(function(r){if(r.systemClipboardOperationResult.failed||e.skipSystemClipboardAccess){if(r.indexedDBClipboardOperationResult.failed){var o=r.systemClipboardOperationResultError;return o||(o=r.indexedDBClipboardOperationResultError),o?Promise.reject(o):Promise.reject(new n.e(n.f.GetClipboardItems,n.Y))}return Object(n.Gb)(r.indexedDBClipboardOperationResult.clipboardItemsData)?Promise.reject(r.systemClipboardOperationResultError):Promise.resolve(Object(n.G)(r.indexedDBClipboardOperationResult.clipboardItemsData))}return r.indexedDBClipboardOperationResult.failed?Promise.resolve(Object(n.G)(r.systemClipboardOperationResult.clipboardItemsData)):function(){if(Object(n.ub)()&&!Object(n.wb)())return!0;return!1}()?t.pasteSourceReconciliationBasedOnlyOnTextPlain(r):t.pasteSourceReconciliation(r,e)})}catch(e){return Promise.reject(new n.e(n.f.GetClipboardItems,"Failed in system clipboard.get",e))}},e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(Object(n.Hb)([function(){e.systemClipboardStrategy&&e.systemClipboardStrategy.dispose()},function(){e.indexedDBClipboardStrategy&&e.indexedDBClipboardStrategy.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.pasteSourceReconciliation=function(e,t){var r=e.systemClipboardOperationResult.clipboardItemsData.items[n.V],o=(n.mb.ensureOneLFPerNewLine(n.mb.trimToLength(r)),e.indexedDBClipboardOperationResult.clipboardItemsData.items[n.V]),i=(n.mb.ensureOneLFPerNewLine(n.mb.trimToLength(o)),e.systemClipboardOperationResult.clipboardItemsData.items[n.Lb]),a=n.mb.ensureOneLFPerNewLine(n.mb.trimToLength(i)),s=n.mb.getCcpTimestampHtmlCustomAttributeFromWrappingTag(a),c=e.indexedDBClipboardOperationResult.clipboardItemsData.items[n.Lb],d=n.mb.ensureOneLFPerNewLine(n.mb.trimToLength(c));n.mb.getCcpTimestampHtmlCustomAttributeFromWrappingTag(d);if(!s)return t.lastSynchronousCopyFailed?Promise.resolve(Object(n.G)(e.indexedDBClipboardOperationResult.clipboardItemsData)):(Se(e.systemClipboardOperationResult.clipboardItemsData),Promise.resolve(Object(n.G)(e.systemClipboardOperationResult.clipboardItemsData)));var l=Object(n.ib)(e.indexedDBClipboardOperationResult.clipboardItemsData);return l&&l!==n.qb||(l=0),s>l?(Se(e.systemClipboardOperationResult.clipboardItemsData),Promise.resolve(Object(n.G)(e.systemClipboardOperationResult.clipboardItemsData))):Promise.resolve(Object(n.G)(e.indexedDBClipboardOperationResult.clipboardItemsData))},e.prototype.pasteSourceReconciliationBasedOnlyOnTextPlain=function(e){if(0===Object(n.db)(e.systemClipboardOperationResult.clipboardItemsData))return Promise.resolve(Object(n.G)(e.systemClipboardOperationResult.clipboardItemsData));if(Object(n.Gb)(e.indexedDBClipboardOperationResult.clipboardItemsData))return Promise.resolve(Object(n.G)(e.systemClipboardOperationResult.clipboardItemsData));var t=e.systemClipboardOperationResult.clipboardItemsData.items[n.V],r=n.mb.ensureOneLFPerNewLine(n.mb.trimToLength(t)),o=e.indexedDBClipboardOperationResult.clipboardItemsData.items[n.V];return r===n.mb.ensureOneLFPerNewLine(n.mb.trimToLength(o))?Promise.resolve(Object(n.G)(e.indexedDBClipboardOperationResult.clipboardItemsData)):r===Ee().getCopyToClipboardLatencyMessage()?Promise.resolve(Object(n.G)(e.indexedDBClipboardOperationResult.clipboardItemsData)):(e.systemClipboardOperationResult.clipboardItemsData.items[n.Ab]=n.Cb,Promise.resolve(Object(n.G)(e.systemClipboardOperationResult.clipboardItemsData)))},e}();function Se(e){e.items[n.Ab]=n.Cb}function we(e){if(Object(n.Mb)().ULS.traceTag(596456334,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '"+e+"'"),!(e in n.j)||"number"!=typeof e)return Promise.reject(new n.e(n.f.InvalidClipboardStrategyType,"Invalid strategy type '"+e+"'"));switch(e){case n.j.SystemClipboard:return ge();case n.j.IndexedDB:return be();case n.j.SystemClipboardAndIndexedDB:return(new ye).initialize()}return Promise.reject(new n.e(n.f.UnsupportedClipboardStrategyType,"Clipboard strategy type '"+e+"' is not supported"))}function Ee(){return Ie}var Le={initialized:!1,clipboardStrategy:void 0,allowBrowserToStoreUserContent:!1,chromeExtensionIds:[],clipboardPromiseTimeoutInMinutes:n.Jb.defaultPromiseTimeoutInMinutes,copyToClipboardLatencyMessage:"Retrieving data. Wait a few seconds and try to cut or copy again.",wacCluster:n.Y},Ie={init:function(e,t,r,o,a,s,c,d,l,u,p,m){e&&Object(i.initEwaUtils)(e);if(Object(n.ob)(t),void 0===r)throw new n.t(n.Y,"allowBrowserToStoreUserContent");if(!o||!Array.isArray(o))throw new n.t(n.Y,"chromeExtensionIds");Object(n.Mb)().ULS.traceTag(596455702,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"ClipboardPlatformEnvironment.init: allowBrowserToStoreUserContent = '"+r+"', chromeExtensionIds = '"+JSON.stringify(o)+"', sharedClipboardHostingApp = '"+a+"', sharedClipboardHostingApps = '"+s+"', sharedClipboardHostingEnvironments = '"+c+"'"),m&&(Le.wacCluster=m.trim());Le.allowBrowserToStoreUserContent=r,Le.chromeExtensionIds=function(e){var t=[];if(!e)return t;for(var r=0,n=e;r<n.length;r++){var o=n[r];o&&"string"==typeof o&&o.trim().length>0&&t.push(o)}return t}(o),p&&(Le.copyToClipboardLatencyMessage=p);"number"!=typeof u||isNaN(u)||(Le.clipboardPromiseTimeoutInMinutes=u);n.Jb.initializeSharedClipboardSettings({sharedClipboardHostingApp:a,sharedClipboardHostingApps:s,sharedClipboardHostingEnvironments:c,sharedClipboardSchemaVersion:d,sharedClipboardExpirationInMinutes:l,clipboardPromiseTimeoutInMinutes:Le.clipboardPromiseTimeoutInMinutes}),Le.initialized=!0},getSupportedClipboardStrategyTypes:_e,selectClipboardStrategy:function(e){if(!(e in n.j)||"number"!=typeof e)return Promise.reject(new n.e(n.f.InvalidClipboardStrategyType,"Invalid strategy type '"+e+"'"));if(!Le.initialized)return Promise.reject(new n.e(n.f.SelectClipboardStrategy,"ClipboardPlatformEnvironment is not initialized. Call init(...)"));try{var t=_e();return!t||t.indexOf(e)<0?Promise.reject(new n.e(n.f.UnsupportedClipboardStrategyType,"Strategy type '"+e+"' is not supported in this environment")):(Le.clipboardStrategy&&(Object(n.Mb)().ULS.traceTag(596456335,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"selectClipboardStrategy: replacing clipboard strategy type '"+Te().clipboardStrategyType+"' with '"+e+"'"),Le.clipboardStrategy.dispose(),Le.clipboardStrategy=void 0),we(e).then(function(t){Le.clipboardStrategy=t,Object(n.Mb)().ULS.traceTag(596453010,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Clipboard strategy type '"+e+"' was created.")}).catch(function(t){var r="selectClipboardStrategy: failed to create clipboard strategy type '"+e+"'. Error: "+i.utils.getStringifiedError(t);return Object(n.Mb)().ULS.traceTag(596453011,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,r),Promise.reject(new n.e(n.f.SelectClipboardStrategy,r,t))}))}catch(t){var r="selectClipboardStrategy: failed to create clipboard strategy type '"+e+"'. Error: "+i.utils.getStringifiedError(t);return Object(n.Mb)().ULS.traceTag(596453012,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,r),Promise.reject(new n.e(n.f.SelectClipboardStrategy,r,t))}},getClipboardStrategy:Te,getAllowBrowserToStoreUserContent:function(){return Pe(),Le.allowBrowserToStoreUserContent},getChromeExtensionIds:function(){return Pe(),Le.chromeExtensionIds},getClipboardPromiseTimeoutInMinutes:function(){return Pe(),Le.clipboardPromiseTimeoutInMinutes},getCopyToClipboardLatencyMessage:function(){return Pe(),Le.copyToClipboardLatencyMessage},getWacCluster:function(){return Pe(),Le.wacCluster}};function Te(){if(Pe(),!Le.clipboardStrategy)throw new n.s("A clipboard strategy has not been selected. Call selectClipboardStrategy.");return Le.clipboardStrategy}function _e(){Pe();var e=[];return Le.allowBrowserToStoreUserContent&&le()&&e.push(n.j.SystemClipboardAndIndexedDB),e.push(n.j.SystemClipboard),e}function Pe(){if(!Le.initialized)throw new n.s("ClipboardPlatformEnvironment is not initialized. Call init(...).")}r.d(t,"createClipboardItems",function(){return n.G}),r.d(t,"getClipboardPlatformEnvironment",function(){return Ee})}});
//# sourceMappingURL=clipboardPlatform.min.js.map